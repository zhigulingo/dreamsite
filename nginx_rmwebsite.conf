server {
  listen 80;
  server_name dreamstalk.ru;

  root "/path/to/project_folder"; # Change path to folder with downloaded source
  index index.html;

  access_log off;
  autoindex off;
  charset utf-8;

  # Serve static assets directly.
  location ~ ^/(dist|img|lottie|snippets)/ {
    try_files $uri =404;
  }

  location / {
    # Let nginx return existing files (assets, snippets, etc.).
    if (-f $request_filename) {
      break;
    }

    # Return prerendered snippets for crawler requests with `_escaped_fragment_`.
    if ($args ~ "_escaped_fragment_") {
      # Default snippet is homepage.
      set $snippet /snippets/1.html;

      # Map nested paths to matching snippet when present.
      if ($uri ~ "^/(.+)/$") {
        set $snippet /snippets/$1.html;
      }
      if ($uri ~ "^/([.a-zA-Z0-9-_/]+)$") {
        set $snippet /snippets/$1.html;
      }

      rewrite ^ $snippet last;
    }

    # SPA fallback for regular visitors.
    try_files $uri $uri/ /index.html;
  }
}

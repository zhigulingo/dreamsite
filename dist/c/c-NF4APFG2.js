import{a as qt}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-24XV2FQX.js";import{a as Qt}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-O66ERSC6.js";import{a as L,b as It,c as We,d as Ei,e as Nt,f as Ri}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-HU5BC7RO.js";import{a as Vt,b as Oi}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-Q7BTOBMD.js";import{c as Xt,e as Ni}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-K46LLQER.js";import{a as jt}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-JNDRVV2G.js";import{d as O,e as tt}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-WFK67Z26.js";import{b as q,c as ne,e as Oe}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-7CPACVX6.js";import{a as Zt,b as Kt,d as Jt}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-RF5DXYC5.js";import{a as Ft,b as Ii,c as Ht,d as Li,e as Ut,f as Yt,h as Fi}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-72XPLI4I.js";import{a as Hi}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-Y3VR57VD.js";import{e as Lt,f as Wi,g as Rt,h as Bt,i as Vi}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-3LARXSCS.js";import{a as Gt,b as Di}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-HZTK2BUY.js";import{a as Ge,b as Bi}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-B23UII4U.js";import{a as Ne,b as Dt}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-VST77AHU.js";import{T as Et,U as $i}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-V2Q2Q5SX.js";import{b as Wt,k as Mi}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-NNSEZ57I.js";import{a as K,b as Ot}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-TD4UT3F7.js";import{a as Z,b as Te}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-Q7PZB3WT.js";import{n as Je,o as _t,p as et,r as At,v as Ti,x as _i}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-WVP3CYWZ.js";import{a as ie,b as Fe,n as $t,w as Ai}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-UHXDCVRZ.js";import{a as I,b as De}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-AKMTZVHB.js";import{e as He,g as Mt}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-JOVHXRDR.js";import{b as Le,o as wt}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-CWQ7UVOU.js";import{m as B,n as Re,o as yt,p as Si,q as _,r as Be}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-SEQO6JGA.js";import{b as Pt,g as zi}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-3PLKCB46.js";import{a as ye}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-CRBJZLYB.js";import{g as St,h as Ke,k as V,l as zt}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-7U5B3NHZ.js";import{D as bt,E as ki}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-3Z7TN3F3.js";import{a as Ce,h as kt}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-AJJJ2YQK.js";import{e as xt,p as Pi}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-3RHLIOHS.js";import{k as Ci}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-F7HHU2GW.js";import{D as Ct,F as Tt}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-EW5ORGES.js";import{b as U,c as Ze}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-R72ZIPE6.js";import{a as qe,c as ft,d as $e,f as vt}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-YKRSBDJJ.js";import{a as ze}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-LZBINVC2.js";import{b as xe}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-MBCOPGYF.js";import{c as u,d as be}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-4EBQPF62.js";import{d as $,f as ut}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-ZYG7ZY5I.js";window.Modernizr=function(e,t,i){var o="2.8.3",r={},n=!0,s=t.documentElement,a="modernizr",p=t.createElement(a),c=p.style,w=t.createElement("input"),v=":)",M={}.toString,P=" -webkit- -moz- -o- -ms- ".split(" "),T="Webkit Moz O ms",G=T.split(" "),x=T.toLowerCase().split(" "),C={svg:"http://www.w3.org/2000/svg"},h={},oe={},J={},le=[],R=le.slice,ee,X=function(l,d,b,f){var z,D,re,me,te=t.createElement("div"),ve=t.body,H=ve||t.createElement("body");if(parseInt(b,10))for(;b--;)re=t.createElement("div"),re.id=f?f[b]:a+(b+1),te.appendChild(re);return z=["&#173;",'<style id="s',a,'">',l,"</style>"].join(""),te.id=a,(ve?te:H).innerHTML+=z,H.appendChild(te),ve||(H.style.background="",H.style.overflow="hidden",me=s.style.overflow,s.style.overflow="hidden",s.appendChild(H)),D=d(te,l),ve?te.parentNode.removeChild(te):(H.parentNode.removeChild(H),s.style.overflow=me),!!D},ce=function(l){var d=e.matchMedia||e.msMatchMedia;if(d)return d(l)&&d(l).matches||!1;var b;return X("@media "+l+" { #"+a+" { position: absolute; } }",function(f){b=(e.getComputedStyle?getComputedStyle(f,null):f.currentStyle).position=="absolute"}),b},de=function(){var l={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};function d(b,f){f=f||t.createElement(l[b]||"div"),b="on"+b;var z=b in f;return z||(f.setAttribute||(f=t.createElement("div")),f.setAttribute&&f.removeAttribute&&(f.setAttribute(b,""),z=Q(f[b],"function"),Q(f[b],"undefined")||(f[b]=i),f.removeAttribute(b))),f=null,z}return d}(),ue={}.hasOwnProperty,he;!Q(ue,"undefined")&&!Q(ue.call,"undefined")?he=function(l,d){return ue.call(l,d)}:he=function(l,d){return d in l&&Q(l.constructor.prototype[d],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(d){var b=this;if(typeof b!="function")throw new TypeError;var f=R.call(arguments,1),z=function(){if(this instanceof z){var D=function(){};D.prototype=b.prototype;var re=new D,me=b.apply(re,f.concat(R.call(arguments)));return Object(me)===me?me:re}else return b.apply(d,f.concat(R.call(arguments)))};return z});function j(l){c.cssText=l}function _e(l,d){return j(P.join(l+";")+(d||""))}function Q(l,d){return typeof l===d}function we(l,d){return!!~(""+l).indexOf(d)}function Ae(l,d){for(var b in l){var f=l[b];if(!we(f,"-")&&c[f]!==i)return d=="pfx"?f:!0}return!1}function Xe(l,d,b){for(var f in l){var z=d[l[f]];if(z!==i)return b===!1?l[f]:Q(z,"function")?z.bind(b||d):z}return!1}function E(l,d,b){var f=l.charAt(0).toUpperCase()+l.slice(1),z=(l+" "+G.join(f+" ")+f).split(" ");return Q(d,"string")||Q(d,"undefined")?Ae(z,d):(z=(l+" "+x.join(f+" ")+f).split(" "),Xe(z,d,b))}h.flexbox=function(){return E("flexWrap")},h.flexboxlegacy=function(){return E("boxDirection")},h.canvas=function(){var l=t.createElement("canvas");return!!(l.getContext&&l.getContext("2d"))},h.canvastext=function(){return!!(r.canvas&&Q(t.createElement("canvas").getContext("2d").fillText,"function"))},h.webgl=function(){return!!e.WebGLRenderingContext},h.touch=function(){var l;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?l=!0:X(["@media (",P.join("touch-enabled),("),a,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(d){l=d.offsetTop===9}),l},h.geolocation=function(){return"geolocation"in navigator},h.postmessage=function(){return!!e.postMessage},h.websqldatabase=function(){return!!e.openDatabase},h.indexedDB=function(){return!!E("indexedDB",e)},h.hashchange=function(){return de("hashchange",e)&&(t.documentMode===i||t.documentMode>7)},h.history=function(){return!!(e.history&&history.pushState)},h.draganddrop=function(){var l=t.createElement("div");return"draggable"in l||"ondragstart"in l&&"ondrop"in l},h.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},h.rgba=function(){return j("background-color:rgba(150,255,150,.5)"),we(c.backgroundColor,"rgba")},h.hsla=function(){return j("background-color:hsla(120,40%,100%,.5)"),we(c.backgroundColor,"rgba")||we(c.backgroundColor,"hsla")},h.multiplebgs=function(){return j("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(c.background)},h.backgroundsize=function(){return E("backgroundSize")},h.borderimage=function(){return E("borderImage")},h.borderradius=function(){return E("borderRadius")},h.boxshadow=function(){return E("boxShadow")},h.textshadow=function(){return t.createElement("div").style.textShadow===""},h.opacity=function(){return _e("opacity:.55"),/^0.55$/.test(c.opacity)},h.cssanimations=function(){return E("animationName")},h.csscolumns=function(){return E("columnCount")},h.cssgradients=function(){var l="background-image:",d="gradient(linear,left top,right bottom,from(#9f9),to(white));",b="linear-gradient(left top,#9f9, white);";return j((l+"-webkit- ".split(" ").join(d+l)+P.join(b+l)).slice(0,-l.length)),we(c.backgroundImage,"gradient")},h.cssreflections=function(){return E("boxReflect")},h.csstransforms=function(){return!!E("transform")},h.csstransforms3d=function(){var l=!!E("perspective");return l&&"webkitPerspective"in s.style&&X("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(d,b){l=d.offsetLeft===9&&d.offsetHeight===3}),l},h.csstransitions=function(){return E("transition")},h.fontface=function(){var l;return X('@font-face {font-family:"font";src:url("https://")}',function(d,b){var f=t.getElementById("smodernizr"),z=f.sheet||f.styleSheet,D=z?z.cssRules&&z.cssRules[0]?z.cssRules[0].cssText:z.cssText||"":"";l=/src/i.test(D)&&D.indexOf(b.split(" ")[0])===0}),l},h.generatedcontent=function(){var l;return X(["#",a,"{font:0/0 a}#",a,':after{content:"',v,'";visibility:hidden;font:3px/1 a}'].join(""),function(d){l=d.offsetHeight>=3}),l},h.video=function(){var l=t.createElement("video"),d=!1;try{(d=!!l.canPlayType)&&(d=new Boolean(d),d.ogg=l.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),d.h264=l.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),d.webm=l.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch{}return d},h.audio=function(){var l=t.createElement("audio"),d=!1;try{(d=!!l.canPlayType)&&(d=new Boolean(d),d.ogg=l.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),d.mp3=l.canPlayType("audio/mpeg;").replace(/^no$/,""),d.wav=l.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),d.m4a=(l.canPlayType("audio/x-m4a;")||l.canPlayType("audio/aac;")).replace(/^no$/,""))}catch{}return d},h.localstorage=function(){try{return localStorage.setItem(a,a),localStorage.removeItem(a),!0}catch{return!1}},h.sessionstorage=function(){try{return sessionStorage.setItem(a,a),sessionStorage.removeItem(a),!0}catch{return!1}},h.webworkers=function(){return!!e.Worker},h.applicationcache=function(){return!!e.applicationCache},h.svg=function(){return!!t.createElementNS&&!!t.createElementNS(C.svg,"svg").createSVGRect},h.inlinesvg=function(){var l=t.createElement("div");return l.innerHTML="<svg/>",(l.firstChild&&l.firstChild.namespaceURI)==C.svg},h.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(M.call(t.createElementNS(C.svg,"animate")))},h.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(M.call(t.createElementNS(C.svg,"clipPath")))};function je(){r.input=function(l){for(var d=0,b=l.length;d<b;d++)J[l[d]]=l[d]in w;return J.list&&(J.list=!!(t.createElement("datalist")&&e.HTMLDataListElement)),J}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),r.inputtypes=function(l){for(var d=0,b,f,z,D=l.length;d<D;d++)w.setAttribute("type",f=l[d]),b=w.type!=="text",b&&(w.value=v,w.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(f)&&w.style.WebkitAppearance!==i?(s.appendChild(w),z=t.defaultView,b=z.getComputedStyle&&z.getComputedStyle(w,null).WebkitAppearance!=="textfield"&&w.offsetHeight!==0,s.removeChild(w)):/^(search|tel)$/.test(f)||(/^(url|email)$/.test(f)?b=w.checkValidity&&w.checkValidity()===!1:b=w.value!=v)),oe[l[d]]=!!b;return oe}("search tel url email datetime date month week time datetime-local number range color".split(" "))}for(var Se in h)he(h,Se)&&(ee=Se.toLowerCase(),r[ee]=h[Se](),le.push((r[ee]?"":"no-")+ee));r.input||je(),r.addTest=function(l,d){if(typeof l=="object")for(var b in l)he(l,b)&&r.addTest(b,l[b]);else{if(l=l.toLowerCase(),r[l]!==i)return r;d=typeof d=="function"?d():d,typeof n<"u"&&n&&(s.className+=" "+(d?"":"no-")+l),r[l]=d}return r},j(""),p=w=null;return function(l,d){var b="3.7.0",f=l.html5||{},z=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,D=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,re,me="_html5shiv",te=0,ve={},H;(function(){try{var y=d.createElement("a");y.innerHTML="<xyz></xyz>",re="hidden"in y,H=y.childNodes.length==1||function(){d.createElement("a");var k=d.createDocumentFragment();return typeof k.cloneNode>"u"||typeof k.createDocumentFragment>"u"||typeof k.createElement>"u"}()}catch{re=!0,H=!0}})();function fi(y,k){var W=y.createElement("p"),N=y.getElementsByTagName("head")[0]||y.documentElement;return W.innerHTML="x<style>"+k+"</style>",N.insertBefore(W.lastChild,N.firstChild)}function dt(){var y=Me.elements;return typeof y=="string"?y.split(" "):y}function Qe(y){var k=ve[y[me]];return k||(k={},te++,y[me]=te,ve[te]=k),k}function ht(y,k,W){if(k||(k=d),H)return k.createElement(y);W||(W=Qe(k));var N;return W.cache[y]?N=W.cache[y].cloneNode():D.test(y)?N=(W.cache[y]=W.createElem(y)).cloneNode():N=W.createElem(y),N.canHaveChildren&&!z.test(y)&&!N.tagUrn?W.frag.appendChild(N):N}function vi(y,k){if(y||(y=d),H)return y.createDocumentFragment();k=k||Qe(y);for(var W=k.frag.cloneNode(),N=0,gt=dt(),yi=gt.length;N<yi;N++)W.createElement(gt[N]);return W}function xi(y,k){k.cache||(k.cache={},k.createElem=y.createElement,k.createFrag=y.createDocumentFragment,k.frag=k.createFrag()),y.createElement=function(W){return Me.shivMethods?ht(W,y,k):k.createElem(W)},y.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+dt().join().replace(/[\w\-]+/g,function(W){return k.createElem(W),k.frag.createElement(W),'c("'+W+'")'})+");return n}")(Me,k.frag)}function mt(y){y||(y=d);var k=Qe(y);return Me.shivCSS&&!re&&!k.hasCSS&&(k.hasCSS=!!fi(y,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),H||xi(y,k),y}var Me={elements:f.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:b,shivCSS:f.shivCSS!==!1,supportsUnknownElements:H,shivMethods:f.shivMethods!==!1,type:"default",shivDocument:mt,createElement:ht,createDocumentFragment:vi};l.html5=Me,mt(d)}(e,e.document),r._version=o,r._prefixes=P,r._domPrefixes=x,r._cssomPrefixes=G,r.mq=ce,r.hasEvent=de,r.testProp=function(l){return Ae([l])},r.testAllProps=E,r.testStyles=X,r.prefixed=function(l,d,b){return d?E(l,d,b):E(l,"pfx")},s.className=s.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(n?" js "+le.join(" "):""),r}(window,window.document);(function(){Modernizr.addTest("retina",function(){return window.devicePixelRatio>1}),Modernizr.addTest("android",function(){return window.navigator.userAgent.toLowerCase().match(/Android/i)}),Modernizr.addTest("amazonsilk",function(){return/\bSilk\b/.test(navigator.userAgent)}),Modernizr.addTest("Mac",function(){return window.navigator.userAgent.indexOf("Mac")!=-1}),Modernizr.addTest("Windows",function(){return window.navigator.userAgent.indexOf("Windows NT")!=-1}),Modernizr.addTest("webkit",function(){return window.navigator.userAgent.indexOf("AppleWebKit")!=-1}),Modernizr.addTest("opera",function(){return!!(window.opera&&window.opera.buildNumber)}),Modernizr.addTest("chrome",function(){return window.navigator&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Modernizr.addTest("msie",function(){return!!Function("/*@cc_on return document.documentMode===10@*/")()}),Modernizr.addTest("msie11",function(){return navigator.userAgent.indexOf("Trident/")!=-1&&(navigator.userAgent.indexOf("rv:")!=-1||navigator.appName.indexOf("Netscape")!=-1)}),Modernizr.addTest("winphone8",function(){return navigator.userAgent.indexOf("Trident/")!=-1&&(navigator.userAgent.indexOf("Phone")!=-1||navigator.userAgent.indexOf("IEMobile/")!=-1)}),Modernizr.addTest("safari",function(){return navigator.userAgent.indexOf("Safari")!=-1&&(navigator.userAgent.indexOf("Mac")!=-1||navigator.userAgent.indexOf("Windows"))&&navigator.userAgent.indexOf("Chrome")==-1}),Modernizr.addTest("safari5",function(){return!!navigator.userAgent.match(" Safari/")&&!navigator.userAgent.match(" Chrom")&&!!navigator.userAgent.match(" Version/5.")}),Modernizr.addTest("mobilesafari26",function(){return!!navigator.userAgent.match("Safari/")&&!!navigator.userAgent.match(" Version/26.")&&!!navigator.userAgent.match("Mobile")}),Modernizr.addTest("safari<=15",function(){if(/ Safari\//.test(navigator.userAgent)&&!/ Chrom/.test(navigator.userAgent)){let e=navigator.userAgent.match(/ Version\/(\d+)/)??[];return e[1]?Number(e[1])<=15:!1}else return!1}),Modernizr.addTest("isipad",function(){return window.navigator.userAgent.toLowerCase().match(/ipad/i)}),Modernizr.addTest("ismobile",function(){return window.navigator.userAgent.toLowerCase().match(/android|webos|iphone|ipad|ipod|blackberry|playbook|iemobile|windows phone|kindle|silk|opera mini/i)}),Modernizr.addTest("firefox",function(){return window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}),Modernizr.addTest("edge",function(){return window.navigator.userAgent.toLowerCase().indexOf("edge")>-1}),Modernizr.addTest("csspositionsticky",function(){var e="position:",t="sticky",i=document.createElement("modernizr"),o=i.style;return o.cssText=e+Modernizr._prefixes.join(t+";"+e).slice(0,-e.length),o.position.indexOf(t)!==-1})})();Ri();be();var it=class{constructor(){ut(this,"timings");this.timings={}}setTiming(t,i){this.timings[t]=i}sendTimings(t){let i={};Object.keys(this.timings).forEach(s=>{i[s]=this.timings[s]-window.performance.timing.navigationStart});let r=window.innerWidth,n=!u.isDesktop()||Modernizr.ismobile?Modernizr.isipad||r>=600?"tablet":"phone":"desktop";Nt("frontend-rendering",{"project.numId":t.projectNumId,"user.numId":t.userNumId,"project.viewport":t.viewport,"project.startPage":t.startPage,"project.widgetsCount":t.widgetsCount,device:n,timing:i})}},Gi=new it,ot=Gi;Ii();Re();var Ee=class extends Ft{triggerDataChanges(t){super.triggerDataChanges(t),t.provider&&B.trigger("ecommerce:update:provider",t.provider),t.products&&B.trigger("ecommerce:loadproducts:complete",t.products)}};ft();var fe={};function Ui(e){return new Promise(t=>{switch(e){case"addtocart":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-ZNAPE67Q.js"));break;case"audio":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-6BXECPHP.js"));break;case"background":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-K5YHIOD3.js"));break;case"button":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-GFU5NTU2.js"));break;case"ecommercecart":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-CRKOUTPI.js"));break;case"facebook":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-7FDXNTQU.js"));break;case"form":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-VBQQW2AP.js"));break;case"picture":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-WLSGZP5B.js"));break;case"gmaps":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-QA2JMQV4.js"));break;case"hotspot":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-5I6SODKY.js"));break;case"iframe":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-6KZ4T3NP.js"));break;case"shape":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-ESY4Y42V.js"));break;case"slideshow":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-64UKFPK7.js"));break;case"text":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-F7WU4OAU.js"));break;case"twitter":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-JE5VW4J4.js"));break;case"video":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-EHNP6FXX.js"));break;case"rmfooter":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-JBMSSRXQ.js"));break;case"rmheader":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-KJPC33CH.js"));break;case"shots":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-M6BPL4VJ.js"));break;case"lottie":t(import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-CL6CMMHB.js"));break;default:break}})}async function co(e=[]){let i=(e?.length?e:Object.values(qe)).map(o=>Ui(o).then(r=>{fe[o]=r.default}));return Promise.all(i)}var nt=$(Ci()),ke=$(ze()),st=$(ye()),S=$(xe());Te();var ei={"template-viewer-page":Z`
  <article class="page hidden">
    <div id="page-<%=pageNum%>-password-container" class="polyfill-sticky"></div>
    <div class="page-fixed-bg-container polyfill-sticky"></div>
    <div class="fixed-position-container-top polyfill-sticky"></div>
    <div class="fixed-position-container polyfill-sticky"></div>
    <div class="content-scroll-wrapper <%=isStickyVerticalViewer ? '' : 'has-vertical-scroll'%>">
      <div class="content-bounds">
        <div class="page-content-container"></div>
      </div>
    </div>
  </article>
`};Be();Vi();Bi();De();tt();var rt=$(ye()),A=$(xe());Be();tt();De();Fe();be();var Yi=rt.default.View.extend({initialize:function(e){A.default.bindAll(this),A.default.extend(this,e);let t={};A.default.each(this.widgets,A.default.bind(function(o){if(o.hasAnimation()){let r=o.fixed_position||o.is_full_width||o.is_full_height||o.sticked?_.generateUUID():O.getUuidHash(o.getAnimations())||_.generateUUID();t[r]=t[r]||[],t[r].push(o)}},this)),this.animations=[];let i=!u.isDesktop()||!Modernizr.safari;A.default.each(t,function(o){this.addAnimation(o,{allowAccelerate:i})}.bind(this)),this.start.__debounced=A.default.debounce(this.start,300)},addAnimation:function(e,t){t=t||{},e=A.default.isArray(e)?e:[e];let i=["nonMove","moveOnly",...O.EVENT_TYPES].reverse();[...e[0].getAnimations()].map(r=>O.isMoveOnly(r)?{...r,effects:"moveOnly"}:O.isNonMove(r)?{...r,effects:"nonMove"}:r).sort((r,n)=>i.indexOf(r.effects||r.type)-i.indexOf(n.effects||n.type)).filter(r=>!O.isEmpty(r)).map(r=>{let n=r.type,s=e[0].animationObjects,a=[null,void 0].includes(t.isNested)?!!(s&&s.length):t.isNested,p=new Ve[n]({page:this.page,widgets:e,rawAnimation:r,$container:a?s[s.length-1].$el:void 0,allowAccelerate:t.allowAccelerate,isNested:a,topmostAnimation:a?s[0]:void 0});this.animations.push(p)})},removeAnimation:function(e){this.animations=A.default.without(this.animations,e),e&&e.destroy()},start:function(){A.default.each(this.animations,function(e){e.start()})},stop:function(){A.default.each(this.animations,function(e){e.stop()})},resetStarted:function(){A.default.each(this.animations,function(e){e.started=!1})},onScroll:function(e){e=e||{},!(this.page.mag.currentPage!==this.page&&!e.forceApply)&&A.default.each(this.animations,function(t){t.onScroll&&t.onScroll(e)})},onResize:function(e){A.default.each(this.animations,function(t){t.onResize(e)})},updateTimelines:function(e=[]){A.default.each(this.animations,function(t){e.includes(t.animation.UUID)||t.createAnimationTimeline()})},hasScaleUp:function(){return!!A.default.find(this.animations,function(e){return O.isScaleUp(e.animation)})},destroy:function(){A.default.each(this.animations,function(e){e.destroy()}),delete this.animations}}),Ve={},se=rt.default.View.extend({visibilityRatio:.2,className:"animation-container",scrolledToView:!1,useOnscrollBoundsFallback:typeof window<"u"&&!window.IntersectionObserver,initialize:function(e){A.default.bindAll(this),A.default.extend(this,e),A.default.each(this.widgets,A.default.bind(function(t){t.animationObj=this,t.animationObjects=[...t.animationObjects||[],this]},this)),this.isFixed=this.widgets[0].fixed_position,this.isFullwidth=this.widgets[0].is_full_width,this.isFullheight=this.widgets[0].is_full_height,this.isSticked=this.widgets[0].sticked,this.isAbove=this.widgets[0].is_above,this.playOnce=!this.page.mag.isPreview&&this.playOnce,this.$container=this.$container||(this.isFixed||this.isAbove?this.widgets[0].$fixedContainer:this.page.$content),this.$el.appendTo(this.$wrapper?this.$wrapper:this.$container),this.onResize({updateAll:!0}),this.createAnimationTimeline(e)},getCenterPoint(){return{x:this.bbox_css.width/2,y:this.bbox_css.height/2}},createAnimationTimeline:function(){this.timeline&&this.timeline.destroy(),this.animation=O.getNormalizedAnimation(this.rawAnimation,this.isFixed,this.isFullwidth,this.isFullheight,this.page.scale,this.page.pageViewport,this.page.mag.getViewportWidth(this.page.pageViewport),this.page.mag.viewOpts,!0),this.timeline=O.createAnimationTimeline({UUID:this.animation.UUID,el:this.$el,steps:this.animation.steps,type:this.animation.type,force3d:!1,animationTrigger:this.animation.trigger,selfTriggered:!!A.default.intersection(O.normalizeAnimationTriggers(this.animation.trigger),this.widgets.map(e=>e._id)).length,screenshotMode:!!RM.screenshot,centerPoint:this.getCenterPoint(),widgetId:this.widgets[0]._id})},start:function(){!this.timeline||!this.paused||(this.paused=!1,this.timeline.resume())},stop:function(){!this.timeline||!this.timeline.active||this.isAbove||(this.paused=!0,this.timeline.pause())},getAnimationContainer:function(){return this.$el},modifyWidgetPosition:function(e){return this.isFixed?(e.dimensions.left="50%",e.dimensions.top="50%",e.dimensions.right="",e.dimensions.bottom="",e.dimensions["margin-left"]=-e.dimensions.width/2,e.dimensions["margin-top"]=-e.dimensions.height/2):(e.dimensions.left-=this.bbox_css.left+(this.isNested?this.topmostAnimation.bbox_css.left:0),e.dimensions.top-=this.bbox_css.top+(this.isNested?this.topmostAnimation.bbox_css.top:0)),e},onResize:function(e){if(e=e||{},e.updateAll||this.isFixed&&this.prevPageScale!==this.page.scale||this.isFullwidth||this.isFullheight||this.isSticked){let t={t:Number.POSITIVE_INFINITY,l:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,r:Number.NEGATIVE_INFINITY,z:0},i;this.isFixed||this.isFullwidth||this.isFullheight||this.isSticked?this.bbox_css={...this.widgets[0].calcBoxStyle({calcBBox:!0}).dimensions,...this.isNested?{left:0,top:0,"margin-left":0,"margin-top":0}:{}}:(A.default.each(this.widgets,function(o){i=o.calcBoxStyle({calcBBox:!0}).dimensions,t.t=Math.min(t.t,i.top),t.l=Math.min(t.l,i.left),t.b=Math.max(t.b,i.top+i.height),t.r=Math.max(t.r,i.left+i.width),t.z=Math.max(t.z,i["z-index"])},this),this.bbox_css={left:this.isNested?0:t.l,top:this.isNested?0:t.t,width:t.r-t.l,height:t.b-t.t,"z-index":t.z}),this.$el.css(this.bbox_css)}O.isOffsetPathEnabled(this.animation?.steps)&&this.timeline&&this.timeline.createOffsetPath(this.getCenterPoint()),this.innerContentTop=this.page.contentPosition.top/this.page.scale,this.innerContainerHeight=this.page.mag.getContainerSizeCached().height/this.page.scale,this.prevPageScale=this.page.scale},withTriggerOrElement(e){let t=this.animation.trigger.filter(o=>o).reduce((o,r)=>o.concat(this.page.mag.getAllWidgetViewsById(r,this.page)),[]),i=0;t.forEach(o=>{o.then(r=>{r.rendered?e(r.$el):this.listenToOnce(r,"rendered",()=>e(r.$el))}).catch(()=>{i++,i===t.length&&e(this.$el)})}),t.length||e(this.$el)},getBBScaleFactor(){return I.isOnForRatio(this.page.pageViewport,this.page.scale,this.page.mag.viewOpts)&&I.isCSSZoom()?this.page.scale:1},isInView(){let e=ie.getBoundingBoxOfElements(this.widgets.map(t=>t.$el[0]),this.getBBScaleFactor());return ie.isBoxInView(e,this.visibilityRatio)},notifyWhenInOrOutOfView(){window.requestAnimationFrame(()=>{this.isInView()?(this.scrolledToView=!0,this.scrolledOutOfView=!1,this.trigger("scrolledToView")):(this.scrolledToView=!1,this.scrolledOutOfView=!0,this.trigger("scrolledOutOfView"))})},whenInView(){return this.whenInOrOutOfView("in")},whenOutOfView(){return this.isInView()?this.whenInOrOutOfView("out"):this.whenInOrOutOfView("in").then(()=>this.whenInOrOutOfView("out"))},whenInOrOutOfView(e="in"){let t=e==="in",i=e==="out";if(this.useOnscrollBoundsFallback)return t&&this.isInView()||i&&!this.isInView()?window.Promise.resolve():new window.Promise(o=>{this.listenToOnce(this,i?"scrolledOutOfView":"scrolledToView",o)});{let o=this.widgets.map(n=>n.$el[0]),r=ie.getBoundingBoxOfElements(o,this.getBBScaleFactor());if(t)return new window.Promise(n=>{let s=new window.IntersectionObserver(a=>{a.some(p=>p.isIntersecting)&&(o.forEach(p=>s.unobserve(p)),n())},{rootMargin:`-${r.height*this.visibilityRatio}px 0px`});o.forEach(a=>s.observe(a))});if(i)return Promise.all(o.map(n=>new window.Promise(s=>{let a=new window.IntersectionObserver(p=>{p.every(c=>!c.isIntersecting)&&(a.unobserve(n),s())});a.observe(n)})))}},destroy:function(){this.stop(),this.timeline&&this.timeline.destroy(),this.remove()}});Ve.scroll=se.extend({onScroll:function(e){if(e=e||{},!this.timeline||(this.page.mag.currentPage!==this.page||this.isAbove)&&!e.forceApply)return;let t=this.isAbove?e.scroll:Math.max(0,this.page.visibleWidgetsCoords.scrollTop||0);if(this.isFixed){this.timeline.seek(t);return}let i={top:1,center:.5,bottom:0},o=this.animation.steps[0].start_point||"bottom",n=this.bbox_css.top+(this.isNested?this.topmostAnimation.bbox_css.top:0)+this.innerContentTop,s=n-this.innerContainerHeight,a=i[o],p=a*(n-s)+s+this.animation.steps[0].start_offset||0;p<=0?this.timeline.seek(t/this.page.scale):this.timeline.seek(Math.max(0,t-p*this.page.scale)/this.page.scale)},onResize:function(){se.prototype.onResize.apply(this,arguments),this.onScroll()}});Ve.load=se.extend({initialize:function(){se.prototype.initialize.apply(this,arguments);let e=this.animation.steps;this.startWhenInView=e&&e.length&&e[0].startWhenInView,this.notifyWhenInOrOutOfView.__throttled=A.default.throttle(this.notifyWhenInOrOutOfView,100)},start:function(){se.prototype.start.apply(this,arguments),this.isReady().then(function(){this.timeline.play(),this.started=!0}.bind(this)).catch(function(e){e&&console.log(e&&e.stack)})},onScroll:function(){this.useOnscrollBoundsFallback&&this.notifyWhenInOrOutOfView.__throttled()},isReady:function(){let e;if(RM.screenshot||this.started||_.PageVisibilityManager.isPageHidden())e=window.Promise.reject();else{let t=this.widgets[0],i=[],o=window.Promise.all(this.widgets.map(r=>r.loaded?window.Promise.resolve():new window.Promise(n=>this.listenToOnce(r,"loaded",n))));if(this.isAbove){let r=this.page.mag.aboveAnimationsReady?window.Promise.resolve():new window.Promise(function(a){this.listenToOnce(this.page.mag,"aboveAnimationsReady",a)}.bind(this)),n=t.rendered?window.Promise.resolve():new window.Promise(function(a){this.listenToOnce(t,"rendered",a)}.bind(this)),s=t.wasHidden?new window.Promise(function(a){this.listenToOnce(t,"shown",a)}.bind(this)):window.Promise.resolve();i=this.startWhenInView?[n,s,o]:[r,n,s,o]}else{let r=this.page.started?window.Promise.resolve():new window.Promise(function(p){this.listenToOnce(this.page,"started",p)}.bind(this)),n=this.page.loadAnimationsReady?window.Promise.resolve():new window.Promise(function(p){this.listenToOnce(this.page,"loadAnimationsReady",p)}.bind(this)),s=this.page.isCurrent()?window.Promise.resolve():new window.Promise(function(p){this.listenToOnce(this.page,"changedTo",p)}.bind(this)),a=this.startWhenInView?o.then(()=>this.whenInView()):window.Promise.resolve();i=this.startWhenInView?[r,s,a]:[n,r]}e=window.Promise.all(i)}return e}});Ve.click=se.extend({resetWhenOutOfView:!1,initialize:function(){se.prototype.initialize.apply(this,arguments);let e="pointer";this.page?.mag?.opts.useCustomCursor&&this.page?.mag?.opts.customHoverCursorImage&&(e=_.getCursorStylesString({cusrsorUrl:this.page.mag.opts.customHoverCursorImage,cursorSize:this.page.mag.opts.customHoverCursorSize,isLambda:this.page.mag.opts.customHoverCursorIsLambda,isHover:!0}));let t=function(i){i.on("click",this.onClick),i.css("cursor",e)}.bind(this);this.willStopOnEnd=!1,this.lastTimeClick=0,this.withTriggerOrElement(t),this.notifyWhenInOrOutOfView.__throttled=A.default.throttle(this.notifyWhenInOrOutOfView,100)},onClick:function(){let e=O.getPermanentAnimationId(this.widgets[0],this.animation.UUID),t=this.timeline&&!this.timeline.active&&this.timeline.reversed&&O.hasPlayed(e);!this.timeline||t||+new Date-this.lastTimeClick<300||(this.lastTimeClick=+new Date,this.timeline.active?(this.willStopOnEnd?this.timeline.off("full-cycle-end",this.onCycleEnd):this.timeline.on("full-cycle-end",this.onCycleEnd),this.willStopOnEnd=!this.willStopOnEnd):(this.willStopOnEnd=!1,this.timeline.reversed?this.timeline.reverse():this.timeline.play(),this.animation.playOnce&&!O.hasPlayed(e)&&O.persistHasPlayed(e),this.animation.resetWhenOutOfView&&this.whenOutOfView().then(()=>{this.timeline.stop(),this.timeline.applyStepState("initial"),this.timeline.reversed=!1}),A.default.each(this.widgets,i=>{i.type==="video"&&i.player&&(this.timeline.reversed?i.player.pause():i.player.play())})))},onScroll:function(){this.useOnscrollBoundsFallback&&this.notifyWhenInOrOutOfView.__throttled()},onCycleEnd:function(){this.willStopOnEnd=!1,this.timeline.off("full-cycle-end",this.onCycleEnd),this.timeline.loop?this.timeline.isFullLoop?this.timeline.stop():this.timeline.reverse():this.timeline.reversed?this.timeline.reverse():this.timeline.play()},destroy:function(){let e=function(t){t.css("cursor","")};this.withTriggerOrElement(e),se.prototype.destroy.apply(this,arguments)}});Ve.hover=se.extend({initialize:function(){se.prototype.initialize.apply(this,arguments);let e=function(t){u.isDesktop()?(t.on("mouseenter",this.onPointerEnter),t.on("mouseleave",this.onPointerLeave)):(t.on("mouseenter",this.onPointerEnter),t.on("touchstart",this.onPointerEnter),t.on("mouseleave",this.onPointerLeave),t.on("touchend",this.onPointerLeave),t.on("touchcancel",this.onPointerLeave),this.$el.toggleClass("hold-event"))}.bind(this);A.default.each(this.widgets,A.default.bind(function(t){["text","shape","picture","button"].indexOf(t.type)!==-1&&(t.hasHoverAnimation=!0)},this)),this.withTriggerOrElement(e)},onPointerEnter:function(){this.timeline&&(this.timeline.active?!this.timeline.loop&&this.timeline.reversed?this.timeline.on("full-cycle-end",this.onCycleEnd):this.timeline.off("full-cycle-end",this.onCycleEnd):!this.timeline.reversed&&this.timeline.play())},onPointerLeave:function(){this.timeline&&(this.timeline.active?!this.timeline.loop&&this.timeline.reversed?this.timeline.off("full-cycle-end",this.onCycleEnd):this.timeline.on("full-cycle-end",this.onCycleEnd):!this.timeline.loop&&this.timeline.reversed&&this.timeline.reverse())},onCycleEnd:function(){this.timeline.off("full-cycle-end",this.onCycleEnd),this.timeline.loop?this.timeline.isFullLoop?this.timeline.stop():this.timeline.reverse():this.timeline.reversed?this.timeline.reverse():this.timeline.play()}});var Ue=Yi;Ot();Di();zt();It();Ei();be();Li();Ze();Re();_i();Ai();Fe();Ti();var ti=e=>e.type==="touchmove";function ii({widgets:e=[],page:t,scale:i=1}){let o="ontouchstart"in document.documentElement?"touchmove":"mousemove",r=M(),n={isDestroyed:!1,rafId:-1,cursorPosition:{x:0,y:0},lastCursorPosition:{x:0,y:0},screenCenter:0,pageTop:0,scrollTop:0,lastScrollTop:null,renderState:new Proxy({status:"idle",canUseTransition:!0},{set:T})};function s(){n.isDestroyed||(n.rafId=window.requestAnimationFrame(()=>{let{isCursorMoved:x,isScrollMoved:C}=w();(x||C)&&v(),(x||C)&&n.renderState.status!=="running"?n.renderState.status="running":!x&&!C&&n.renderState.status!=="idle"&&(n.renderState.status="idle"),n.lastScrollTop!==n.scrollTop&&(n.lastScrollTop=n.scrollTop),(n.lastCursorPosition.x!==n.cursorPosition.x||n.lastCursorPosition.y!==n.cursorPosition.y)&&(n.lastCursorPosition={...n.cursorPosition}),s()}))}function a(){let x=t.$el.offset();n.pageTop=x?.top||0,n.screenCenter=window.innerWidth/2}function p(x){n.scrollTop=x}function c(x){n.cursorPosition={x:ti(x)?x.touches[0].clientX:x.clientX,y:ti(x)?x.touches[0].clientY:x.clientY}}function w(){let x=n.lastScrollTop===null||n.lastScrollTop!==n.scrollTop,h=ie.getDistance(n.lastCursorPosition,n.cursorPosition)>0;return{isScrollMoved:x,isCursorMoved:h}}function v(){let x=n.cursorPosition,C={x:n.screenCenter,y:Math.abs(window.pageYOffset-n.pageTop)};for(let h of e)if(h.isShadowEnabled&&h.shadow){let oe=h.shadow.onScroll,J=h.shadow.onHover,le=h.shadow.fadeOnHover,R=oe||J;if(R||le){let ee=typeof h.shadow.ratio=="number"?h.shadow.ratio:1,X=ee===1?10:(1-ee)*100,ce=h.$el.get(0).getBoundingClientRect();oe&&h.fixed_position&&(ce.y=ce.y-n.scrollTop+n.pageTop);let de=oe&&!J,ue=R?et({blur:h.shadow.blur,rect:ce,angleData:h.angle?r[h._id]:void 0,cursor:de?{...C,x:h.shadow.x}:x,vertical:de,flipH:h.flip_h,flipV:h.flip_v,shadowRatio:X,scale:i}):{},he=Je({cursor:x,rect:ce,scale:i}),j=h.shadow.color||U.shadow.initialShadow.color,_e=le?he?j:"ffffff00":j;h.redrawShadow({shadow:{...h.shadow,color:_e,...ue},transition:le?`filter ${h.shadow.duration}s`:void 0,useTransition:le||n.renderState.canUseTransition})}}else if(h.type==="text"){let oe=h.$el.get(0),J=oe.getBoundingClientRect();oe.querySelectorAll("[data-shadow-interactions]").forEach(R=>{let ee=R.getAttribute("data-shadow-interactions"),X=ee==="scroll",ce=ee==="hover",de=ee==="fade-hover",ue=X||ce;if(ue||de){let he=X&&!ce,j=parseInt(R.getAttribute("data-shadow-x")||"")||0,_e=parseInt(R.getAttribute("data-shadow-y")||"")||0,Q=parseInt(R.getAttribute("data-shadow-blur")||"")||0,we=parseFloat(R.getAttribute("data-shadow-ratio")||""),Ae=typeof we=="number"?we:1,Xe=Ae===1?40:(1-Ae)*100+40,E=parseFloat(R.getAttribute("data-shadow-duration")||""),je=typeof E=="number"?E:0,Se=R.getAttribute("data-shadow-color")||U.shadow.initialShadow.color,l=R.getBoundingClientRect(),d=Je({cursor:x,rect:l,scale:1});X&&h.fixed_position&&(J.y=J.y-n.scrollTop+n.pageTop);let b=de?d?Se:"ffffff00":Se,f=ue?et({blur:Q,rect:J,angleData:h.angle?r[h._id]:void 0,cursor:he?{...C,x:j}:x,vertical:he,flipH:h.flip_h,flipV:h.flip_v,shadowRatio:Xe,scale:i}):{x:j,y:_e,blur:Q,color:b},{textShadow:z}=At({color:b,...f});if(z){let D=R;D.style.textShadow=z,D.style.transition=de?`text-shadow ${je}s`:n.renderState.canUseTransition?"text-shadow .1s":""}}})}}function M(){return e.filter(x=>typeof x.angle<"u").reduce((x,C)=>(x[C._id]=_t(C.angle),x),{})}function P(){return e.some(x=>x.shadow?!0:$t(x)&&x.styles?x.styles.some(C=>C.inlineStyles?.keys?.includes("SHADOW")):!1)}function T(x,C,h){return C==="canUseTransition"?(x[C]=h,!0):(h!==x[C]&&(x[C]=h,h==="idle"&&x.canUseTransition===!1?setTimeout(()=>{n.renderState.status==="idle"&&(n.renderState.canUseTransition=!0)},100):h==="running"&&x.canUseTransition===!0&&(ie.getDistance(n.lastCursorPosition,n.cursorPosition)<200&&n.lastScrollTop===n.scrollTop?n.renderState.canUseTransition=!1:setTimeout(()=>{n.renderState.status==="running"&&(n.renderState.canUseTransition=!1)},100))),!0)}function G(){return t?.mag?.viewOpts&&t?.mag?.viewOpts.viewertype||"vertical"}return a(),p(window.pageYOffset),{start(){n.isDestroyed||!P()||(window.addEventListener(o,c),window.addEventListener("resize",a),G()==="vertical"?B.listenTo(t.mag,"mag_scroll",p):B.listenTo(t,"page_scroll",p),s())},stop(){window.cancelAnimationFrame(n.rafId),window.removeEventListener(o,c),window.removeEventListener("resize",a),G()==="vertical"?B.stopListening(t.mag,"mag_scroll",p):B.stopListening(t,"page_scroll",p)},destroy(){this.stop(),n.isDestroyed=!0}}}Fi();Mt();ft();kt();wt();ki();vt();Tt();var oi={...ei,...jt},at=st.default.View.extend({template:oi["template-viewer-page"],widgetsFetched:!1,whenWidgetsFetched:void 0,widgetsData:[],widgetIds:[],widgetFetchController:void 0,initialize:function(e){return S.default.bindAll(this),this.mag=e.mag,this.router=e.router,this.$container=e.$container,this.viewerType=e.viewerType,this.totalPages=e.totalPages,this.isStickyVerticalViewer=e.isStickyVerticalViewer,e.pageData.wids.length&&typeof e.pageData.wids[0]=="string"?(this.widgetsData=e.pageData.widgetsData||[],this.widgetIds=e.pageData.wids):(this.widgetsData=e.pageData.wids,this.widgetIds=e.pageData.wids.map(t=>t._id),this.widgetsFetched=!0),this.viewOpts=e.viewOpts,S.default.defaults(e.pageData,{title:"",width:this.mag.getViewportWidth(e.mag.viewport),height:this.mag.getViewportSetting("min_height")}),S.default.extend(this,S.default.omit(e.pageData,["wids","widgets"])),this.contentPosition={left:0,top:0},this},render:function(){if(this.setElement(this.template({isStickyVerticalViewer:this.isStickyVerticalViewer,pageNum:this.num})),this.$el.appendTo(this.$container),!RM.screenshot&&!Modernizr.csspositionsticky&&(0,ke.default)(".polyfill-sticky").Stickyfill(),this.zIndex=this.totalPages-this.num+2,this.viewerType==="vertical"&&this.$el.css("z-index",this.zIndex),this.$content=this.$(".page-content-container"),this.$scrollWrapper=this.$(".content-scroll-wrapper"),this.$scrollWrapper.one("scroll",this.fixSafariScroll),this.$fixedBgContainer=this.$(".page-fixed-bg-container"),this.$fixedPositionContainer=this.$(".fixed-position-container"),this.$fixedPositionContainerTop=this.$(".fixed-position-container-top"),this.$contentBounds=this.$(".content-bounds"),this.pageViewport=this.getPageViewport(),this.viewerType==="horizontal"&&this.$scrollWrapper.bind("scroll",this.onScroll),this.createLQBackground(),RM.screenshot===this._id){let e=this.getPageViewport(),t=RM.screenshot&&Ce("pdf")==="true";this.$el.css({overflow:"hidden",height:this[`viewport_${e}`]?.height||Math.max(this.height,672),width:t?this.mag.getViewportWidth("default"):this[`viewport_${e}`]?.width||V.dictionary[e].width,position:"relative"}),Ce("pdf")==="true"&&(this.$fixedPositionContainer.css({height:"100%"}),this.$fixedPositionContainerTop.css({height:"100%"})),this.onResize(),this.on("pageLoaded",function(){this.mag.router.sendReadyEvent({page:this})},this)}return this},async show(){if(!this.shown){if(this.$el.removeClass("hidden"),this.shown=!0,this.isPasswordProtected()&&!this.passwordFormShown)return this.showPagePasswordForm(),this.passwordFormShown=!0,Promise.resolve();if(this.viewerType==="horizontal"&&this.onResize(),!this.widgets&&!this.widgetsFetched&&(!RM.screenshotMode||RM.screenshotMode==="published"))return this.whenWidgetsFetched=this.whenWidgetsFetched||new Promise(e=>{this.widgetFetchController=typeof AbortController<"u"?new AbortController:void 0,Ht(this.mag.num_id,this._id,this.widgetFetchController?.signal).then(t=>{this.widgetsFetched=!0,this.widgetsData=[...this.widgetsData,...t.filter(i=>!i.is_global)],this.createWidgetsForCurrentViewport(),e()}).catch(t=>{if(t.name!=="AbortError")throw t})}),this.whenWidgetsFetched;if(!this.widgets||this.lastViewportUsedForWidgetsCreation!==this.pageViewport)return this.createWidgetsForCurrentViewport(),Promise.resolve()}return this.whenWidgetsFetched||Promise.resolve()},start:function(e){if(!(this.started&&!(e&&e.forceStart)))return this.started=!0,this.trigger("started"),e=e||{},S.default.each(this.widgets,function(t){(!e||!e.widgetTypes||S.default.indexOf(e.widgetTypes,t.type)>=0)&&t.start()}),this.focusPage(),this.$scrollWrapper.addClass("accelerated-scroll"),this.animations&&this.animations.start(),this.shadowInteractions?.start(),this.mag.aboveGlobalAnimations&&this.mag.aboveGlobalAnimations.start(),this.lightboxModel||this.createLightbox(),this.mag.showSafari26GlassToolbarFix(this.hasFixedWidgets||this.mag.aboveGlobalWidgets?.length),this},stop:function(e){if(this.started)return e=e||{},this.started=!1,this.trigger("stopped"),this.$scrollWrapper.removeClass("accelerated-scroll"),S.default.each(this.widgets,function(t){(!e||!e.widgetTypes||S.default.indexOf(e.widgetTypes,t.type)>=0)&&t.stop()}),this.animations&&this.animations.stop(),this.mag.aboveGlobalAnimations&&this.mag.aboveGlobalAnimations.stop(),this.shadowInteractions?.stop(),this},getUrl:function(){return window.location.protocol+"//"+window.location.hostname+"/p"+this.num_id+"/"},setPosition:function(e,t){this.lastPosition===e&&this.lastNeighbour===t||(this.$el.removeClass("center-page prev-page next-page neighbour").addClass(e+"-page "+(t?"neighbour":"")),this.lastPosition=e,this.lastNeighbour=t)},getScroll:function(e=!1){return e?this.visibleWidgetsCoords.scrollTopUnlim:this.visibleWidgetsCoords.scrollTop},scrollOnVerticalMode:function(e){this.hasScrollOnVerticalMode=!0;let t,i,o,r=this.pageHeight-this.pageBgHeight;o=-e,e<0?(t=-e,i=0,o=-e):r>=e?(t=0,i=-e):(t=r-e,i=-r),this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.scrollTop=-i,this.visibleWidgetsCoords.scrollTopUnlim=-o,this.animations&&this.animations.onScroll({forceApply:!this.isStickyVerticalViewer}),this.trigger("page_scroll",this.getScroll()),this.trigger("page_scroll_unlim",this.getScroll(!0)),!this.isStickyVerticalViewer&&(this.$el.css("top",0),_.applyTransform(this.$el,t?"translateY("+t+"px) translateZ(0)":""),this.hasFixedWidgets?(this.$contentBounds.css({top:i}),_.applyTransform(this.$contentBounds,"")):(this.$contentBounds.css({top:""}),_.applyTransform(this.$contentBounds,i?"translateY("+i+"px)":"")))},resetScrollOnVerticalMode:function(){this.hasScrollOnVerticalMode&&(this.hasScrollOnVerticalMode=!1,this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.scrollTop=0,this.visibleWidgetsCoords.scrollTopUnlim=0,this.animations&&this.animations.onScroll({forceApply:!this.isStickyVerticalViewer}),!this.isStickyVerticalViewer&&(this.$el.css("top",""),_.applyTransform(this.$el,""),this.hasFixedWidgets?this.$contentBounds.css("top",0):_.applyTransform(this.$contentBounds,"")))},hide:function(){return this.shown&&(this.$el.addClass("hidden"),this.widgetFetchController?.abort(),this.whenWidgetsFetched=void 0,this.shown=!1),this},destroyAllWidgets:function(e){this.loaded=!1,this.videoBGStarted=!1,S.default.each(this.widgets,function(t,i){let o=this.widgetsData.some(function(r){let n=O.normalizeAnimations(r.animation),s=r._id===t._id&&!!n.find(p=>!O.isEmpty(p)),a=r._id===t._id&&(r.viewport_default&&r.viewport_default.hidden||r.viewport_tablet_portrait&&r.viewport_tablet_portrait.hidden||r.viewport_phone_portrait&&r.viewport_phone_portrait.hidden||r.hidden);return s||a});(!e||!e.includes(t.type)||o)&&(t.destroy(),t.off(),delete this.widgets[i])}.bind(this)),this.animations&&this.animations.destroy(),this.shadowInteractions?.destroy(),delete this.animations,clearTimeout(this.fireReadyTimeout)},destroy:function(){return this.retargetScroll&&this.retargetScroll.restore&&this.retargetScroll.restore(),this.resetWaitForAnimationEnd(),this.destroyLQBackground({animate:!1}),this.destroyAllWidgets(),this.remove()},isSwipeInProgress:function(){return this.$el.hasClass("swiping")},getPageZIndex:function(){return this.zIndex||1},getImmediatePack:function(){return S.default.filter(this.widgets,function(e){return e.canRenderImmediately()&&!e.rendered})},getWidgetsPacks:function(){if(!this.widgets)return[];let e=this.visibleWidgetsCoords,t=(e.top+(e.scrollTop||0))/e.scale,i=(e.bottom+(e.scrollTop||0))/e.scale,o=i-t,r=[],n,s,a=[];if(this.BGWidget&&!this.BGWidget.rendered&&!this.BGWidget.loaded&&a.push(this.BGWidget),this.fixedWidgets&&this.fixedWidgets.length){let T;for(n=0;n<this.fixedWidgets.length;n++)T=this.fixedWidgets[n],!T.rendered&&!T.loaded&&!T.canRenderImmediately()&&a.push(T)}let p=[],c=99999,w=-99999,v,M=!1,P;for(n=0;n<this.widgets.length;n++)s=this.widgets[n],!s.rendered&&!s.loaded&&s.type!="background"&&!s.fixed_position&&(P=at.getScreenIndex(s,t,o,!0),v=P.index,c=Math.min(P.start,c),w=Math.max(P.end,w),s.screenIndex=v,v!==1/0&&(p[v]=p[v]||[],p[v].push(s)),M=!0);if(M){for(p[0]&&r.push(p[0]),p[1]&&r.push(p[1]),p[-1]&&r.push(p[-1]),n=2;n<=w;n++)p[n]&&r.push(p[n]);for(n=-2;n>=c;n--)p[n]&&r.push(p[n])}return a.length&&(r.length?r[0]=a.concat(r[0]):r=[a]),r},renderWidgetPack:function(e,t){let i=0,o=0,r=0,n=!1,s;for(s=0;s<e.length;s++){let p=e[s];if(!p.rendered&&!p.loaded&&!p.destroyed){p.canRenderImmediately()||(i++,p.on("loaded destroyed",a,p)),r++;try{p.render()}catch(c){console.error(`Failed to render widget ${p._id}`,c)}}}n=!0,r||t(),i==o&&t();function a(){o++,n&&i==o&&t()}},loadForScreenshotMode:function(){S.default.each(this.widgets,async e=>{try{await e.render(),e.start()}catch(t){e.widgetIsLoaded(),console.error(`WidgetRenderError Failed to render widget ${e._id} for a screenshot. Type: ${e.type} Page: ${this._id} Project: ${this.mag.num_id}`,t.stack?.toString?.()||t.toString?.()||t)}})},createWidgetsForCurrentViewport:function(){this.destroyAllWidgets(["video"]),this.BGWidget=null,this.fixedWidgets=[];let e=this.pageViewport,t=[],i=[],o=99999,r=this,n=this;S.default.each(this.widgetsData,function(c){let w=n.getWidgetViewportData(c,e),v=!this.mag.isPreview&&O.hasExpired(w);!fe[w.type]||w.hidden||v||(!w.fixed_position&&w.z&&w.type!=="background"&&(o=Math.min(o,w.z)),i.push(w))}.bind(this)),o==99999&&(o=0),S.default.each(i,function(c){let w=I.isOn(e,this.mag.getViewportWidth(e),this.mag.viewOpts)&&I.isCSSTransform(),v=this.mag.isPreview&&["phone_portrait","tablet_portrait"].includes(this.mag.viewport);c.fixed_position&&(c.z<o||u.isDesktop()&&!this.mag.isStickyVerticalViewer&&!w&&!v)?c.$fixedContainer=n.$fixedPositionContainer:c.$fixedContainer=n.$fixedPositionContainerTop;let M=null;if(this.widgets&&this.widgets.length&&(M=this.widgets.find(function(G){return G?G._id===c._id:!1})),!fe[c.type])return;let T=M||new fe[c.type](c,r);T.type==="video"&&(T.updateWidgetData(c,r),T.applyBoxStyle(),T?.updateVideoWidget(c)),T.type==="background"&&(n.BGWidget=T,n.hasVideoBG=T.hasVideoBG()),T.isValid()&&(T.fixed_position&&n.fixedWidgets.push(T),t.push(T))}.bind(this)),this.widgets=bt(t,"_id"),this.widgets=Le(this.widgets);let s=I.isOn(e,this.mag.getViewportWidth(e),this.mag.viewOpts)&&I.isCSSTransform();this.animations=new Ue({page:this,widgets:this.widgets}),this.shadowInteractions=ii({page:this,widgets:[...this.widgets,...this.mag.aboveGlobalWidgets||[]],scale:s?1:this.mag.getScale(this.pageViewport)}),this.signalOnLoading(),this._onFontsLoad=[],this._widgetsWithFontsToLoad=[],this._fontLoaderCalled=0,this._widgetsWithFontsCount=0,this._widgetsWithLoadAnimation=0;for(let c of this.widgets)this._widgetsWithFontsCount+=c.hasFontsToLoad()?1:0,this._widgetsWithLoadAnimation+=c.hasLoadAnimation()?1:0;this.hasFixedWidgets=!!this.fixedWidgets.length;let a=u.isDesktop()&&this.pageViewport!=="tablet_portrait",p=this.mag.isPreview&&["phone_portrait","tablet_portrait"].includes(this.mag.viewport);this.$el.removeClass("page-with-fixeds-desktop page-with-fixeds-sticky-or-mobile").toggleClass("page-with-fixeds-desktop",this.hasFixedWidgets&&a).toggleClass("page-with-fixeds-sticky-or-mobile",!!(this.hasFixedWidgets&&(this.isStickyVerticalViewer||!a||s||p))),this.hasFixedWidgets&&!this.retargetScroll&&this.viewerType==="horizontal"&&a&&(this.retargetScroll=We&&We(this.$fixedPositionContainerTop.get(0),this.$scrollWrapper.get(0)),We&&We(this.$fixedPositionContainer.get(0),this.$scrollWrapper.get(0))),this.lastViewportUsedForWidgetsCreation=e},getWidgetViewportData:function(e,t){let i=S.default.clone(e),o={},r=Ke(e.type,e.version),n=["text_w","text_h","em_w","anchor_link_pos","font-size","font-style","font-weight","font-family","color","color-opacity","letter-spacing","baselineShift","hover-color","hover-color-opacity","current-font-size","current-font-style","current-font-weight","current-font-family","current-baselineShift","current-color","current-color-opacity","current-letter-spacing","current-text_w","current-text_h","background-color","background-color-opacity","hover-background-color","hover-background-color-opacity","current-background-color","current-background-color-opacity","border-radius","border-width","border-color","border-color-opacity","hover-border-width","hover-border-color","hover-border-color-opacity","current-border-radius","current-border-width","current-border-color","current-border-color-opacity","icon_h","icon_w"];if(t!=="default"&&e["viewport_"+t]){let s=!_.canUseMinimalViewport(this.mag)&&Rt(e),a=s?Bt(e):!1,p=Ke(e.type,e.version,!1);S.default.each(p,c=>{if(!(e.type==="shape"&&(c==="borders"||c==="weight"||c==="bg_color"))&&!(e.type==="background"&&c==="picture")&&!(e.type==="text"&&e.version===3&&c==="blocks")){if(s&&(o[c]=void 0),L.isGlobalKey(c)){let w=L.getGlobalPrefixedKey(c);o[w]=void 0}s&&$e("viewer.brokenLegacyWidget")?o[c]=a&&!S.default.has(e["viewport_"+t],c)&&r.includes(c)?e[c]:void 0:s&&(o[c]=e.type==="button"&&!S.default.has(e["viewport_"+t],c)&&n.includes(c)?e[c]:void 0)}}),S.default.extend(i,o,S.default.omit(e["viewport_"+t],["_id","modelType"]))}return e.is_global&&L.fillUniqueValues(i,this._id),i},getWidgetById:function(e){return S.default.findWhere(this.widgets,{_id:e})},hasWidget(e){return this.widgetIds.includes(e)},signalOnLoading:function(){let t=this,i=this.widgets?.length||0,o={};S.default.each(this.widgets,function(a){RM.screenshot&&(o[a._id]=setTimeout(function(){a.widgetIsLoaded()},1e4)),a.on("loaded",r,a)},this),this.BGWidget&&this.hasVideoBG&&this.BGWidget.on("videoBGStarted",n,this.BGWidget),i==0&&(this.fireReadyTimeout=setTimeout(s,200));function r(){i--,clearTimeout(o[this._id]),this.type=="background"&&t.destroyLQBackground({animate:!0}),this.hasLoadAnimation()&&(t._widgetsWithLoadAnimation--,t._widgetsWithLoadAnimation||(t.loadAnimationsReady=!0,t.trigger("loadAnimationsReady"))),i||(t.fireReadyTimeout=setTimeout(s,200)),t.trigger("loaded"+this._id)}function n(){t.videoBGStarted=!0,S.default.delay(function(){t.trigger("videoBGStarted")},1300)}function s(){t.loaded=!0,t.trigger("pageLoaded")}},getFontsVariations:function(e,t){let i=K.getUsedFontsFromWidgetsModels({includeCustom:!0,customList:S.default.filter(this.mag.edit_params.fonts,{provider:"custom"}),models:e,excludeUnusedDefault:t,activeViewports:[this.getPageViewport()]},K.fontsShortList),o=[];return S.default.each(i,function(r){for(let n=0;n<r.used_variations.length;n++)o.push({fontFamily:r.css_name,fontWeight:(r.used_variations[n].substr(1,1)-0)*100,fontStyle:r.used_variations[n].substr(0,1)=="n"?"normal":"italic"})}),o},addFontsToLoad:function(e,t){if(this._widgetsWithFontsToLoad.push(e),this._onFontsLoad.push(t),this._fontLoaderCalled++,this._fontLoaderCalled==this._widgetsWithFontsCount){let i=this.getFontsVariations(this._widgetsWithFontsToLoad);if(S.default.isEmpty(i)){this.onAllFontsLoad();return}this._fontsToLoadLeft=i.length,S.default.each(i,S.default.bind(function(o){K.exactWaitForFontLoad(o.fontFamily,o.fontWeight,o.fontStyle,this.onOneFontLoad)},this))}},onOneFontLoad:function(){this._fontsToLoadLeft--,this._fontsToLoadLeft==0&&S.default.delay(this.onAllFontsLoad,500)},onAllFontsLoad:function(){S.default.each(this._onFontsLoad,function(e){e&&e()})},updateViewport:function(){let e=this.getPageViewport(),t=this.pageViewport;e!==t&&(this.pageViewport=e,this.createLQBackground(),this.shown&&(this.loadAnimationsReady=!1,this.createWidgetsForCurrentViewport(),this.started&&(this.started=!1,this.start())))},waitForAnimationEnd:function(e){this.resetWaitHook=_.waitForTransitionEnd(this.$el,this.mag.getPageTransitionTime()+1e3,"transform",e)},resetWaitForAnimationEnd:function(){this.resetWaitHook&&this.resetWaitHook()},backToTop:function(){this.scrollTo(0)},scrollTo:function(e,t=!0){this.$scrollWrapper.finish(),this.$scrollWrapper&&this.$scrollWrapper.animate({scrollTop:e},t?500:0)},focusPage:function(){u.isDesktop()&&this.viewerType!=="vertical"&&(_.isIframe()||this.$el[0].getBoundingClientRect().left===0&&(this.$content.focus(),this.mag.$el.scrollTop(0)))},markAsLast:function(){this.lastPage=!0,this.$el.addClass("last")},isLastPage:function(){return!!this.lastPage},isBottomArrowVisible:function(){return!this.wasScrolled&&this.scrollable},isPasswordProtected:function(){return this.unauthorized},scrollPageALittle:function(){this.$scrollWrapper.animate({scrollTop:(0,ke.default)(window).height()/2},500)},getPageViewport:function(){let e=this.mag.viewport,t=this;if(e==="default")return"default";if(!this["viewport_"+e]||!this["viewport_"+e].enabled){let i=S.default.findWhere(V.viewports,{name:e}).width,o=S.default.reduce(V.viewports,function(r,n,s){return n.name!="default"&&(!t["viewport_"+n.name]||!t["viewport_"+n.name].enabled)?r:Math.abs(n.width-i)<=Math.abs(V.viewports[r].width-i)?s:r},0);return V.viewports[o].name}else return e},onResizeAfterWidgetDrag(){this.reasizeAfterDragSet=!1,this.onResize()},onResize:function(e){if(e=e||{},this.mag.isWidgetDragging){this.reasizeAfterDragSet||(this.reasizeAfterDragSet=!0,this.mag.once("widget:drag:stopped",this.onResize.bind(this)));return}if(this.mag.isEcwidOpened||!this.shown&&this.viewerType==="horizontal")return;let t=["phone_portrait","tablet_portrait"].includes(this.mag.viewport)&&this.pageViewport==="default"&&this.mag.isPreview,i=this.pageViewport==="phone_portrait"&&this.mag.viewOpts.phoneVerticalAlign==="top",o=this.mag.getContainerSizeCached(),r=this.mag.getViewportWidth(this.pageViewport),n=V.dictionary[this.pageViewport].width,s=this.mag.getScale(this.pageViewport),a=this["viewport_"+this.pageViewport]&&this["viewport_"+this.pageViewport].height||this.height,p={width:n,height:a,scaledWidth:Math.round(r*s),scaledHeight:Math.round(a*s),scale:s},c=RM.screenshot&&Ce("pdf")==="true",w=Math.min(p.scaledWidth,o.width),v=this.pageViewport==="default"?672:V.dictionary[this.pageViewport].min_height,M=p.scaledHeight,P=c||i?0:Math.max(((RM.screenshot?v:o.height)-M)/2,0),T=Math.max(((RM.screenshot?V.dictionary[this.pageViewport].width:o.width)-w)/2,0)+(r-n)/2,G={width:p.width,height:p.height,top:i?0:P/(I.isCSSZoom()&&I.isDesktopDefault(this.pageViewport)&&!t?s:1),left:T};if(I.isOn(this.pageViewport,r,this.mag.opts)&&I.isCSSZoom()&&!t&&(G.zoom=s,G.left=o.width>this.mag.opts.scalewidth?(o.width/s-n)/2:(r-n)/2),this.$content.removeAttr("style"),this.$content.css(G),this.cachedSizes=void 0,this.contentPosition={left:T,top:P},!t&&I.normalize(s,"transform",this.pageViewport,r,this.mag.viewOpts)===1?_.applyTransform(this.$content,""):(_.applyTransform(this.$content,"scale("+p.scale+")"),RM.screenshot&&I.isCSSTransform()&&this.$content.css({"transform-origin":"left top"}),I.isDesktopDefault(this.pageViewport)&&!t?this.$content.css({left:Math.max((o.width-w)/2,0)+(r-n)/2*p.scale}):this.$content.css({left:(r-n)/2*p.scale})),this.contentHeight=a,this.pageHeight=this.isPasswordProtected()?o.height:Math.max(o.height,Math.round(a*s)),this.pageBgHeight=o.height,this.pageWidth=r,this.viewerType==="vertical"&&this.isStickyVerticalViewer&&this.$el.css({height:this.pageHeight,top:e.absolutePosition}),this.scale=s,this.$contentBounds.css({width:o.width,height:this.pageHeight}),this.getSizes(),this.prevScale!==void 0&&this.prevScale!==this.scale&&this.animations){let x=this.animations.animations?.filter(C=>at.findPlayingVideo(C.widgets));this.animations.updateTimelines(x.map(C=>C.animation.UUID)),this.animations.resetStarted(),this.animations.start.__debounced()}return this.animations&&this.animations.onResize(),this.trigger("resize",{containerSize:o,contentPosition:this.contentPosition}),this.scrollable=Math.round(a*s)-this.mag.SCROLLABLE_TRESHOLD>o.height,this.mag.recalcBottomArrowState(this),this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.top=-P,this.visibleWidgetsCoords.bottom=-P+o.height,this.visibleWidgetsCoords.scale=s,this.resizeLQBackground(),this.prevScale=this.scale,this.pageHeight},onScroll:function(){this.wasScrolled=!0,this.mag.recalcBottomArrowState(this),this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.scrollTop=this.$scrollWrapper.scrollTop(),this.visibleWidgetsCoords.scrollTopUnlim=this.$scrollWrapper.scrollTop(),this.mag.onCurrentPageScroll(this,this.visibleWidgetsCoords.scrollTop),this.animations&&this.animations.onScroll(),this.trigger("page_scroll",this.visibleWidgetsCoords.scrollTop),this.trigger("page_scroll_unlim",this.visibleWidgetsCoords.scrollTopUnlim)},isCurrent:function(){return this.num===this.mag.currentPage.num},showPagePasswordForm:async function(){let{getForbiddenForPage:e}=await import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-2HKMZHNG.js");e(document.getElementById(`page-${this.num}-password-container`))},createLQBackground:function(){if(RM.screenshot||this.isPasswordProtected())return;let e=this.widgetsData.find(i=>i.type==="background");if(!e)return;let t=this.getWidgetViewportData(e,this.pageViewport);if(this.LQBG)if(t.selectedType==="picture"&&this.LQBG.selectedType==="picture"&&t.picture&&this.LQBG.picture&&t.picture.poorUrl===this.LQBG.picture.poorUrl||t.selectedType==="video"&&this.LQBG.selectedType==="video"&&t.video&&this.LQBG.video&&t.video.thumbnail_url===this.LQBG.video.thumbnail_url){this.resizeLQBackground();return}else this.destroyLQBackground({animate:!1});if(this.$fixedBgContainer.css("background-color","#"+t.color),t.picture&&t.selectedType==="picture"&&(t.picture.poorUrl||Ge.useLambdaUrl(t.picture))||t.video&&t.selectedType==="video"&&t.video.thumbnail_url){this.LQBG=S.default.extend({},t);let i=oi["template-viewer-widget-background"];if(this.LQBG.$el=(0,ke.default)(i({data:t})),this.LQBG.$el.addClass("low-quality").appendTo(this.$fixedBgContainer),this.LQBG.selectedType==="picture"){let o=this.LQBG.picture.poorUrl;Ge.useLqipUrl(t.picture)&&(o=Ge.getLqipUrl(this.LQBG.picture),this.LQBG.$el.addClass("lqip").appendTo(this.$fixedBgContainer)),(0,ke.default)("<img/>").on("load",S.default.bind(function(){this.LQBG&&this.LQBG.$el.find(".picture-background").css({"background-image":`url(${o})`})},this)).attr("src",o)}if(this.LQBG.selectedType==="video"){let o=this.LQBG.video.thumbnail_url.replace("http://","https://"),r=(0,ke.default)("<img/>").addClass("poster").css("opacity",0).appendTo(this.LQBG.$el.find(".video-background .video-container"));r.on("load",S.default.bind(function(){r.css({width:"",height:""}).css("opacity",1);let n=r[0].width,s=r[0].height;this.LQBG&&!this.LQBG.video.aspect_poster&&(this.LQBG.video.aspect_poster=n/s),this.resizeLQBackground()},this)).attr("src",o)}}},resizeLQBackground:function(){RM.screenshot||this.isPasswordProtected()||!this.LQBG||this.LQBG.selectedType==="video"&&Gt.setVideoPosition({mag:this.mag,$container:this.LQBG.$el.find(".video-background .video-container"),$media:this.LQBG.$el.find(".video-background .video-container .poster"),provider:this.LQBG.video.provider_name,aspect_poster:this.LQBG.video.aspect_poster,aspect_real:this.LQBG.video.aspect_real,controls_remove:!0})},destroyLQBackground:function(e={}){if(RM.screenshot||this.isPasswordProtected()||!this.LQBG)return;e.animate=e.animate&&this.LQBG.selectedType==="picture"&&this.started;let t=this.LQBG.$el;this.LQBG=null,e.animate?(t.css("opacity",0),setTimeout(function(){t.remove()},400)):t.remove()},fixSafariScroll:function(){if(!Modernizr.safari||!u.isDesktop())return;this.$scrollWrapper.scrollTop()!==0&&this.$scrollWrapper.scrollTop(0)},getSizes:function(){return{scrollWrapperWidth:this.$scrollWrapper.width(),scrollWrapperClientWidth:this.$scrollWrapper[0].clientWidth,contentContainerWidth:this.$content.width(),contentContainerHeight:this.$content.height()}},getCachedSizes:function(){return this.cachedSizes||(this.cachedSizes=this.getSizes()),this.cachedSizes},getLightboxWidgets(){return this.lightboxWidgets=Ut(this.widgets),this.lightboxWidgets},async createLightbox(){if(this.widgetsData?.some(t=>{if(t.type==="picture"){let o=!!t.lightbox;return o||(o=["tablet_portrait","phone_portrait"].some(r=>t[`viewport_${r}`]&&!!t[`viewport_${r}`].lightbox)),o}return!1})){let{default:t}=await import("https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-V3JRI5EI.js");this.lightboxModel=new st.default.Model({isVisible:!1,slides:this.getLightboxWidgets(),index:0,originRect:{},onClose:()=>{this.lightboxModel.set({isVisible:!1}),this.mag.navigation?.show(!0),this.mag.navigation?.enable()},onSlideChange:o=>this.lightboxModel.set({index:o})}),(0,ke.default)("<div/>").addClass("lightbox-wrapper").appendTo(this.$el),He({component:()=>nt.default.createPortal(Ct(t,{}),document.body),domElement:this.$el.find(".lightbox-wrapper").get(0),model:this.lightboxModel,onDestroy:()=>{let o=this.$el.find(".lightbox-wrapper").get(0);nt.default.unmountComponentAtNode(o),o&&o.parentNode&&o.parentNode.removeChild(o)}})}},showLightboxSlide(e){this.mag.navigation?.hide(!0),this.mag.navigation?.disable();let t=this.lightboxWidgets.findIndex(i=>i._id===e._id);t>-1&&this.lightboxModel.set({isVisible:!0,index:t,slides:this.getLightboxWidgets(),originRect:Yt({widgetElement:e.$el.get(0),viewportWidth:this.mag.getViewportWidth(this.pageViewport),viewport:this.pageViewport,viewerOptions:this.mag.viewOpts})})}},{getScreenIndex:function(e,t,i,o){let r,n=Math.floor((e.y-t)/i),s=Math.ceil((e.y+e.h-t)/i)-1;return o&&e.canRenderImmediately()?r=1/0:e.hasLoadAnimation()||n<=0&&s>=0?r=0:n>0?r=n:s<0&&(r=s),{start:n,end:s!==1/0?s:0,index:r}},findPlayingVideo(e=[]){return e.find(t=>t.type==="video"&&t.isPlaying)}}),Ie=at;var m=$(ze()),ct=$(ye()),g=$(xe());Te();var ri={"template-viewer-mag":Z`
  <main class="mag">
    <div class="mag-pages-container">
      <div class="container disable-transitions">
        <div class="blackout"></div>
      </div>
      <div class="above-pages-container"></div>
    </div>

    <% if (hasStandaloneBottomArrow) {%>
      <div class="navigation-arrow bottom offscreen">
        <div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>
      </div>
    <% } %>

    <% if (isPreview) {%>
      <div class="mag-pages-viewport-device"></div>
    <% } %>
  </main>
`};Oi();Be();Ze();Ot();Si();Dt();It();tt();De();zt();Pi();be();Ni();Mi();var Pe=$(ze()),si=$(ye()),Y=$(xe());Be();Te();var ni={"template-viewer-navigation":Z`
	<div class="navigation">
		<div class="navigation-arrow left offscreen" role="button" aria-label="Previous page">
			<div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>
		</div>
		<div class="navigation-arrow right offscreen" role="button" aria-label="Next page">
			<div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>
		</div>
		<div class="navigation-arrow bottom offscreen" role="button" aria-label="Scroll down">
			<div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>
		</div>
	</div>
`};be();Oe();De();var ji=si.default.View.extend({ARROWS_SHOW_DELAY:1e3,BOTTOM_SHOW_DELAY:1e3,BOTTOM_HIDE_DELAY:0,template:ni["template-viewer-navigation"],events:{"click .navigation-arrow.left":"goPrevPage","click .navigation-arrow.right":"goNextPage","click .navigation-arrow.bottom":"scrollCurrentPage"},initialize:function(e){return Y.default.bindAll(this),Y.default.extend(this,e),this.updateScaleState.__debounced=Y.default.debounce(this.updateScaleState,100),this.canSwitchPages=!0,this},render:function(){return this.setElement(this.template({icons:{sprite:q(`./common/navigation/sprite${ne?"@2x":""}.png`)}})),this.$el.appendTo(this.$container),this.$prev=this.$(".navigation-arrow.left"),this.$next=this.$(".navigation-arrow.right"),this.$bottom=this.$(".navigation-arrow.bottom"),Y.default.delay(Y.default.bind(function(){this.$prev.removeClass("offscreen"),this.$next.removeClass("offscreen")},this),this.ARROWS_SHOW_DELAY),this.setArrowsPosition(this.mag.currentPage),this.listenTo(this.mag,"pageChanged",this.setArrowsPosition),this.listenTo(this.mag,"keypress-"+Pe.default.keycodes.left,this.goPrevPage),this.listenTo(this.mag,"keypress-"+Pe.default.keycodes.right,this.goNextPage),u.isDesktop()&&(0,Pe.default)(window).bind("mousewheel",this.onMouseWheel),u.isDesktop()||((0,Pe.default)(window).bind("gesturechange",this.updateScaleState.__debounced),this.updateScaleState(),this.mag.getPagesCount()>1&&this.setSwipeAction()),this},destroy:function(){return u.isDesktop()&&(0,Pe.default)(window).unbind("mousewheel",this.onMouseWheel),u.isDesktop()||((0,Pe.default)(window).unbind("gesturechange",this.updateScaleState.__debounced),this.pagesSwipe&&this.pagesSwipe.destroy()),this.remove()},onMouseWheel:function(e,t,i,o){this.preventTrackpadSwipeTill&&+new Date<this.preventTrackpadSwipeTill||Math.abs(i)>40&&Math.abs(i)>Math.abs(o)&&(i>0&&this.goPrevPage(),i<0&&this.goNextPage(),this.preventTrackpadSwipeTill=+new Date+1e3)},setSwipeAction:function(){this.pagesSwipe=this.mag.$mag_container.RMSwipe({$scrollElements:this.mag.$mag_container,getMaxTransitionSpeed:Y.default.bind(function(){return this.mag.getPageTransitionTime()},this),customMoveCheck:Y.default.bind(function(e,t){return!(e.hasClass("prev-page")&&t<0||e.hasClass("next-page")&&t>0)},this),beforeAutoAnimation:Y.default.bind(function(e){return this.mag.showPageCounter(e),{autoAnimate:!0,immediateCallback:!1}},this),onSwipeStart:Y.default.bind(function(){this.mag.showPageCounter()},this),getCurrentConstraints:Y.default.bind(function(e){let t={},i=this.mag.$mag_container.width(),o=e.closest(".page, .final-page");return o.length||(o=this.mag.currentPage.$el),t.$moveItems=o.add(o.prev()).add(o.next()),t.$referenceItem=t.$moveItems.filter(":not(.center-page)").first(),this.mag.isWidgetDragging?(t.left={max:0,noTrigger:!0},t.right={max:0,noTrigger:!0},t):(this.mag.isLastPage()?t.left={max:0,noTrigger:!0}:t.left={max:i},this.mag.isFirstPage()?t.right={max:0,noTrigger:!0}:t.right={max:i},t)},this),callback:Y.default.bind(function(e){e==="right"&&this.mag.goPrevPage({animation:!1,bySwipe:!0}),e==="left"&&this.mag.goNextPage({animation:!1,bySwipe:!0})},this)}).data("swipe")},setArrowsPosition:function(e){this.$next.toggleClass("hidden",!!this.mag.isLastPage()),this.recalcBottomArrowState(e),this.$prev.toggleClass("hidden",this.mag.isFirstPage()),this.mag.updateArrowsColor(e)},recalcBottomArrowState:function(e){clearTimeout(this.bottomArrowTimeout);let t=e?.isBottomArrowVisible();this.viewerType==="horizontal"&&I.isScaleLayout(this.mag.viewOpts)&&(t=!1),this.isPreview&&this.mag.viewport!=="default"&&(t=!1),this.bottomArrowTimeout=setTimeout(Y.default.bind(function(){this.$bottom.toggleClass("offscreen",!t)},this),t?this.BOTTOM_SHOW_DELAY:this.BOTTOM_HIDE_DELAY)},goPrevPage:function(){this.canSwitchPages&&this.mag.goPrevPage({animation:!0})},goNextPage:function(){this.canSwitchPages&&this.mag.goNextPage({animation:!0})},scrollCurrentPage:function(){this.canSwitchPages&&this.mag.scrollCurrentPageALittle()},updateScaleState:function(){Modernizr.android||this.$prev.add(this.$next).add(this.$bottom).toggleClass("scaled-offscreen",_.isPageNativelyScaled())},hide:function(e=!1){for(let t of[this.$prev,this.$next,this.$bottom])e?t.fadeOut(200):t.hide()},show:function(e=!1){for(let t of[this.$prev,this.$next,this.$bottom])e?t.fadeIn(200):t.show()},disable:function(){this.canSwitchPages=!1},enable:function(){this.canSwitchPages=!0}}),pt=ji;var lt=$(ze()),gi=$(ye()),Ye=$(xe());Te();var ai={"template-viewer-toolbar":Z`

	<div class="toolbar for-viewer <%= viewport %>">

		<%	var offscreenClass = (isPreview || common.embedMode) ? '' : 'offscreen-initially'; %>

		<% if (hasPageCounter && !pageCounterInsideMenu) { %>
			<div class="page-counter-wrapper <%=offscreenClass%>">
				<div class="page-counter"><span class="cur"></span> of <span class="total"><%=totalPages%></span></div>
			</div>
		<% } %>

		<% if (brandingInToolbar) { %>
			<div class="toolbar-branding"></div>
		<% } %>

		<% if (hasShare) { %>
			<div class="share-button sprite <%=offscreenClass%>" role="button" aria-label="Share" data-alt="Share" data-alt-pos="<%= !controlsOnTop ? 'top' : 'bottom' %>" data-alt-offset="9"  data-alt-style="toolbar-share-tooltip" style="background-image: url('<%=icons.sprite%>')"></div>
		<% } %>

		<% if (hasMenu) { %>
			<div class="menu-button <%=offscreenClass%>" role="button" aria-label="Menu" data-alt="Menu (M)" data-alt-pos="<%= !controlsOnTop ? 'top' : 'bottom' %>" data-alt-offset="9" data-alt-style="toolbar-menu-tooltip">
				<% if (hasPageCounter && pageCounterInsideMenu) { %>
					<div class="page-counter"><span class="cur"></span> of <span class="total"><%=totalPages%></span></div>
				<% } %>

				<svg class="menu-icon" width="32" height="14" viewBox="0 0 32 14">
					<g fill="currentColor" fill-rule="evenodd"><path d="M1 0h30a1 1 0 010 2H1a1 1 0 110-2zM1 12h30a1 1 0 010 2H1a1 1 0 010-2z"/></g>
				</svg>
				<svg class="cross-icon" width="18" height="18" viewBox="0 0 18 18">
					<path d="M17.485.515a1 1 0 010 1.414L10.415 9l7.07 7.071a1 1 0 01-1.414 1.414L9 10.415l-7.071 7.07a1 1 0 01-1.414-1.414L7.585 9 .516 1.929A1 1 0 011.929.515L9 7.585l7.071-7.07a1 1 0 011.414 0z" fill="currentColor" fill-rule="evenodd"></path>
				</svg>
				<div class="page-preloader sprite" style="background-image: url('<%=icons.sprite%>')"></div>
			</div>
		<% } %>

		<% if (common.embedMode) { %>
			<div class="embed-close-button <%=offscreenClass%>" role="button">Close</div>
		<% } %>

	</div>

	<% if (!brandingInToolbar) { %>
		<div class="fancy-button"></div>
	<% } %>

`};var ae=$(ze()),li=$(ye()),ge=$(xe());Te();var pi={"template-viewer-share":Z`
	<% if (hasOverlay) {%>
		<div class="share-popup-overlay hidden" data-nosnippet></div>
	<%}%>

	<div class="share-popup hidden" data-nosnippet>
		<noindex>
			<div class="content-wrapper">

				<div class="share-wrapper">
					<div class="caption">Share</div>

					<div class="type-selector">
						<!--__magterm-->
						<div class="type-full">Project</div>
						<div class="type-page">Current Page</div>
						<div class="arrow sprite" style="background-image: url('<%=icons.sprite%>')"></div>
					</div>

					<div class="buttons-wrapper">
						<div class="share-facebook button" data-tp="facebook"><div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>Share</div>
						<div class="share-twitter button" data-tp="twitter"><div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>Tweet</div>
						<div class="share-pinterest button" data-tp="pinterest"><div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>Pin</div>
						<div class="share-linkedin button" data-tp="linkedin"><div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>Linkedin</div>
					</div>

					<% if (!common.isDownloadedSource) { %>
						<div class="close">Close</div>
						<div class="send-report" data-tp="report"><div class="icon sprite" style="background-image: url('<%=icons.sprite%>')"></div>Report</div>
					<% } %>
				</div>
			</div>

			<div class="corner-wrapper">
				<div class="corner"></div>
			</div>
		</noindex>
	</div>
`};Dt();Ze();be();Oe();var Qi=li.default.View.extend({template:pi["template-viewer-share"],events:{"click .buttons-wrapper .button":"share","click .send-report":"share","click .close":"hide","click .type-selector":"onTypeSelectorClick","click .size-selector":"onSizeSelectorClick",click:"onClick"},initialize:function(e){return ge.default.bindAll(this),ge.default.extend(this,e),this},render:function(){return this.setElement(this.template({hasOverlay:u.isMobile(),common:RM.common,icons:{sprite:q(`./viewer/share/sprite${ne?"@2x":""}.png`),thumbArrows:q(`./viewer/share/thumb-arrows${ne?"@2x":""}.png`),thumbOpen:q(`./viewer/share/thumb-open${ne?"@2x":""}.png`)}})),this.$el.appendTo(this.$container),this.selectFullMode(),u.isMobile()&&(this.shareSwipe=this.$el.RMSwipe({minTransitionSpeed:200,maxTransitionSpeed:400,rubberBand:!1,beforeAutoAnimation:ge.default.bind(function(){return{autoAnimate:!0,immediateCallback:!0}},this),getCurrentConstraints:ge.default.bind(function(){let e={},t=this.$el.filter(".share-popup");return e.$referenceItem=t,e.$moveItems=t,e.up={max:0,noTrigger:!0},e.down={max:t.height()},e},this),callback:ge.default.bind(function(){this.hide()},this)}).data("swipe")),this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"keypress-"+ae.default.keycodes.esc,this.hide),(0,ae.default)("body").on("click",this.hideOnBodyClick),this},show:function(){return this.shown||(clearTimeout(this.hideTimeout),this.$el.removeClass("hidden"),this.$el.height(),this.$el.addClass("show-popup"),this.$container.addClass("no-hover"),this.shown=!0),this},toggle:function(){return this.shown?this.hide():this.show()},hide:function(){return this.shown&&(this.$el.removeClass("show-popup"),this.$container.removeClass("no-hover"),this.hideTimeout=setTimeout(ge.default.bind(function(){this.closeEmbed(),this.$el.addClass("hidden")},this),400),this.shown=!1),this},destroy:function(){return clearTimeout(this.hideTimeout),(0,ae.default)("body").off("click",this.hideOnBodyClick),this.shareSwipe&&this.shareSwipe.destroy(),this.remove()},hideOnBodyClick:function(e){u.isMobile()||(0,ae.default)(e.target).closest(this.$container).length||this.hide()},onPageChange:function(){this.hide()},onClick:function(e){u.isMobile()&&(0,ae.default)(e.currentTarget).hasClass("share-popup-overlay")&&this.hide()},share:function(e){Ne.share({host:(RM.common.embedDomainName||window.location.protocol+"//"+window.location.hostname)+"/",tp:(0,ae.default)(e.currentTarget).attr("data-tp"),source:"share panel",page:this.mag.currentPage||this.mag.pages[0],mag:ge.default.extend(this.mag.model.toJSON(),{user:this.mag.user}),forProject:this.shareMode==="full",customDomain:!!(RM.common.isDomainViewer||RM.common.embedDomainName),customDomainProfile:!!(RM.common.customDomainProfile||RM.common.embedDomainType==="User"),analytics:this.router.analytics,exportBasePath:window.RM.common.isDownloadedSource?window.RM.config&&window.RM.config.root:void 0,supportMail:U.SUPPORT_MAIL})},onTypeSelectorClick:function(e){if(u.isMobile()){let t=(0,ae.default)(e.target);t.closest(".type-full").length&&this.selectFullMode(),t.closest(".type-page").length&&this.selectPageMode()}else(this.$(".type-selector").attr("data-tp")||"page")==="page"?this.selectFullMode():this.selectPageMode()},onSizeSelectorClick:function(e){let t=(0,ae.default)(e.currentTarget),i=t.attr("data-selected"),o,r;o=ge.default.map(t.find(".size"),function(n){return(0,ae.default)(n).attr("data-size")}),r=o.indexOf(i)+1,r=r>=o.length?0:r,t.attr("data-selected",o[r])},selectPageMode:function(){this.$(".type-selector").attr("data-tp","page"),this.shareMode="page"},selectFullMode:function(){this.$(".type-selector").attr("data-tp","full"),this.shareMode="full"}},{getEmbedCode:function(e){let t,i,o,r,n=U.EMBED_SCRIPT_INIT,s='<script async src="'+n+'" id="readymag-embed-init"><\/script>',a,p;return p=e.hostname||window.location.hostname,t=RM.common.embedDomainName||window.location.protocol+"//"+p,i=e.shareMode==="full"?e.mag_num_id:"p"+e.cur_page_num_id,a=' data-uri="'+i+'" ',a+=' data-width="'+e.size+'" ',(RM.common.isDomainViewer||RM.common.embedDomainName)&&(a+=' data-domain="'+t+'" ',!RM.common.customDomainProfile&&RM.common.embedDomainType!=="User"&&(i=e.shareMode==="full"?"":"p"+e.cur_page_num_id)),U.isProd||(a+=' data-origin="'+U.readymag_embed_host+'" '),o=t+"/"+i,r='<a class="rm-mag-embed" href="'+o+'"'+a+' target="_blank">'+o+`</a>
`,r+s}}),ci=Qi;var F=$(ze()),hi=$(ye()),pe=$(xe());Te();var di={"template-viewer-mag-menu":Z`
	<noindex>
		<div class="mag-menu <%=(!hasProjectInfo ? 'no-project-info' : '')%> <%= viewport %>" data-nosnippet>
			<div class="menu-wrapper">
				<div class="scroll-wrapper">
					<div class="pages-wrapper has-<%=viewerType%>-scroll">
						<div class="pages">

							<%_.each(pages, function(page, index) {
								var direction = viewerType == 'horizontal' ? 'left' : 'top';
								var offset = index * (viewerType == 'horizontal' ? frameWidth : frameHeight);
								var screenshot = getScreenshot(page._id);
							%>
								<div class="page" data-id="<%=page._id%>" data-num="<%=page.num%>" data-src="<%= screenshot.src %>" style="width:<%=frameWidth%>px;height:<%=frameHeight%>px;<%=direction%>:<%=offset%>px" role="button" aria-label="Page <%=page.num%>">
									<img class="screenshot" src="<%=stub%>" style="width:<%= screenshot.width %>px; height:<%= screenshot.height %>px; margin: auto; top: 0; bottom: 0; left: 0; right: 0;" />
									<% if (page.unauthorized) { %>
									<div class="private-page"></div>
									<% } %>
									<div class="num <%=(page.pageNestedNum && page.pageNestedNum.length > 3 ? page.pageNestedNum.length > 4 ? 'nested-over-4' : 'nested-over-3' : page.num > 99 ? 'over99' : '')%>"><%=page.pageNestedNum ? page.pageNestedNum : page.num%></div>
								</div>
							<%});%>

						</div>
					</div>
					<div class="scroll"></div>
				</div>
			</div>
		</div>
	</noindex>
`};be();Oe();Re();$i();var qi=hi.default.View.extend({template:di["template-viewer-mag-menu"],events:{"click .page":"onPageClick"},initialize:function(e){pe.default.bindAll(this),pe.default.extend(this,e),this.IMG_STUB=q("./spacer.gif");let t=this.mag.viewport,i=this.viewerType==="vertical",o=t==="phone_portrait"||t==="tablet_portrait",r=o&&i?{width:120}:!o&&i?{width:240}:u.isMobile()&&!i?{height:213}:{height:184};return{width:this.PAGE_WIDTH,height:this.PAGE_HEIGHT}=Et(t,r),this.loadVisibleScreenshots.__debounced=pe.default.debounce(this.loadVisibleScreenshots,500),this.unloadInvisibleScreenshots.__debounced=pe.default.debounce(this.unloadInvisibleScreenshots,3e3),this},render:function(){let e=this.mag.viewport;this.setElement(this.template({mag:this.mag,pages:this.pages,frameWidth:this.PAGE_WIDTH,frameHeight:this.PAGE_HEIGHT,stub:this.IMG_STUB,viewerType:this.viewerType,publishDate:this.publishDate,hasProjectInfo:this.hasProjectInfo,common:RM.common,viewport:e,getScreenshot:i=>this.mag.model.getPageScreenshot({_id:i},{width:this.PAGE_WIDTH,height:this.PAGE_HEIGHT},e)})),this.$el.appendTo(this.$container),this.mag.currentPage&&this.setActivePage(this.mag.currentPage.num),this.$pagesWrapper=this.$(".pages-wrapper");let t=this.$(".page");if(this.viewerType=="horizontal"?(this.$(".pages").css("width",t.length*this.PAGE_WIDTH),this.$pagesWrapper.scrollLeft(99999)):(this.$(".pages").css("height",t.length*this.PAGE_HEIGHT),this.$pagesWrapper.scrollTop(99999)),u.isDesktop()&&(this.scroll=this.$(".scroll-wrapper").RMScroll({$container:this.$pagesWrapper,$content:this.$(".pages"),$handle:this.$(".scroll"),wheelScrollSpeed:1.3,gap_start:8,gap_end:8,maxHandleSize:136,dragScroll:!0,tp:this.viewerType}).data("scroll")),this.$pagesWrapper.bind("scroll",this.onScroll),this.cacheSize(),this.cacheScroll(),this.cachePagesPos(),this.loadedScreenshots={},this.showInitially&&(this.loadVisibleScreenshots(),this.show(!0)),this.viewerType=="horizontal"&&u.isMobile()||(0,F.default)(".menu-info .mag-title").dotdotdot({height:u.isMobile()?48:68,wrap:"letter",callback:pe.default.bind(function(i){i&&this.$(".menu-info .mag-title").attr("title",this.mag.title)},this)}),!u.isDesktop()){let i=this.viewerType=="horizontal"?this.$el.height():this.$el.width(),o=this.$el.add(this.$toolbar);this.viewerType=="horizontal"&&this.mag.navigation&&(o=o.add(this.mag.navigation.$bottom)),this.menuSwipe=o.RMSwipe({$scrollElements:this.$pagesWrapper,minTransitionSpeed:200,maxTransitionSpeed:400,rubberBand:!1,getCurrentConstraints:pe.default.bind(function(){let r={};return r.$referenceItem=this.$el,this.viewerType=="horizontal"?this.shown?r={up:{max:0,noTrigger:!0},down:{max:i}}:r={up:{max:i},down:{max:0,noTrigger:!0}}:this.shown?r={left:{max:0,noTrigger:!0},right:{max:i}}:r={left:{max:i},right:{max:0,noTrigger:!0}},r},this),callback:pe.default.bind(function(){this.shown?this.hide():this.show()},this)}).data("swipe")}return this.isPreview&&this.listenTo(RM.constructorRouter,"renewScreenshot",this.onConstructorScreenshotRenew),this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"keypress-"+F.default.keycodes.m,this.toggle),this.listenTo(this.mag,"keypress-"+F.default.keycodes.esc,this.hide),(0,F.default)(window).on("resize",this.onResize),this.$el.bind("mousewheel",this.onMouseWheel),this},show:function(e=!1){return this.shown||(this.shown=!0,e&&this.$el.css({transition:"none"}),this.mag.$el.addClass("viewer-mag-menu-shown"),(0,F.default)("html").addClass("mag-menu-shown"),this.mag.$el.toggleClass("viewer-mag-menu-no-project-info",!this.hasProjectInfo),this.loadOtherScreenshots(),this.mag.trigger("menuShown"),B.trigger("magMenu:open"),e&&setTimeout(()=>this.$el.css({transition:""}))),this},toggle:function(){return this.shown?this.hide():this.show()},hide:function(){return this.shown&&(this.mag.$el.removeClass("viewer-mag-menu-shown viewer-mag-menu-no-project-info"),(0,F.default)("html").removeClass("mag-menu-shown"),this.clearLoadOtherTimeout(),this.mag.focusCurrentPage(),this.shown=!1,this.mag.trigger("menuHidden"),B.trigger("magMenu:close")),this},destroy:function(){return(0,F.default)(window).off("resize",this.onResize),(0,F.default)("html").removeClass("mag-menu-shown"),this.$el.unbind("mousewheel",this.onMouseWheel),this.menuSwipe&&this.menuSwipe.destroy(),this.$pagesWrapper.unbind("scroll",this.onScroll),this.hide(),this.remove()},onMouseWheel:function(e){e.preventDefault()},onResize:function(){this.cacheSize(),this.scroll&&this.scroll.recalc(),this.mag.currentPage&&this.shiftToPage(this.mag.currentPage.num,!1)},onScroll:function(){this.cacheScroll()},cacheSize:function(){this.cachedData=this.cachedData||{},this.cachedData.scrollSize=this.viewerType=="horizontal"?this.$pagesWrapper.width():this.$pagesWrapper.height()},cacheScroll:function(){this.cachedData=this.cachedData||{},this.cachedData.scrollPos=this.viewerType=="horizontal"?this.$pagesWrapper.scrollLeft():this.$pagesWrapper.scrollTop()},cachePagesPos:function(){this.cachedData=this.cachedData||{},this.cachedData.pagesPos={};let e=this.cachedData.pagesPos,t=this.viewerType,i=this.PAGE_WIDTH,o=this.PAGE_HEIGHT;pe.default.each(this.pages,function(r,n){e[r.num]=n*(t=="horizontal"?i:o)})},onPageChange:function(e){this.shown||(this.loadVisibleScreenshots.__debounced(),!u.isDesktop()&&this.unloadInvisibleScreenshots.__debounced()),this.shiftToPage(e.num,this.shown),pe.default.isEmpty(this.loadedScreenshots)&&this.loadVisibleScreenshots()},shiftToPage:function(e,t){let i=this.cachedData.scrollSize,o=this.cachedData.scrollPos,r=this.viewerType=="horizontal"?this.PAGE_WIDTH:this.PAGE_HEIGHT,n=this.cachedData.pagesPos[e],s=o+r/2,a=o+i-r/2,p;if(this.setActivePage(e),n<s)p=n-s;else if(n+r>a)p=n+r-a;else return;let c=this.viewerType=="horizontal"?"scrollLeft":"scrollTop",w={};w[c]=o+p,this.$pagesWrapper.stop().animate(w,t?300:0)},onPageClick:function(e){if(this.scroll&&this.scroll.wasContentDrag)return;let t=(0,F.default)(e.currentTarget).data("num");(!this.mag.currentPage||t!=this.mag.currentPage.num)&&this.mag.showPage(t,{animation:!1})},onConstructorScreenshotRenew(e,t,i){let o=this.$(".page").filter(function(){return(0,F.default)(this).data("id")===e}),r=RM.constructorRouter.mag.pages.find(function(n){return n.id===e});if(r){let n=this.mag.model.get("pages").find(a=>a._id===r.id);n&&["phone_portrait","tablet_portrait"].includes(i)?n[`viewport_${i}`].screenshot=t:n&&(n.screenshot=t);let s=this.mag.model.getPageScreenshot({_id:r.id},{width:this.PAGE_WIDTH,height:this.PAGE_HEIGHT},this.mag.viewport).src;o.attr("data-src")?o.attr("data-src",s):o.find(".screenshot").prop("src",s)}},getVisibleScreenshotRange:function(){let e=this.cachedData.scrollSize,t=this.cachedData.scrollPos,i=this.viewerType=="horizontal"?this.PAGE_WIDTH:this.PAGE_HEIGHT;return{min:Math.max(0,Math.floor(t/i)),max:Math.min(this.mag.getPagesCount()-1,Math.floor((t+e)/i))}},loadVisibleScreenshots:function(){if(!this.mag.pages||!this.mag.pages.length)return;let e=this.getVisibleScreenshotRange(),t=this;this.$(".page").each(function(i){var o=(0,F.default)(this),r=o.attr("data-src");if(i>=e.min&&i<=e.max&&r&&!t.loadedScreenshots[i]){var o=(0,F.default)(this);o.find(".screenshot").prop("src",r),o.removeAttr("data-src"),t.loadedScreenshots[i]=!0}})},unloadInvisibleScreenshots:function(){if(this.shown)return;let e=this.getVisibleScreenshotRange(),t=this;this.$(".page").each(function(i){var o=(0,F.default)(this),r=o.attr("data-src");if((i<e.min||i>e.max)&&!r&&t.loadedScreenshots[i]){var o=(0,F.default)(this);o.attr("data-src",o.find(".screenshot").prop("src")),o.find(".screenshot").prop("src",t.IMG_STUB),delete t.loadedScreenshots[i]}})},loadOtherScreenshots:function(){this.clearLoadOtherTimeout(),this.loadOtherSafeTimeout=500,this.loadNextScreenshot()},loadNextScreenshot:function(){let e=this.getVisibleScreenshotRange(),t=Math.floor((e.min+e.max)/2),i=this.loadedScreenshots,o=this.mag.getPagesCount()-1,r,n,s;for(r=t;r<=o&&i[r];r++);for(n=t;n>=0&&i[n];n--);if(n<0&&r>o)return;r>o?s=n:n<0?s=r:s=r-t>t-n?n:r,i[s]=!0;let a=this.$(".page").eq(s),p=a.find(".screenshot"),c=this;p.one("load error",function(){clearTimeout(c.$curLoadingTimeout),c.loadNextScreenshot()}),this.$curLoadingTimeout=setTimeout(function(){p.off(),c.loadOtherSafeTimeout*=1.1,c.loadNextScreenshot()},this.loadOtherSafeTimeout),p.prop("src",a.attr("data-src")),a.removeAttr("data-src"),this.$curLoadingScreenshot=p},clearLoadOtherTimeout:function(){this.$curLoadingScreenshot&&this.$curLoadingScreenshot.off(),clearTimeout(this.$curLoadingTimeout)},showProjectInfo(e=!0){let t=this.$el.find(".mag-menu");e?t.removeClass("no-project-info"):t.addClass("no-project-info"),this.hasProjectInfo=e},setActivePage(e){let t=this.$('.page[data-num="'+e+'"]');return this.$(".page.active").removeClass("active"),t.addClass("active"),this}}),mi=qi;be();Oe();var Zi=gi.default.View.extend({PAGE_COUNTER_TIMEOUT:2800,PAGE_COUNTER_TIMEOUT_INITIAL:4e3,brandingInToolbar:!1,template:ai["template-viewer-toolbar"],events:{"click .menu-button":"toggleMenu","click .share-button":"toggleShare","click .embed-close-button":"onEmbedCloseClick"},initialize:function(e){return Ye.default.bindAll(this),Ye.default.extend(this,e),this},render:function(){if(this.setElement(this.template({mag:this.mag,isPreview:this.isPreview,hasMenu:this.hasMenu,hasShare:this.hasShare,hasPageCounter:this.hasPageCounter,pageCounterInsideMenu:this.hasMenu&&u.isMobile(),totalPages:this.mag.getPagesCount(),common:RM.common,viewport:this.mag.viewport,controlsOnTop:this.controlsOnTop,brandingInToolbar:this.brandingInToolbar,icons:{sprite:q(`./common/toolbar/sprite${ne?"@2x":""}.png`)}})),this.$el.appendTo(this.$container),this.$menuButton=this.$el.find(".menu-button"),this.$shareButton=this.$el.find(".share-button"),this.$pageCounter=this.$el.find(".page-counter"),this.$pageCounterWrapper=this.$pageCounter.parent(),this.hasShare&&(this.share=new ci({mag:this.mag,router:this.router,$container:u.isMobile()?this.$container:this.$shareButton}).render(),this.hasMenu||this.$shareButton.addClass("without-menu-button")),this.hasMenu&&!this.isPreview&&this.renderMagMenu(),this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"menuShown",this.onMenuShow),this.listenTo(this.mag,"menuHidden",this.onMenuHide),this.listenTo(this.mag,"presentationModeOn",this.onPresentationModeOn),this.listenTo(this.mag,"presentationModeOff",this.onPresentationModeOff),!this.isPreview){let e=this.$(".offscreen-initially:visible"),t=150,i=e.length*t+800;e.each(function(o,r){setTimeout(function(){(0,lt.default)(r).removeClass("offscreen-initially")},i),i-=t})}return this.$("div[data-alt]:not(.rmalttext), a[data-alt]:not(.rmalttext)").RMAltText(),this.defaultHidden&&requestAnimationFrame(()=>{this.toggleToolbarVisibility(!1)}),this},renderMagMenu(){this.magMenu&&this.magMenu.destroy(),this.magMenu=new mi({mag:this.mag,pages:this.pages,router:this.router,isPreview:this.isPreview,hasProjectInfo:this.hasProjectInfo,publishDate:this.publishDate,$container:this.$container,$toolbar:this.$el,viewerType:this.viewerType}).render()},destroy:function(){return this.share&&this.share.destroy(),this.magMenu&&this.magMenu.destroy(),this.remove()},isMenuOpened:function(){return!!this.menuShown},closeMenu:function(){this.magMenu&&this.magMenu.hide()},onPageChange:function(e,t){this.showPageCounter(e,t),this.$menuButton.removeClass("waiting-video-bg-start preloading"),this.prevPage&&this.stopListening(this.prevPage),e&&(e.loaded||(this.$menuButton.addClass("preloading"),this.listenTo(e,"pageLoaded",this.onPageLoaded)),e.hasVideoBG&&!e.videoBGStarted&&(this.$menuButton.addClass("waiting-video-bg-start"),this.listenTo(e,"videoBGStarted",this.onVideoBGStarted)),this.prevPage=e)},onPageLoaded:function(){this.$menuButton.removeClass("preloading")},onVideoBGStarted:function(){this.$menuButton.removeClass("waiting-video-bg-start")},onPresentationModeOn:function(){this.isPresentationMode=!0,this.updateVisibilityState()},onPresentationModeOff:function(){this.isPresentationMode=!1,this.updateVisibilityState()},updateVisibilityState:function(){this.isPresentationMode?this.$el.stop().fadeOut(200):this.$el.stop().fadeIn(200)},onMenuShow:function(){this.menuShown=!0,this.hidePageCounter()},onMenuHide:function(){this.menuShown=!1},getPageCounterSize:function(e){if(!this.cachedPageCounterData){this.$pageCounter.find(".cur").text("0");let i=this.$pageCounter.outerWidth();this.$pageCounter.find(".cur").text("00");let r=this.$pageCounter.outerWidth()-i,n=i-r;this.cachedPageCounterData={baseSize:n,digitSize:r},this.$pageCounter.find(".cur").text(e)}let t=this.cachedPageCounterData;return t.baseSize+(e+"").length*t.digitSize},updatePageCounterSize:function(e){!this.$pageCounter.length||!this.$pageCounterWrapper.length||(!this.menuShown&&this.pageCounterShown?this.$pageCounterWrapper.css("width",this.getPageCounterSize(e)):this.$pageCounterWrapper.css("width",""))},showPageCounter:function(e,t){this.hasPageCounter&&(this.$pageCounter.find(".cur").text(e.num),t.showPageCounter&&(clearTimeout(this.pageCounterTimeout),this.$el.addClass("show-page-counter"),this.pageCounterShown=!0,Modernizr.android?setTimeout(Ye.default.bind(function(){this.updatePageCounterSize(e.num)},this),17):this.updatePageCounterSize(e.num),this.isPreview||(this.pageCounterTimeout=setTimeout(this.hidePageCounter,t.initial?this.PAGE_COUNTER_TIMEOUT_INITIAL:this.PAGE_COUNTER_TIMEOUT))))},hidePageCounter:function(){this.hasPageCounter&&(clearTimeout(this.pageCounterTimeout),this.$el.removeClass("show-page-counter"),this.pageCounterShown=!1,this.updatePageCounterSize())},toggleMenu:function(){this.magMenu&&this.magMenu.toggle()},toggleShare:function(e){(0,lt.default)(e.target).is(this.$shareButton)&&this.share&&this.share.toggle()},postMessageToParent:function(e,t){let i={type:e,data:t},o=window.parent;o&&o.postMessage(JSON.stringify(i),"*")},onEmbedCloseClick:function(){this.postMessageToParent("close-fullscreen")},rerender:function(){this.destroy(),this.render()},changeMenuVisible(e=!0){this.hasMenu=e,this.$el.find(".menu-button").toggle(e)},changeProjectInfoVisible(e=!0){this.hasProjectInfo!==e&&(this.hasProjectInfo=e,this.magMenu?.showProjectInfo(e))},changeShareButtonVisible(e=!0){this.hasShare=e,this.$el.find(".share-button").toggle(e)},changePageCounterVisible(e=!0){this.hasPageCounter=e,this.$el.find(".page-counter-wrapper").toggle(e)},changeBrandingVisible(e=!0){this.$el.find(".toolbar-branding").toggle(e)},toggleToolbarVisibility(e=!0){e?this.$el.addClass("show").removeClass("hide"):this.$el.removeClass("show").addClass("hide")}}),ui=Zi;Oe();var bi=$(Hi());Fe();Re();var Ki=e=>e.type==="touchmove";function wi(){let e="ontouchstart"in document.documentElement?"touchmove":"mousemove",t={isStarted:!1,isDestroyed:!1,isTouchEvent:!1,cursorPosition:{x:0,y:0},cursorPagePosition:{x:0,y:0}},i=new Set;function o(r){t.isTouchEvent=Ki(r),t.cursorPosition={x:t.isTouchEvent?r.touches[0].clientX:r.clientX,y:t.isTouchEvent?r.touches[0].clientY:r.clientY},t.cursorPagePosition={x:t.isTouchEvent?r.touches[0].pageX:r.pageX,y:t.isTouchEvent?r.touches[0].pageY:r.pageY};for(let n of i)n.eventHandler({state:t,originalEvent:r})}return{start(){if(!(t.isStarted||t.isDestroyed||!i.size))return t.isStarted=!0,window.addEventListener(e,o,{passive:e==="mousemove"}),this},stop(){return window.removeEventListener(e,o),t.cursorPosition={x:0,y:0},t.cursorPagePosition={x:0,y:0},t.isStarted=!1,this},destroy(){this.stop(),t.isDestroyed=!0},on(r){i.add(r),t.isStarted||this.start()},off(r){i.delete(r),t.isStarted&&!i.size&&this.stop()}}}Fe();zi();kt();wt();Wi();vt();Mt();var Ji=ct.default.View.extend({TYPEKIT_PREVIEW_API_LINK:"//use.typekit.net/previewkits/pk-v1.js",PRELOAD_COUNT_HORIZONTAL:{backward:1,forward:u.isDesktop()?5:u.isMobile()?3:2},PRELOAD_COUNT_VERTICAL:{backward:u.isDesktop()?2e3:(u.isMobile(),1e3),forward:u.isDesktop()?3e3:(u.isMobile(),2e3)},SCROLLABLE_TRESHOLD:100,SCROLL_SNAP:0,template:ri["template-viewer-mag"],staticGlobalWidgetsData:[],aboveGlobalWidgetsData:[],hasTextWidgetsV3:void 0,hasWidgetsWithVerticalOnscrollAnimation:void 0,whenWidgetsCreated:{},opts:{},viewportCounter:1,hoverCursorStyle:void 0,initialize:function(e,t){g.default.bindAll(this),e||(e={}),g.default.defaults(e,{pages:[]});let i=!1;if(e.hasSummary)this.staticGlobalWidgetsData=e.globalWidgets||[],this.aboveGlobalWidgetsData=e.aboveAllWidgets||[];else{let s=(0,g.default)(e.pages).chain().reduce(function(a,p){return[...a,...p.wids||[]]},[]).each(a=>{O.normalizeAnimations(a.animation).find(c=>c.type==="scroll"&&c.steps&&c.steps.find(w=>w.dy))&&(i=!0)}).filter({is_global:!0}).value();this.staticGlobalWidgetsData=s.filter(a=>!a.is_above),this.aboveGlobalWidgetsData=s.filter(a=>a.is_above)}let o=this.aboveGlobalWidgetsData.map(s=>s._id),r=this.staticGlobalWidgetsData.map(s=>s._id);e.pages.forEach(s=>void(s.pagePath=s.pagePath||s.uri||s.num.toString())),e.pages.forEach(s=>void(s.uri=s.pagePath)),e.pages.forEach(s=>{if(s.wids.length&&typeof s.wids[0]=="string")s.wids=s.wids.filter(a=>!o.includes(a)&&!r.includes(a)).concat(r),s.widgetsData=[...this.staticGlobalWidgetsData];else{let a=this.staticGlobalWidgetsData.filter(c=>c.pid!==s._id),p=s.wids.concat(a);s.wids=g.default.unique(p,c=>c._id||Math.random()).filter(c=>!o.includes(c._id))}}),g.default.extend(this,e),this.hasWidgetsWithVerticalOnscrollAnimation=i||e.hasWidgetsWithVerticalOnscrollAnimation,this.hasTextWidgetsV3=e.hasTextWidgetsV3,this.model=new Vt(e,{parse:!0}),this.router=t;let n=s=>{s.products&&this.eCommerceCartManager&&this.eCommerceCartManager.setProducts(s.products)};return this.eCommerceManager=new Ee({numId:this.model.attributes.num_id,ecommerceData:this.model.attributes.ecommerce_data,isPublished:this.router.environment===U.environment.viewer,isDownloadedSource:window.RM.common.isDownloadedSource,onDataChange:n}),this.eCommerceManager.setCartWidgetExistState(Wt(this.router.environment,[...this.staticGlobalWidgetsData,...this.aboveGlobalWidgetsData])),this.eCommerceCartManager=new Xt({router:this.router,mag:this,environment:this.router.environment,products:[]}),this.setupEcommerceSidebar(),this.isPreview=t.isPreview,this.$container=t.$mags_container||(0,m.default)("#root"),u.isDesktop()&&(0,m.default)("<div>").bind("mousewheel",function(){}),this.setViewerOptions(this.getMagViewport()),this.continueLoading.__debounced=g.default.debounce(this.continueLoading,200),this.loadPages.__debounced=g.default.debounce(this.loadPages,700),this.refreshPagesAfterScroll.__debounced=g.default.debounce(this.refreshPagesAfterScroll,10),this.onResize.__debounced=g.default.debounce(this.onResize,300),this.redrawAboveGlobalWidgets.__debounced=g.default.debounce(this.redrawAboveGlobalWidgets,500,!0),this.widgetPackCount=0,this.getAboveGlobalBoxMemoized=g.default.memoize(this.getAboveGlobalBox,function(s,a,p){return s+" "+(a&&a.num)+" "+(a&&a.pageViewport)+" "+(p&&p.width)+" "+(p&&p.height)}),this},detectStickyVerticalViewer(e={}){return e.viewertype==="vertical"&&u.isDesktop()?!e.slidein&&!this.isPreview&&!this.hasWidgetsWithVerticalOnscrollAnimation:e.viewertype==="vertical"?Modernizr.csspositionsticky:!1},getProjectOptions(e={},t="default",i=!0){let o=g.default.extend(i?{arrows:!1,menubutton:!1,projectinfo:!1,sharebutton:!1,pagecounter:!1,controlsontop:!1,viewertype:"vertical",slidein:!1,scalewidth:3600,lqip:!1}:{},e);return o.viewertype=RM.screenshot?"horizontal":o.viewertype,(!u.isDesktop()||this.isPreview&&t!=="default")&&(o.slidein=!1),o.viewertype==="vertical"&&!u.isDesktop()&&!this.detectStickyVerticalViewer(o)&&(o.viewertype="horizontal",this.pages?.length>1&&(o.arrows=!0)),o.sharebutton=o.sharebutton&&!this.isPreview&&!!this.published&&!this.is_private,o.pagecounter=o.pagecounter&&!this.isPreview&&this.pages?.length>1,o.branding=(g.default.isUndefined(o.branding)?o.endpage:o.branding)&&!this.isPreview,o.menubutton=o.menubutton&&!this.isPreview,["phone_portrait","tablet_portrait"].includes(this.viewport)&&(o.projectinfo=!1),o},getViewportOptions(e="default"){let t=`viewport_${e}`;return{...this.model.get("opts"),...e!=="default"?this.model.get(t)?.opts||{}:{}}},setViewerOptions(e){if(this.viewport=e,typeof window<"u"&&typeof window.Proxy<"u"){let t=this;this.viewOpts=new Proxy({},{get(i,o){let r=t.getProjectOptions(t.model.get("opts"),t.viewport,!0);if(t.viewport!=="default"){let n=`viewport_${t.viewport}`,s=t.getProjectOptions(t.model.get(n)?.opts,t.viewport,!1)[o];return s!==void 0?s:r[o]}else return r[o]}})}else{let t=`viewport_${this.viewport}`;this.viewOpts={...this.getProjectOptions(this.model.get("opts"),this.viewport,!0),...this.viewport!=="default"?this.getProjectOptions(this.model.get(t)?.opts,this.viewport,!1):{}}}this.isStickyVerticalViewer=this.detectStickyVerticalViewer(this.viewOpts),this.PRELOAD_COUNT=this.viewOpts.viewertype=="horizontal"?this.PRELOAD_COUNT_HORIZONTAL:this.PRELOAD_COUNT_VERTICAL},setViewerClasses:function(){this.$el.removeClass("viewer-type-horizontal viewer-type-vertical").addClass("viewer-type-"+this.viewOpts.viewertype).removeClass("pages-pos-normal pages-pos-overlap").addClass("pages-pos-"+(this.viewOpts.slidein?"overlap":"normal")),this.viewOpts.viewertype=="vertical"&&((0,m.default)("html").addClass("overflow-on-vertical-view"),this.isStickyVerticalViewer&&(this.$el.addClass("viewer-type-vertical-sticky"),(0,m.default)("body").addClass("overflow-on-vertical-view"))),this.toggleControlsOnTop(this.viewOpts.controlsontop),(0,m.default)("html").addClass("new-settings").addClass("mobile-screenshots"),this.viewOpts.useCustomCursor&&this.initProjectCursors()},getCursorCssStylesString({cursorUrl:e,cursorSize:t,isLambda:i,isHover:o}){if(!e)return"";let r=`cursor: ${this.getCursorCssString({cursorUrl:e,isHover:o})}`;if(i&&t){let n=this.getCursorCssImageSetString({cursorUrl:e,cursorSize:t,isHover:o});n&&(r+=`
 cursor: ${n}`)}return r},getCursorCssString({cursorUrl:e,isHover:t}){return e?`url(${e}), ${t?"pointer":"auto"};`:""},getCursorCssImageSetString({cursorUrl:e,cursorSize:t,isHover:i}){if(!e)return"";let o=Math.max(t.width,t.height);return`
    -webkit-image-set(
      url(${e}?w=${Math.round(o/2)}) 1x,
      url(${e}) 2x
    ), ${i?"pointer":"auto"};`},initProjectCursors(){if(this.viewOpts.useCustomCursor){if(this.viewOpts.customCursorImage){if(!!document.getElementById("default-custom-cursor-style"))return;let t=this.getCursorCssStylesString({cursorUrl:this.viewOpts.customCursorImage,cursorSize:this.viewOpts.customCursorSize,isLambda:this.viewOpts.customCursorIsLambda}),i=document.createElement("style");i.id="default-custom-cursor-style",i.appendChild(document.createTextNode(`html, body {${t}}`)),document.querySelector("head").appendChild(i)}if(this.viewOpts.customHoverCursorImage){if(!!document.getElementById("hover-custom-cursor-style"))return;let t=this.getCursorCssStylesString({cursorUrl:this.viewOpts.customHoverCursorImage,cursorSize:this.viewOpts.customHoverCursorSize,isLambda:this.viewOpts.customHoverCursorIsLambda,isHover:!0});this.hoverCursorStyle={cursor:this.viewOpts.customHoverCursorSize&&this.viewOpts.customHoverCursorIsLambda?this.getCursorCssImageSetString({cursorUrl:this.viewOpts.customHoverCursorImage,cursorSize:this.viewOpts.customHoverCursorSize,isHover:!0}):this.getCursorCssString({cursorUrl:this.viewOpts.customHoverCursorImage,isHover:!0})};let i=`        a.external-link, a.maglink, a.anchor-link, .goback-link, .mailchimp-link, .share-link {
          ${t}
        }
        .common-hotspot .pin {
          ${t}
        }
        .common-form .button {
          ${t}
        }
        .common-slideshow .images .prev-picture-arrow-middle, .common-slideshow .images .next-picture-arrow-middle, .common-slideshow .thumbnails .thumb:not(.active) {
          ${t}
        }
        .rmwidget.e-com-cart-button {
          ${t}
        }
        .widget-add-to-cart .add-to-cart-wrap .add-to-cart-button.viewer-button {
          ${t}
        }
        #cart-sidebar .sidebar-btn, #cart-sidebar .sidebar-icon-btn {
          ${t}
        }
      `,o=document.createElement("style");o.id="hover-custom-cursor-style",o.appendChild(document.createTextNode(i)),document.querySelector("head").appendChild(o)}}},toggleControlsOnTop(e=!0){(0,m.default)("html").toggleClass("controls-on-top",e)},unsetViewerClasses:function(){if(this.$el.removeClass("viewer-type-horizontal viewer-type-vertical").removeClass("pages-pos-normal pages-pos-overlap viewer-type-vertical-sticky"),(0,m.default)("html").removeClass("overflow-on-vertical-view controls-on-top"),this.$magScrollSizer?.css("height",""),(0,m.default)("body").removeClass("overflow-on-vertical-view"),this.viewOpts.useCustomCursor){if(this.viewOpts.customCursorImage&&document.body.style.cursor&&(document.body.style.cursor="auto"),this.viewOpts.customCursorImage){let e=document.getElementById("default-custom-cursor-style");e&&e.remove()}if(this.viewOpts.customHoverCursorImage){let e=document.getElementById("hover-custom-cursor-style");e&&e.remove()}}},showSafari26GlassToolbarFix(e){if($e("viewer.paintGlassToolbar")){if(!Modernizr.mobilesafari26)return;let t=this.$(".glass-painter");e?!t.length&&this.$el.append((0,m.default)("<div class='glass-painter'><div class='backdrop-overlay'></div></div>")):t.remove()}},render:function(){if(this.active)return;this.title=this.title||"Project",this.magOpenTime=new Date,document.documentElement.style.setProperty("--min-desktop-width",`${V.dictionary.default.min_scale_width}px`),this.setElement(this.template({hasStandaloneBottomArrow:!this.isPreview&&this.viewOpts.viewertype=="vertical"&&this.viewOpts.arrows,isPreview:!!this.isPreview,icons:{sprite:q(`./common/navigation/sprite${ne?"@2x":""}.png`)}})),this.$el.appendTo(this.$container),this.setViewerClasses(),B.on("ecwid:checkout:opened",this.onEcwidOpened.bind(this)),B.on("ecwid:checkout:closed",this.onEcwidClosed.bind(this)),(0,m.default)("body").on("click","a.external-link",this.toExternalLink).on("click",".maglink.back-to-top",this.backToTopCurrentPage).on("click",".maglink",this.maglink).on("click",".goback-link",this.onGobackLinkClick).on("click",".mailchimp-link",this.onMailchimpLinkClick).on("click",".anchor-link",this.onAnchorLinkClick).on("click",".share-link",this.onShareLinkClick),this.$mag_container=this.$(".mag-pages-container"),this.$mag_container.on("scroll",this.fixFocusScroll),this.$mag_viewport_device=this.$(".mag-pages-viewport-device"),this.$pages_container=this.$(".mag-pages-container .container"),this.$pages_blackout=this.$pages_container.find(".blackout"),this.$aboveWidgetsContainer=this.$(".above-pages-container"),this.viewOpts.viewertype=="vertical"&&(this.$magScrollContainer=(0,m.default)(window),this.$magScrollSizer=(0,m.default)("body"),this.isStickyVerticalViewer&&(this.$magScrollSizer=(0,m.default)("body").add(this.$el)),this.$magScrollHandler=(0,m.default)(window),this.$magScrollAnimate=(0,m.default)("body, html")),this.active=!0,this.globalEvents=new wi({mag:this});let e=this.pages;this.pages=null,this.viewport=null,this.switchToViewport(this.getMagViewport()),u.isDesktop()||setTimeout(this.onResize,1500),this.pages=(0,g.default)(e).chain().sortBy(function(s){return s.num}).map(g.default.bind(function(s){let a="";try{a=new Ie({mag:this,router:this.router,totalPages:e.length,pageData:s,viewerType:this.viewOpts.viewertype,isStickyVerticalViewer:this.isStickyVerticalViewer,$container:this.$pages_container,viewOpts:this.viewOpts}).render()}catch(p){console.log("Error page rendering.",p)}return a},this)).filter(function(s){return!!s}).value();let t=this.getPage(this.getPagesCount());t&&t.markAsLast(),this.viewOpts.viewertype==="horizontal"&&this.setPagesTransitions(),RM.screenshot||this.renderControls(),this.onResize(),this.viewOpts.viewertype==="vertical"&&(u.isDesktop()&&this.getPage(1)&&this.getPage(1).$content.focus(),(0,m.default)("body").on("keydown",this.onVerticalViewKeyDown)),u.isDesktop()?((0,m.default)(window).on("mousedown",this.onMouseDown),(0,m.default)(window).on("mouseup",this.onMouseUp),(0,m.default)(window).on("mousewheel",this.onMouseWheel)):((0,m.default)(window).on("touchstart",this.onDragStart),(0,m.default)(window).on("touchmove",this.onDragMove),(0,m.default)(window).on("touchend touchcancel",this.onDragEnd),(0,m.default)(window).on("pageshow",this.onResize)),_.PageVisibilityManager.addEventListener(this.onPageVisibilityChange),(0,m.default)(window).on("resize",this.onResize),this.isPreview&&(this.listenTo(this.model,"change:opts",(s,a)=>{this.onOptionsChange(s.previous("opts"),a)}),this.listenTo(this.model,"change:viewport_phone_portrait",(s,a)=>{let p=this.model.get("opts"),c=s.previous("viewport_phone_portrait")?.opts??{};this.onOptionsChange({...p,...c},a?.opts,"phone_portrait")}),this.listenTo(this.model,"change:viewport_tablet_portrait",(s,a)=>{let p=this.model.get("opts"),c=s.previous("viewport_tablet_portrait")?.opts??{};this.onOptionsChange({...p,...c},a?.opts,"tablet_portrait")}),this.on("change:viewport",({viewport:s,oldViewport:a})=>{this.onOptionsChange(this.getViewportOptions(a),this.getViewportOptions(s),s)})),u.isDesktop()||(0,m.default)(window).on("orientationchange",this.onOrientationChange),(0,m.default)(window).on("gesturestart gestureend",this.onGestureChange),this.viewOpts.viewertype=="vertical"&&this.$magScrollHandler?.on("scroll",this.onMagScroll),(0,m.default)("body").on("keyup",this.onKeyup),K.generateCSS("paragraph","viewer",document,this.edit_params&&this.edit_params.paragraph_styles),K.generateCSS("link","viewer",document,this.edit_params&&this.edit_params.link_styles),!(RM.screenshot&&Ce("pdf")=="true")&&!this.isPreview&&K.setShortList(K.getVeryShortList(this.edit_params&&this.edit_params.fonts));let o=!this.isPreview&&this.model.get("is_published")?"published":"edit",r=this;o=="edit"&&!window.TypekitPreview?m.default.getScript(this.TYPEKIT_PREVIEW_API_LINK,function(){n()}):n();function n(){K.appendFontsCssToDocument({version:o,fonts:r.edit_params&&r.edit_params.fonts,typekit_url:r.typekit_url})}return this.globalEvents?.start(),this},destroy:function(){return g.default.each(this.pages,function(e){e.destroy()}),this.pages=null,this.globalEvents?.destroy(),B.off("ecwid:checkout:opened",this.onEcwidOpened.bind(this)),B.off("ecwid:checkout:closed",this.onEcwidClosed.bind(this)),(0,m.default)("body").off("click","a.external-link",this.toExternalLink).off("click",".maglink.back-to-top",this.backToTopCurrentPage).off("click",".maglink",this.maglink).off("click",".goback-link",this.onGobackLinkClick).off("click",".mailchimp-link",this.onMailchimpLinkClick).off("click",".anchor-link",this.onAnchorLinkClick).off("keydown",this.onVerticalViewKeyDown).off("click",".share-link",this.onShareLinkClick),this.destroyControls(),this.cartSidebar&&setTimeout(()=>{this.cartSidebar.destroy()},320),u.isDesktop()?((0,m.default)(window).off("mousedown",this.onMouseDown),(0,m.default)(window).off("mouseup",this.onMouseUp),(0,m.default)(window).off("mousewheel",this.onMouseWheel)):((0,m.default)(window).off("touchstart",this.onDragStart),(0,m.default)(window).off("touchmove",this.onDragMove),(0,m.default)(window).off("touchend touchcancel",this.onDragEnd),(0,m.default)(window).off("pageshow")),this.unsetViewerClasses(),_.PageVisibilityManager.removeEventListener(this.onPageVisibilityChange),(0,m.default)(window).off("resize",this.onResize),(0,m.default)(window).off("orientationchange",this.onOrientationChange),(0,m.default)(window).off("gesturestart gestureend",this.onGestureChange),this.$magScrollHandler?.off("scroll",this.onMagScroll),(0,m.default)("body").off("keyup",this.onKeyup),this.active=!1,this.trigger("destroyed"),this.remove()},renderControls(){this.viewOpts.viewertype==="horizontal"&&this.viewOpts.arrows&&(this.navigation=new pt({mag:this,router:this.router,$container:this.$el,isPreview:this.isPreview,viewerType:this.viewOpts.viewertype}).render());let e=(window.location.href.indexOf(`${U.readymag_host}/designs/`)>-1||this.isPublishedAsTemplate)&&!this.isPreview,t=(this.must_show_branding||this.viewOpts.branding)&&!(RM.common.embedMode&&!u.isDesktop()),i=(t||e)&&u.isDesktop()&&!this.viewOpts.controlsontop||this.isPreview;this.toolbar=new ui({mag:this,pages:this.pages,router:this.router,$container:this.$el,isPreview:this.isPreview,hasMenu:this.viewOpts.menubutton,hasProjectInfo:this.viewOpts.projectinfo,hasShare:this.viewOpts.sharebutton&&!U.IS_FILE_PROTOCOL,hasPageCounter:this.viewOpts.pagecounter,controlsOnTop:this.viewOpts.controlsontop,brandingInToolbar:i,viewerType:this.viewOpts.viewertype,publishDate:this.published?xt(new Date(this.published),"MMM dd, yyyy"):"unpublished",defaultHidden:this.defaultHideToolbar}).render(),(t||e)&&(this.model.set("startWithTemplate",e),this.model.set("isPublishedAsTemplate",this.isPublishedAsTemplate),this.model.set("templateSet",this.templateSet),this.model.set("isMobile",u.isMobile()),He({component:Jt,domElement:i?this.toolbar.$el.find(".toolbar-branding")[0]:this.$el.find(".fancy-button")[0],model:this.model})),this.viewOpts.viewertype==="vertical"&&(this.$bottomArrow=this.$(".navigation-arrow.bottom"),this.$bottomArrow.on("click",this.scrollMagALittle))},destroyControls(){this.toolbar?.destroy(),this.branding?.destroy(),this.navigation?.destroy(),this.$bottomArrow?.off("click",this.scrollMagALittle)},onEcwidOpened:function(){this.isEcwidOpened=!0},onEcwidClosed:function(){this.isEcwidOpened=!1},rerenderPage(e,t){let i=this.pages.findIndex(n=>n._id===e._id);if(i===-1)return;let o=i+1<this.pages.length?this.pages[i+1].$el:void 0;this.pages[i].destroy();let r=new Ie({mag:this,router:this.router,totalPages:this.pages.length,pageData:{...e,wids:[...e.wids.filter(n=>!n.is_global),...t.globalWidgets||[]]},viewerType:this.viewOpts.viewertype,isStickyVerticalViewer:this.isStickyVerticalViewer,$container:this.$pages_container,viewOpts:this.viewOpts});o&&o.length&&r.$el.remove().insertBefore(o),r.render(),this.pages[i]=r,e._id===this.currentPage?._id&&(this.currentPage=void 0),this.onResize()},getUrl:function(){return RM.common.isDomainViewer?window.location.protocol+"//"+window.location.hostname+"/"+(RM.common.customDomainProfile?this.num_id+"/":""):window.location.protocol+"//"+window.location.hostname+"/"+this.num_id+"/"},getPage:function(e){return parseInt(e,10)==e&&(e=parseInt(e,10)),g.default.isNumber(e)?this.pages[e-1]:(0,g.default)(this.pages).find(function(t){return t.uri==e})},getPageByPath:function(e){return e.toString()==="1"?this.pages[0]:this.pages.find(t=>t.pagePath===e)},getPagesCount:function(){return this.pages&&this.pages.length},isFirstPage:function(){return this.currentPage&&!this.getPage(this.currentPage.num-1)},isLastPage:function(){return this.currentPage&&!this.getPage(this.currentPage.num+1)},getPageId:function(e){let t=g.default.find(this.pages,function(i){return i.num_id===e});return t&&t._id},getPageNum:function(e){let t=g.default.find(this.pages,function(i){return i._id==e});return t&&t.num},getPageUri:function(e){let t=g.default.find(this.pages,function(o){return o._id==e});if(!t)return null;let i=t.uri?t.uri+"/":t.num==1?"":t.num+"/";return this.router.getMagUri(this)+i},getPageById:function(e){return g.default.find(this.pages,function(t){return t._id==e})},getPageTransitionTime:function(){let e=400,t=Math.min(this.viewOpts.scalewidth,this.getContainerSizeCached().width),i=this.getContainerSizeCached().height;return u.isDesktop()?e=550:u.isTablet()?t>i?e=550:e=470:t>i?e=520:e=370,e},onPageVisibilityChange:function(){if(this.currentPage)if(clearTimeout(this.visibilityHandlerTimeout),_.PageVisibilityManager.isPageHidden())this.visibilityHandlerTimeout=setTimeout(()=>{this.currentPage.stop({widgetTypes:["video","background","iframe"]});let e=this.getPage(this.currentPage.num+1);e&&e.started&&(e.stop({widgetTypes:["video","background","iframe"]}),this.restartNextPage=!0)},700);else{this.currentPage.start({widgetTypes:["audio","video","background","iframe"],forceStart:!0});let e=this.getPage(this.currentPage.num+1);e&&this.restartNextPage&&(e.start({widgetTypes:["audio","video","background","iframe"],forceStart:!0}),delete this.restartNextPage)}},updateArrowsColor:function(e){if(!e)return;let t=e.arrows_color||"white";this.$el.removeClass("navigation-white-arrows").removeClass("navigation-black-arrows").addClass("navigation-"+t+"-arrows")},onDragStart:function(e){clearTimeout(this.touchInProgressTimeout),this.pauseLoading("touch");let t=e.originalEvent.targetTouches[0];this.globalTouchObject={$target:(0,m.default)(e.target).closest(".has-horizontal-scroll, .has-vertical-scroll"),x:t.screenX,y:t.screenY,startTime:+new Date}},onDragMove:function(e){if(this.isWidgetDragging||this.isEcwidOpened)return;let t=this.globalTouchObject;if(e.originalEvent.touches.length>1||!t)return;if(this.viewOpts.viewertype=="horizontal"?this.currentPage&&this.currentPage.hasFixedWidgets&&(0,m.default)(e.target).closest(this.$mag_container).length&&!t.$target.length&&(t.$target=this.currentPage.$scrollWrapper):t.$target.length||(t.$target=this.$magScrollContainer),!t.$target.length){e.preventDefault();return}if(_.isPageNativelyScaled())return;let i=e.originalEvent.targetTouches[0],o=i.screenY-t.y;if(Math.abs(o)>5&&t.$target.hasClass("has-vertical-scroll")){let n=t.$target[0].scrollHeight,s=t.$target.outerHeight();o>0&&t.$target.scrollTop()<=0&&e.preventDefault(),o<0&&t.$target.scrollTop()>=n-s&&e.preventDefault()}t.$target.hasClass("has-horizontal-scroll")},onDragEnd:function(e){this.checkDoubleTap(e),this.touchInProgressTimeout=setTimeout(g.default.bind(function(){this.continueLoading("touch")},this),400);let t=this.globalTouchObject;if(t){let i=e.originalEvent.changedTouches[0],o=i.screenX-t.x,r=i.screenY-t.y;this.toolbar&&this.toolbar.isMenuOpened()&&Math.abs(o)<3&&Math.abs(r)<3&&+new Date-t.startTime<500&&!_.isPageNativelyScaled()&&(0,m.default)(e.target).closest(this.$mag_container).length&&this.closeMagMenu()}delete this.globalTouchObject},checkDoubleTap:function(e){if(e.originalEvent.touches.length>0)return;let t=+new Date,i=t-(this.lastTouchEndTime||t+1);if(this.lastTouchEndTime=t,i<500&&i>0&&_.isPageNativelyScaled()){let o=(0,m.default)('meta[name="viewport"]');if(o.length){let r=o.attr("content"),n=r.replace(/maximum\-scale\=[0-9\.]*/,"maximum-scale=1.0");if(o.attr("content",n),Modernizr.android){let s=(0,m.default)("<div>").appendTo("body");g.default.delay(function(){s.remove()},500),setTimeout(g.default.bind(function(){o.attr("content",r);let a=(0,m.default)("<div>").appendTo("body");g.default.delay(function(){a.remove()},500)},this),1e3)}else o.attr("content",r);this.lastTouchEndTime=0,g.default.delay(function(){(0,m.default)(window).trigger("gesturechange")},300),g.default.delay(function(){(0,m.default)(window).trigger("gesturechange")},1e3)}}},onMouseDown:function(e){this.globalMouseObject={x:e.screenX,y:e.screenY,startTime:+new Date}},onMouseUp:function(e){let t=this.globalMouseObject;if(t){let i=e.screenX-t.x,o=e.screenY-t.y;this.toolbar&&this.toolbar.isMenuOpened()&&Math.abs(i)<3&&Math.abs(o)<3&&+new Date-t.startTime<500&&(0,m.default)(e.target).closest(this.$mag_container).length&&this.closeMagMenu()}delete this.globalMouseObject},onMouseWheel:function(e){e.originalEvent.deltaX<0&&Math.abs(e.originalEvent.deltaY)<2&&e.cancelable&&e.preventDefault()},onKeyup:function(e){if(e.target.tagName.toLowerCase()=="input"||e.target.tagName.toLowerCase()==="textarea"&&!e.target.classList.contains("copyhack")||!g.default.isEmpty(RM.common.disableShortcuts)||this.isInPresentationMode)return;let t=this.currentPage.viewport_tablet_portrait?.enabled,i=this.currentPage.viewport_phone_portrait?.enabled,o,r=t&&i?3:!t||!i?2:1,n;if((e.keyCode>=49&&e.keyCode<=51||String.fromCharCode(e.keyCode)==="D")&&(this.viewportCounter=ie.incrementCircular(this.viewportCounter,r)),String.fromCharCode(e.keyCode)==="D"?o=String(this.viewportCounter):o=String.fromCharCode(e.keyCode),o==="1"?n="default":o==="2"&&t?n="tablet_portrait":o==="3"&&i||o==="2"&&!t?n="phone_portrait":n=void 0,n&&this.isPreview){let a=this.viewOpts.viewertype,p=n==="default"?this.model.get("opts").viewertype:this.model.get(`viewport_${n}`)?.opts?.viewertype;p&&a!==p?RM.constructorRouter?.preview.restartMag({viewport:n}):this.switchToViewport(n)}g.default.find(m.default.keycodes,function(a,p){return m.default.keycodes[p]===e.keyCode})&&this.trigger("keypress-"+e.keyCode,e)},onKeydown:function(e){if(!(e.target.tagName.toLowerCase()=="input"||e.target.tagName.toLowerCase()==="textarea"&&!e.target.classList.contains("copyhack"))&&g.default.isEmpty(RM.common.disableShortcuts)&&this.isInPresentationMode&&!(e.altKey||e.ctrlKey||e.metaKey))switch(e.which){case 8:case 33:case 80:case 37:case 72:case 38:case 75:e.preventDefault(),this.goPrevPage({animation:!0});break;case 13:case 34:case 78:case 39:case 76:case 40:case 74:e.preventDefault(),this.goNextPage({animation:!0});break;case 36:e.preventDefault(),this.goFirstPage();break;case 35:e.preventDefault(),this.goLastPage();break;case 9:case 32:e.preventDefault(),e.shiftKey?this.goPrevPage({animation:!0}):this.goNextPage({animation:!0});break;case 77:e.preventDefault(),this.trigger("keypress-"+e.keyCode,e);break}},onVerticalViewKeyDown:function(e){if(!(this.isInPresentationMode||this.viewOpts.viewertype!=="vertical")&&(e.which===m.default.keycodes.down||e.which===m.default.keycodes.up)){if(e.preventDefault(),this.arrowKeyLastScrollAt&&new Date-this.arrowKeyLastScrollAt<400)return;let t=e.which===m.default.keycodes.down;this.arrowKeyLastScrollAt=+new Date;let i=window.innerHeight,o=this.getScroll(),r=this.getScrollPosition(),n=Math.round(i/4),s=function(P){return P&&P<=n},a=function(P){return P>n&&P<i},p=g.default.bind(function(){let P=this.magPagesPos[this.currentPage.num];return Math.abs(o-P.y)},this),c=this.currentPage.pageHeight,w=r===0&&!this.isFirstPage(),v,M;if(t)v=c-r-i,s(v)?M=c-r:a(v)?M=v:M=i,w&&this.viewOpts.slidein&&(M+=p());else{if(w){let P=this.magPagesPos[this.currentPage.num-1];r=P?P.h:0}v=r-i,s(v)||r<i?M=-r:M=-i,w&&this.viewOpts.slidein&&(M-=this.SCROLL_SNAP-p())}this.setScrollPosition({delta:M,animate:!0})}},togglePresentationMode:function(e){!!this.isInPresentationMode!=e&&u.isDesktop()&&(this.isPreview||(e?((0,m.default)("body").on("keydown",this.onKeydown),this.trigger("presentationModeOn")):((0,m.default)("body").off("keydown",this.onKeydown),this.trigger("presentationModeOff")),this.isInPresentationMode=e))},recalcBottomArrowState:function(e){!this.currentPage||e!==this.currentPage||this.navigation&&this.navigation.recalcBottomArrowState(e)},setScrollPosition:function(e){if(!this.currentPage)return;let t;this.viewOpts.viewertype=="vertical"?(typeof e.offset<"u"?t=this.magPagesPos[this.currentPage.num].y+e.offset:t=this.getScroll()+e.delta,e.animate?this.$magScrollAnimate.animate({scrollTop:t},500):this.setScroll(t)):(typeof e.offset<"u"?t=e.offset:t=this.currentPage.$scrollWrapper.scrollTop()+e.delta,e.animate?this.currentPage.$scrollWrapper.animate({scrollTop:t},500):this.currentPage.$scrollWrapper.scrollTop(t))},getScrollPosition:function(){if(!this.currentPage)return 0;let e=0;return this.viewOpts.viewertype=="vertical"?e=Math.max(this.getScroll()-this.magPagesPos[this.currentPage.num].y,0):e=this.currentPage.$scrollWrapper.scrollTop(),e},getScroll:function(){return this.$magScrollContainer&&this.$magScrollContainer.scrollTop()},setScroll:function(e){this.$magScrollContainer&&this.$magScrollContainer.scrollTop(e)},onMagScroll:function(){if(document.fullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement||document.mozFullScreenElement||document.msFullscreenElement||this.hadPlayingVideoOnResize){this.hadPlayingVideoOnResize=!1;return}g.default.isFunction(this._resetUrlStringTimeoutFunc)&&this._resetUrlStringTimeoutFunc(),this.pauseWidgetsLoadingOnScroll();let e=this.findPageOnCurrentMagScroll({pageStartsOnBottom:!1}),t=this.getScrollParams(e);this.lastPageScroll=t.pageScroll,this.lastPageScrollPercent=t.pageScrollPercent,this.showPage(e.page.num,t),this.aboveGlobalAnimations&&this.aboveGlobalAnimations.onScroll({forceApply:!0,scroll:this.getScroll()}),this.trigger("mag_scroll",this.getScroll()),this.$bottomArrow&&+this.magOpenTime+2e3<+new Date&&this.hideBottomButton()},showBottomButton:function(){this.$bottomArrow?.removeClass("offscreen")},hideBottomButton:function(){this.$bottomArrow?.addClass("offscreen")},scrollMagALittle:function(){this.$magScrollAnimate.animate({scrollTop:this.getScroll()+this.getContainerSizeCached().height},500)},findPageOnCurrentMagScroll:function(e){e=e||{};var i=this.getScroll(),t=this.getContainerSizeCached(),i=Math.min(Math.max(i,0),this.magHeight-t.height),o=this.pages.length,r=i+(e.pageStartsOnBottom?t.height-50-16-16:0),n,s,a,p;for(n=0;n<o;n++){s=this.pages[n],a=this.magPagesPos[s.num];let c=p?p.y+p.h:a.y;if(r>=c&&r<a.y+a.h||n==o-1)return{page:s,scroll:i,pos:a};p=a}},getScrollParams:function(e){let t=Math.max(e.scroll-e.pos.y,0),i=t/e.page.pageHeight,o={initiator:"scroll",pageScroll:t,pageScrollPercent:i};if(this.viewOpts.slidein?(o.nextPageScroll=0,o.slideInNextPageScroll=e.pos.h-o.pageScroll):o.nextPageScroll=o.pageScroll-e.pos.h,o.nextPageVisible=e.pos.h-o.pageScroll<this.getContainerSizeCached().height,this.viewOpts.slidein){let r=(e.pos.h-o.pageScroll)/this.getContainerSizeCached().height;o.nextPageBlackout=Math.min(Math.max(r,0),1)}return o},onCurrentPageScroll:function(e,t){this.pauseWidgetsLoadingOnScroll(),this.aboveGlobalAnimations&&this.aboveGlobalAnimations.onScroll({forceApply:!this.isStickyVerticalViewer,scroll:t}),this.lastPageScroll=t,this.lastPageScrollPercent=this.lastPageScroll/e.pageHeight,this.loadPages.__debounced()},scrollCurrentPageALittle:function(){this.currentPage&&this.currentPage.scrollPageALittle()},focusCurrentPage:function(){this.currentPage&&this.currentPage.focusPage()},backToTopCurrentPage:function(){if(this.viewOpts.viewertype=="vertical"){let e=this.findPageOnCurrentMagScroll();this.getScroll()!==e.pos.y&&this.$magScrollAnimate.animate({scrollTop:e.pos.y},500)}else this.currentPage&&this.currentPage.backToTop();RM.analytics&&RM.analytics.sendEvent("rm_scroll_top_link_click")},backToTopCurrentPageWithoutAnimation:function(){this.viewOpts.viewertype!=="vertical"&&this.currentPage&&this.currentPage.scrollTo(0,!1)},scrollPageToPos:function(e,t){let i=this.getPage(e),o,r=this.getContainerSizeCached(),n=i.scale,s;t=t||0,t=t*n,t=t+i.contentPosition.top,this.viewOpts.viewertype=="vertical"?(o=this.magPagesPos[i.num],s=Math.max(0,o.y+t),s=Math.min(s,o.y+o.h-r.height),this.$magScrollAnimate.animate({scrollTop:s},500)):(this.currentPage!=i&&this.showPage(i.num),s=Math.max(0,t),i.scrollTo(s))},pauseWidgetsLoadingOnScroll:function(){},toExternalLink:function(e){let t=(0,m.default)(e.target).closest("a").attr("href");RM.analytics&&RM.analytics.sendEvent("click",t)},maglink:function(e){if(e.which===2||e.metaKey||e.ctrlKey||((0,m.default)(e.currentTarget).attr("target")||"").toLowerCase()==="_blank")return;let i=(0,m.default)(e.currentTarget).data("link")||(0,m.default)(e.currentTarget).attr("href");if(!i)return!1;if(e.preventDefault(),(0,m.default)(e.currentTarget).hasClass("back-to-top"))return this.backToTopCurrentPage();this.listenToOnce(this,"pageChangedReady",()=>{this.backToTopCurrentPageWithoutAnimation()}),this.router.navigate(i,{trigger:!0})},onGobackLinkClick:function(){this.router.goBack()},onMailchimpLinkClick:function(e){let t=(0,m.default)(e.currentTarget),i;if(!t.hasClass("disabled")){t.flashClass("disabled",3e3);try{i=JSON.parse(t.attr("data-mailchimp"))}catch{i=null}i&&yt.initMailchimpAPI(function(o){Pt("MCEvilPopupClosed"),o.start(i)})}},onAnchorLinkClick:function(e){let t=(0,m.default)(e.currentTarget),i=parseInt(t.attr("data-anchor-link-pos"),10)||0,o=t.attr("data-page-id"),r=t.attr("data-page-uri");if(o){let n=this.pages.find(s=>s._id===o);n&&(r=n.num)}!i||!r||(this.scrollPageToPos(r,i),RM.analytics&&RM.analytics.sendEvent("Anchor Link",(t[0].textContent||"").trim()||String(i)))},onShareLinkClick:function(e){Ne.share({host:(RM.common.embedDomainName||window.location.protocol+"//"+window.location.hostname)+"/",tp:(0,m.default)(e.currentTarget).attr("data-share-provider"),source:"mag links",page:this.currentPage||this.pages[0],mag:g.default.extend(this.model.toJSON(),{user:this.user}),forProject:(0,m.default)(e.currentTarget).attr("data-share-type")=="mag",customDomain:!!(RM.common.isDomainViewer||RM.common.embedDomainName),customDomainProfile:!!(RM.common.customDomainProfile||RM.common.embedDomainType=="User"),analytics:this.router.analytics,supportMail:U.SUPPORT_MAIL})},showPageCounter:function(e,t={showPageCounter:!0}){if(!this.toolbar)return;let i=1;this.currentPage&&(i=this.currentPage.num+(e?e=="left"?1:-1:0),i=Math.max(Math.min(i,this.getPagesCount()),1)),this.toolbar.showPageCounter(this.getPage(i),t)},hidePageCounter:function(){this.toolbar&&this.toolbar.hidePageCounter()},showPage:function(e,t){t=t||{},this.active||this.render();let i=this.getPage(e),o=this.currentPage,r=i&&this.getPage(i.num+1),n=this;i&&!this.aboveGlobalWidgetsRendered&&this.renderAboveGlobalWidgets(i),this.isStickyVerticalViewer?this.redrawAboveGlobalWidgets():t.nextPageVisible||this.viewOpts.viewertype==="horizontal"?this.redrawAboveGlobalWidgets(i,r,t.slideInNextPageScroll||t.nextPageScroll,t.animation):i?this.redrawAboveGlobalWidgets(i):o&&this.redrawAboveGlobalWidgets.__debounced(),this.viewOpts.viewertype==="vertical"&&(t.animation=!1,i&&i.scrollOnVerticalMode(t.pageScroll||0),i&&r&&t.nextPageScroll!==void 0&&(r.scrollOnVerticalMode(t.nextPageScroll),t.nextPageVisible?r.start():r.stop()),i&&t.nextPageBlackout!==void 0&&this.$pages_blackout.css({display:r?"block":"none",opacity:t.nextPageBlackout,"z-index":i.getPageZIndex()}));let s=!this.currentPage;if(!s&&e===this.currentPage.num)return!1;if(!i)return e!==1&&this.router.onError(),!1;if(o)if(this.viewOpts.viewertype==="horizontal"||this.isStickyVerticalViewer)o.stop();else{r==o&&t.nextPageVisible||o.stop();let w=o&&this.getPage(o.num+1);w&&!(w==i||w==r&&t.nextPageVisible)&&w.stop()}else t.animation=!1;this.pauseLoading("page-change-animation"),this.currentPage=i,o&&o.resetWaitForAnimationEnd(),clearInterval(this.showPageCompleteInterval),this.$pages_container.toggleClass("disable-transitions",!t.animation),t.animation&&(this.viewOpts.slidein&&o&&o.num>i.num?o.waitForAnimationEnd(c):i.waitForAnimationEnd(c)),this.direction=!o||o.num<i.num?"forward":"backward";let a=i.num-this.getPreloadPageCount(i.num-1,this.direction==="forward"?"backward":"forward"),p=i.num+this.getPreloadPageCount(i.num-1,this.direction);this.viewOpts.viewertype==="horizontal"&&!this.viewOpts.arrows&&(a=p=i.num);for(let w=0;w<this.pages.length;w++){let v=this.pages[w];v.num<i.num?v.setPosition("prev",v.num+1===i.num):v.num>i.num?v.setPosition("next",v.num-1===i.num):v.setPosition("center",v.num===i.num),v.num>=a&&v.num<=p&&(this.whenWidgetsCreated[v._id]=v.show()),this.viewOpts.viewertype=="vertical"&&(v.num<i.num||v.num>i.num+1)&&v.resetScrollOnVerticalMode()}!t.animation&&c(),this.scheduleSetUrlString({replace:!s,skipInternalHistory:t.skipInternalHistory,isTemplateSubmission:t.isTemplateSubmission}),this.router.setTitle(),this.trigger("pageChanged",i,{showPageCounter:t.animation||t.bySwipe||s||t.initiator=="scroll",initial:s}),i.trigger("changedTo"),this.viewOpts.viewertype=="vertical"&&this.updateArrowsColor(i);function c(){!t.animation&&!s&&window.requestAnimationFrame(function(){n.$pages_container.removeClass("disable-transitions")}),n.continueLoading("page-change-animation"),n.viewOpts.viewertype=="vertical"&&t.initiator!="scroll"&&n.setScroll(n.magPagesPos[i.num].y),n.isPreview&&n.$el.scrollTop(0),clearInterval(n.showPageCompleteInterval);let w=()=>{for(let M=0;M<n.pages.length;M++){let P=n.pages[M];(P.num<a||P.num>p)&&P.hide()}};n.trigger("pageChangedReady",i);let v=()=>{i.start(),n.loadPages()};(n.loadingPaused?n.whenRenderResumed:Promise.resolve()).then(()=>{n.refreshPagesAfterScroll.__debounced({firstVisible:a,lastVisible:p,newPage:i,hidePages:w,renderPage:v})})}},refreshPagesAfterScroll:function({firstVisible:e,lastVisible:t,newPage:i,hidePages:o,renderPage:r}){o(),this.whenWidgetsCreated[i._id]?.then(r),this.pages.forEach(n=>{n.num>=e&&n.num<=t&&n._id!==i._id&&this.whenWidgetsCreated[n._id]?.then(()=>this.loadPages())})},scheduleSetUrlString:function(){if(!Modernizr.chrome){this.router.setUrlString.apply(this.router,arguments),this._resetUrlStringTimeoutFunc=!1;return}let e=arguments;this._resetUrlStringTimeoutFunc=function(){clearTimeout(this._urlStrigScheduleTimeout),this._urlStrigScheduleTimeout=setTimeout(function(){this._resetUrlStringTimeoutFunc=null,this.router.setUrlString.apply(this.router,e)}.bind(this),100)}.bind(this),this._resetUrlStringTimeoutFunc()},goNextPage:function(e){this.isLastPage()||this.currentPage&&this.router.go(this.currentPage.num+1,{...e,isPageNum:!0})},goPrevPage:function(e){this.isFirstPage()||this.currentPage&&this.router.go(this.currentPage.num-1,{...e,isPageNum:!0})},goFirstPage:function(){this.router.go(1,{isPageNum:!0})},goLastPage:function(){this.router.go(this.getPagesCount(),{isPageNum:!0})},pauseLoading:function(e){this.pauseReasons=this.pauseReasons||{},this.pauseReasons[e]=!0,this.loadingPaused=!0,this.whenRenderResumed instanceof Promise||(this.whenRenderResumed=new Promise(t=>{let i,o=()=>{this.loadingPaused?i=setTimeout(o,17):(clearTimeout(i),t(),this.whenRenderResumed=null)};o()}))},continueLoading:function(e){this.pauseReasons=this.pauseReasons||{},this.pauseReasons[e]=!1,this.loadingPaused=!g.default.every(g.default.values(this.pauseReasons),function(t){return!t})},loadPages:function(){if(ot.setTiming("load_pages_start",Date.now()),!this.pages||!this.pages.length)return;let e=this.getPagesLoadOrder();if(!e||!e.length)return;var t=[],i,o,r;let n=[];for(i=0;i<e.length;i++){r=this.pages[e[i]];let p=r.getWidgetsPacks();p.length&&t.push(p),n=n.concat(r.getImmediatePack())}if(!t.length)return;let s=[];for(i=0;i<t.length;i++){i==0&&a(i,0),a(i+1,0);for(var o=1;o<t[i].length;o++)a(i,o)}s.unshift(n),this.widgetsPacksLoadQueue=s,this.stopPagesLoad(),this.renderNextWidgetPack();function a(p,c){p<0||p>=t.length||c<0||c>=t[p].length||s.push(t[p][c])}},stopPagesLoad:function(){clearTimeout(this.loadNextWidgetsTimer)},renderNextWidgetPack:function(){if(!this.widgetsPacksLoadQueue.length){ot.setTiming("load_pages_end",Date.now()),ct.default.trigger("widgetsQueue:empty",this.num_id);return}if(this.loadingPaused){this.loadNextWidgetsTimer=setTimeout(this.renderNextWidgetPack,50);return}let e=this.widgetsPacksLoadQueue.shift();if(!e.length){this.loadNextWidgetsTimer=setTimeout(this.renderNextWidgetPack,17);return}let t=g.default.uniq(g.default.map(e,"page")),i=t[0];if(t.length===1&&(!i.shown||i.loaded)){this.loadNextWidgetsTimer=setTimeout(this.renderNextWidgetPack,17);return}i.renderWidgetPack(e,g.default.bind(function(){this.widgetPackCount++,this.loadNextWidgetsTimer=setTimeout(this.renderNextWidgetPack,17)},this))},getPreloadPageCount:function(e,t){if(this.viewOpts.viewertype=="horizontal")return this.PRELOAD_COUNT[t];let i=1,o=0,r=t=="forward"?1:-1;for(;o<this.PRELOAD_COUNT[t]&&i*r+e<this.pages.length&&i*r+e>=0;)o+=this.pages[i*r+e].height,i++;return i},getPagesLoadOrder:function(){let e=this.currentPage;if(!e)return;let t=e.num-1,i=this.pages.length,o=[],r=this,n,s=e.num-this.getPreloadPageCount(t,this.direction=="forward"?"backward":"forward"),a=e.num+this.getPreloadPageCount(t,this.direction);if(p(t),this.direction=="backward"){for(p(t-1),p(t+1),n=t-2;n>=s;n--)p(n);for(n=t+2;n<=a;n++)p(n)}else{for(p(t+1),p(t-1),n=t+2;n<=a;n++)p(n);for(n=t-2;n>=s;n--)p(n)}return o;function p(c){c<0||c>=i||!r.pages[c].shown||r.pages[c].loaded||o.push(c)}},onGestureChange:function(){this.onResize.__debounced()},checkFullscreen:function(){this.fullscreenCheckCounter=5,clearInterval(this.fullscreenCheckTimer),this.fullscreenCheckTimer=setInterval(g.default.bind(function(){let e=window.fullScreen||window.innerWidth==screen.width&&window.innerHeight>=screen.height-1;this.togglePresentationMode(e),this.fullscreenCheckCounter--,this.fullscreenCheckCounter||clearInterval(this.fullscreenCheckTimer)},this),500)},onResize:function(){if(this.isEcwidOpened)return;if(this.checkFullscreen(),!u.isDesktop()&&this.viewOpts.viewertype=="horizontal"||this.viewOpts.viewertype=="vertical"&&!this.isStickyVerticalViewer){let n=this.viewOpts.viewertype=="horizontal"?(0,m.default)("html, body").add(this.$el):this.$el,s=_.isPageNativelyScaled(),a=window.innerHeight;a==337&&(0,m.default)(window).height()==414&&a++,n.height(s?"100%":a),!s&&n.scrollTop(0)}let e=this.getContainerSize(),t=this.isPortrait()?"portrait":"landscape",i=!1;if(!u.isDesktop()&&this.prevOrientation&&this.prevOrientation!==t){let n=this.getPage(this.currentPage.num-1),s=Ie.findPlayingVideo(this.currentPage.widgets)||Ie.findPlayingVideo(n?.widgets),a=s?ie.doBoundingBoxesIntersect(s.$el[0].getBoundingClientRect(),{top:0,left:0,bottom:window.innerHeight,right:window.innerWidth}):!1;s&&a?(this.hadPlayingVideoOnResize=!0,setTimeout(()=>{s.page.num===this.currentPage.num&&this.setScrollPosition({offset:s.y*this.getScale(this.currentPage.pageViewport)})},500)):(this.hadPlayingVideoOnResize=!1,this.switchToViewport(this.getMagViewport()),this.setPagesTransitions(),this.stopPagesLoad(),setTimeout(this.onResize,300),setTimeout(this.onResize,1500)),i=!0}if(this.prevOrientation=t,this.isPreview&&this.viewport!="default"){let n=Math.round((this.$el.width()-e.width)/2),s=Math.round((this.$el.height()-e.height)/2);this.$mag_container.add(this.$mag_viewport_device).css({top:Math.max(s,0),left:Math.max(n,0),width:e.width,height:e.height})}else this.$mag_container.add(this.$mag_viewport_device).css({top:"",left:"",width:"",height:""});this.$mag_viewport_device.attr("data-viewport",this.viewport),this.setNewPagesWidths(e.width,e.height),this.magHeight=0,this.magPagesPos=[];let o=this.pages&&this.pages.length;if(g.default.each(this.pages,g.default.bind(function(n,s){let a=n.onResize({absolutePosition:this.magHeight}),p=0;s<o-1&&this.viewOpts.slidein&&(p=this.SCROLL_SNAP),this.magPagesPos[n.num]={y:this.magHeight,h:a,dh:p},this.magHeight+=a+p},this)),this.viewOpts.viewertype==="vertical"&&this.magHeight){let n=this.$magScrollSizer?.width(),s=0;if(this.isPreview&&this.viewport!=="default"){let a=this.getViewportSetting("min_height"),p=this.viewport==="tablet_portrait"?a*.75:a;s=Math.max(this.$el.height()-p,0)}if(this.$magScrollSizer?.css("height",this.magHeight+s),n!=this.$magScrollSizer?.width()&&u.isDesktop()&&this.onResize(),this.currentPage){if(!this.isStickyVerticalViewer&&!this.hadPlayingVideoOnResize)this.setScroll(this.getScrollPosForNewSize()),this.onMagScroll();else if(i&&!this.hadPlayingVideoOnResize){var r=this.getScrollPosForNewSize();setTimeout(g.default.bind(function(){this.setScroll(r)},this),0)}}this.$bottomArrow&&this.$bottomArrow.toggleClass("offscreen",this.getScroll()+e.height+this.SCROLLABLE_TRESHOLD>this.magHeight)}if(this.viewOpts.viewertype=="horizontal"&&this.currentPage&&i&&!this.hadPlayingVideoOnResize){var r=this.getScrollPosForNewSize();setTimeout(g.default.bind(function(){this.currentPage.$scrollWrapper.scrollTop(r)},this),0),this.aboveGlobalWidgetsRendered||setTimeout(g.default.bind(function(){this.aboveGlobalWidgetsRendered||this.renderAboveGlobalWidgets(this.currentPage)},this),40)}this.currentPage&&this.loadPages.__debounced()},onOrientationChange(){let e=this.viewOpts.viewertype,t=this.currentPage.num;this.onResize(),e!==this.viewOpts.viewertype?this.router.restartMag({currentPage:t}):(this.unsetViewerClasses(),this.setViewerClasses(),this.destroyControls(),this.renderControls())},onOptionsChange(e={},t={},i="default"){let o=n=>i!=="default"?t[n]!==e?.[n]&&St.includes(n):t[n]!==e?.[n];i==="default"&&(this.opts=t),o("projectinfo")&&this.toolbar.changeProjectInfoVisible(t.projectinfo);let r=o("arrows");r&&t.viewertype==="horizontal"&&t.arrows?(this.navigation?.destroy(),delete this.navigation,this.navigation=new pt({mag:this,router:this.router,$container:this.$el,isPreview:this.isPreview,hasFinalPage:t.endpage,viewerType:t.viewertype}).render()):r&&t.viewertype==="horizontal"&&!t.arrows&&(this.navigation?.destroy(),delete this.navigation),r&&t.viewertype==="vertical"&&t.arrows?this.showBottomButton():r&&t.viewertype==="vertical"&&!t.arrows&&this.hideBottomButton(),o("scalableviewer")&&window.dispatchEvent(new Event("resize")),o("slidein")&&(this.viewOpts.slidein=t.slidein,this.$el.removeClass("pages-pos-normal pages-pos-overlap").addClass("pages-pos-"+(t.slidein?"overlap":"normal"))),o("viewertype")&&RM.constructorRouter?.preview.restartMag()},getScrollPosForNewSize:function(){return this.currentPage?this.viewOpts.viewertype=="vertical"?this.magPagesPos[this.currentPage.num].y+(this.lastPageScrollPercent||0)*this.currentPage.pageHeight:(this.lastPageScrollPercent||0)*this.currentPage.pageHeight:0},setNewPagesWidths:function(e,t){let i=this.$el.find("#page-position-style"),o=u.isDesktop()?"":" translateZ(0)",r=`        .mag .mag-pages-container .container {
          left: 0px;
          width: `+e+`px;
        }
        .mag .mag-pages-container .container .page {
          left: 0px;
          width: `+e+`px;
        }
`,n="";if(this.viewOpts.viewertype=="horizontal")n=`          .mag .mag-pages-container .container .page.prev-page {
            -webkit-transform: translateX(`+(this.viewOpts.slidein?0:-e)+"px) "+o+`;
            transform: translateX(`+(this.viewOpts.slidein?0:-e)+"px) "+o+`;
          }
          .mag .mag-pages-container .container .page.center-page {
            -webkit-transform: translateX(0) `+o+`;
            transform: translateX(0) `+o+`;
          }
          .mag .mag-pages-container .container .page.next-page {
            -webkit-transform: translateX(`+e+"px) "+o+`;
            transform: translateX(`+e+"px) "+o+`;
          }`;else if(!this.isStickyVerticalViewer)n=`            .mag .mag-pages-container .container .page.prev-page {
              top: `+(-t-1)+`px;            }
            .mag .mag-pages-container .container .page.next-page {
              top: `+(t+1)+`px;            }
`;else{let s=this.getContainerSizeCached().height;n="            .mag .mag-pages-container .container .page .page-fixed-bg-container,            .mag .mag-pages-container .container .page .fixed-position-container,            .mag .mag-pages-container .container .page .fixed-position-container-top {              height: "+s+`px;            }
            .mag .mag-pages-container .container .page .fixed-position-container,            .mag .mag-pages-container .container .page .fixed-position-container-top,            .mag .mag-pages-container .container .page:not(.hide-sticky) .content-scroll-wrapper {              margin-top: `+-s+`px;            }
`}i.length||(i=(0,m.default)('<style id="page-position-style" type="text/css">'),i.appendTo(this.$el)),this.viewOpts.viewertype=="horizontal"?(this.$pages_container.addClass("disable-transitions-on-resize"),i.text(r+n),this.$pages_container.height(),this.$pages_container.removeClass("disable-transitions-on-resize")):i.text(r+n)},setPagesTransitions:function(){let e=this.$el.find("#page-transition-style"),t=this.getPageTransitionTime(),i="cubic-bezier(0.40, 0.24, 0.40, 1)",o=`        .mag .mag-pages-container .container .page {
          -webkit-transition:	all `+t+"ms "+i+";          transition: all "+t+"ms "+i+`;        }
        .mag .mag-pages-container .container .page.center-page {
          -webkit-transition:	all `+(t-5)+"ms "+i+";          transition: all "+(t-5)+"ms "+i+`;        }
        `;e.length||(e=(0,m.default)('<style id="page-transition-style" type="text/css">'),e.appendTo(this.$el)),e.text(o)},switchToViewport:function(e){if(this.viewport==e)return;let t=this.viewport;this.containerSize=null,this.viewport=e,this.trigger("change:viewport",{viewport:this.viewport,oldViewport:t}),this.aboveGlobalWidgetsRendered=!1,this.aboveGlobalWidgets&&this.aboveGlobalWidgets.forEach(function(i){i.destroy(),i.off()}),this.aboveGlobalAnimations&&this.aboveGlobalAnimations.destroy(),this.aboveGlobalWidgets=[],g.default.each(this.pages,function(i){i.updateViewport()})},getContainerSize:function(){let e,t,i=this;return this.isPreview&&this.viewport!="default"?(e=this.getViewportWidth(this.viewport),t=Math.min(this.getViewportSetting("min_height"),this.$el.height())):(e=RM.screenshot?(0,m.default)(window).width():this.$el.width(),RM.screenshot?t=window.innerHeight:this.isStickyVerticalViewer&&(Modernizr.safari||Modernizr.android)&&!u.isDesktop()?t=o():this.isStickyVerticalViewer?t=window.innerHeight:t=this.$el.height()||window.innerHeight),this.containerSize={width:e,height:t,windowClientWidth:document.documentElement.clientWidth,windowClientHeight:document.documentElement.clientHeight,pagesContainerWidth:this.$pages_container.width(),pagesContainerHeight:this.$pages_container.height()},this.containerSize;function o(){return i.isPortrait()?$e("viewer.paintGlassToolbar")?window.innerHeight:Math.max(window.innerHeight,screen.height-20-20+1):Math.min(screen.width,screen.height)}},getContainerSizeCached:function(){return this.containerSize||this.getContainerSize()},getViewportWidth(e){return!e||e==="default"?this.desktopWidth||V.dictionary.default.width:e==="phone_portrait"?this.phoneWidth||V.dictionary.phone_portrait.width:V.dictionary[e].width},isPortrait:function(){return window.screen?window.screen.orientation&&window.screen.orientation.type?!!window.screen.orientation.type.match(/portrait/i):window.orientation===0?!0:window.orientation===90||window.orientation===-90?!1:window.innerWidth<window.innerHeight:window.innerWidth<window.innerHeight},getMagViewport:function(){let e=this.isPortrait();if(this.isPreview)return this.constructorViewport||"default";{let t="default",i=window.innerWidth;if(Modernizr.retina||!u.isDesktop()||Modernizr.ismobile){if(screen&&screen.width&&(i=e?Math.min(screen.width,screen.height):Math.max(screen.width,screen.height)),e)return i<600?"phone_portrait":i>=600&&i<=1024?"tablet_portrait":"default";if(i>980)return"default"}if(Modernizr.isipad)return e?"tablet_portrait":"default";if(!u.isDesktop()){let o=i,r=g.default.reduce(V.viewports,function(n,s,a){return Math.abs(s.width-o)<=Math.abs(V.viewports[n].width-o)?a:n},0);t=V.viewports[r].name}return t}},getViewportSetting:function(e,t){return(V.dictionary[t||this.viewport]||{})[e]},log:function(){let e="";for(let r=0;r<arguments.length;r++)e+=arguments[r]+" ";let t=(0,m.default)("#log");t.length||(t=(0,m.default)('<div id="log">').css({position:"fixed",background:"rgba(0, 0, 0, 0.7)",color:"#fff",width:200,height:300,left:10,top:10,"z-index":999999,overflow:"auto"}).appendTo("body"));let i=t.html(),o=i.split("<br>");t.html(o.slice(-17).join("<br/>")+"<br/>"+e),t.scrollTop(999999)},fixFocusScroll:function(){this.$mag_container.scrollTop(0),this.$mag_container.scrollLeft(0)},matchSameDomainLink:function(e){let t=e.match(new RegExp("//"+_.escapeSpecial(window.location.hostname)+"/(.*)")),i=t&&t[1];if(i){let o=this.getPageByPath(i);if(o)return o._id}return e},getScale:function(e){let t=Math.min(this.viewOpts.scalewidth,this.getContainerSizeCached().width),i=this.getViewportWidth(e),o=t/i;return I.normalize(o,void 0,this.viewport,i,this.viewOpts)},getAllWidgetViewsById(e,t){let i=!!this.staticGlobalWidgetsData.find(r=>r._id===e),o=!!this.aboveGlobalWidgetsData.find(r=>r._id===e);return i&&!o?this.pages.filter(n=>n.hasWidget?.(e)).map(n=>this.getWidgetById(e,n)):[this.getWidgetById(e,t)]},async getAllWidgetViewsByIdAsync(e,t){let i=[],o=this.getAllWidgetViewsById(e,t);for(let r of o)try{i.push(await r)}catch(n){}return i},getWidgetById:function(e,t){let i,o,r,n=t?.hasWidget?.(e)?t:this.pages.find(s=>s.hasWidget?.(e));return n?(o=n.getWidgetById(e),o?i=window.Promise.resolve(o):n.loaded||(i=new window.Promise(function(s,a){this.listenToOnce(n,"loaded"+e,function(){let p=n.getWidgetById(e);p?s(p):a()})}.bind(this)))):(r=g.default.find(this.aboveGlobalWidgetsData,{_id:e}),r&&(o=g.default.find(this.aboveGlobalWidgets,{_id:e}),o?i=window.Promise.resolve(o):this.aboveGlobalWidgetsRendered||(i=new window.Promise(function(s,a){this.listenToOnce(this,"aboveGlobalWidgetsRendered",function(){let p=g.default.find(this.aboveGlobalWidgets,{_id:e});p?s(p):a()})}.bind(this))))),i||window.Promise.reject()},renderAboveGlobalWidgets:function(e){let t=[],i=e.pageViewport;g.default.each(this.aboveGlobalWidgetsData,function(o){let r=g.default.find(this.aboveGlobalWidgets,{_id:o._id});r&&(r.destroy(),r.off());let n;if(o){let s=e.getWidgetViewportData(o,i),a=!this.isPreview&&O.hasExpired(s);fe[s.type]&&!a&&(n=new fe[s.type](s,e),n.$fixedContainer=this.$aboveWidgetsContainer,n.isValid()&&t.push(n))}}.bind(this)),this.aboveGlobalAnimations=this.initializeAboveGlobalAnimation(t,e),g.default.each(t,function(o){try{o.render(),o.hidden||e.isPasswordProtected()?L.hide(o,!0):L.show(o,!0)}catch{console.error(`Failed to render global widget ${o._id}`)}}),this.aboveGlobalWidgets=Le(t),this.aboveGlobalWidgetsRendered=!0,this.trigger("aboveGlobalWidgetsRendered")},initializeAboveGlobalAnimation:function(e,t){e=g.default.isArray(e)?e:[e],t.scale=this.getScale(t.pageViewport);let i=new Ue({page:t,widgets:e}),o=[];return g.default.each(e,function(r){let n=new window.Promise(function(s){r.loaded?s(r):r.on("loaded",s.bind(null,r))});o.push(n)}),window.Promise.all(o).then(function(){this.aboveAnimationsReady=!0,this.trigger("aboveAnimationsReady")}.bind(this)),this.listenTo(t,"resize",function(r){!g.default.isUndefined(r.prevScale)&&r.prevScale!==r.scale&&i.updateTimelines(),i.onResize({updateAll:!0})}),i},updateAboveGlobalViewport:function(e,t){let i=g.default.find(this.aboveGlobalWidgetsData,{_id:e._id}),o=t.getWidgetViewportData(i,t.pageViewport);if(e.animationObj&&this.aboveGlobalAnimations.removeAnimation(e.animationObj),e.destroy(),e.initialize(o,t),e.hasAnimation()){let r=null;r=this.aboveGlobalAnimations.addAnimation(e,{isNested:!1}),r&&r.start()}e.render(),L.hide(e,!0)},getAboveGlobalBox:function(e,t,i){let o=g.default.find(this.aboveGlobalWidgetsData,{_id:e}),r=t.getWidgetViewportData(o,t.pageViewport);return Lt.getFixedPositionBox(r.fixed_position,g.default.pick(r,["x","y","w","h"]),t.scale,i)},redrawAboveGlobalWidgets:function(e,t,i,o){if(!e){let s=g.default.isUndefined(this.getScroll())?void 0:this.findPageOnCurrentMagScroll(),a=s&&s.page.num,p=s&&this.getScrollParams(s);e=a&&this.getPage(a),t=e&&this.getPage(e.num+1),i=p&&(p.slideInNextPageScroll||p.nextPageScroll),o=p&&p.animation}i=g.default.isUndefined(i)?void 0:Math.abs(i);let r={width:Math.min(this.viewOpts.scalewidth,this.getContainerSizeCached().width),height:this.getContainerSizeCached().height},n=function(s,a){return!s.page||a&&s.page.pageViewport!==a.pageViewport};if(g.default.isUndefined(i)){let s=this.getPageTransitionTime();g.default.each(this.aboveGlobalWidgets,function(a){let p=e._id&&n(a,e);e._id&&a.updatePage(e),p&&this.updateAboveGlobalViewport(a,e),e._id&&!L.isHidden(a,e._id,this.isPreview)&&!e.isPasswordProtected()?o?a.wasHidden&&_.waitForTransitionEnd(e.$el,s,"transform",L.show.bind(null,a)):a.wasHidden&&L.show(a):!a.wasHidden&&L.hide(a)}.bind(this))}else{let s=Math.abs(i);g.default.each(this.aboveGlobalWidgets,function(a){let p=!L.isHidden(a,e._id,this.isPreview)&&!e.isPasswordProtected(),c=t&&!L.isHidden(a,t._id,this.isPreview)&&!t.isPasswordProtected(),w=p&&c&&e.pageViewport===t.pageViewport,v=this.getAboveGlobalBoxMemoized(a._id,e,r),M=this.getAboveGlobalBoxMemoized(a._id,t||e,r),P=p&&s>v.top+v.height,T=t&&c&&M.top>s;if(P||T||w||!t&&p){let C=P?e:T?t:a.page,h=n(a,C);a.updatePage(C),h?(a.rendered=!1,L.hide(a).then(function(){this.updateAboveGlobalViewport(a,C),L.show(a)}.bind(this))):a.wasHidden&&L.show(a)}else!a.wasHidden&&L.hide(a)}.bind(this))}},getUsedFonts(e={}){return K.getUsedFontsFromWidgetsModels({...e,models:this.pages.reduce((t,i)=>i.widgets.reduce((o,r)=>o.push(r)&&o,t),[]),customList:e.includeCustom?g.default.filter(this.edit_params&&this.edit_params.fonts,{provider:"custom"}):[]},K.fontsShortList)},hasNewTextWidgets(){return this.hasTextWidgetsV3||Kt(this.model.attributes)||Zt(this.aboveGlobalWidgetsData)},hasCodeInjection:function(){if(g.default.any(["ci_head","ci_body_top","ci_body_bottom","ci_css"],i=>!!this[i]))return!0;let t=!1;return g.default.each(this.pages,function(i){g.default.each(i.widgetsData,function(o){let r=!!(o.type==="iframe"&&o.code);if(!r||o.use_iframe)return;let s=(0,bi.getEmbedType)(o.code)==="codeinjection";if(!s)return;let a=!!(g.default.all(V.viewport_listall,function(p){let c=o[p];return c&&c.hidden||!c})&&o.hidden);r&&s&&!a&&(t=!0)})}),t},setupEcommerceSidebar:function(){this.eCommerceManager?.getConnectedProvider()==="ecwid"?this.cartSidebar=new qt(this):this.cartSidebar=new Qt(this)},closeMagMenu(){this.toolbar&&this.toolbar.closeMenu()}}),Pn=Ji;export{Ee as a,co as b,Ie as c,ot as d,Pn as e};

import{b as Kn,c as Tr,d as Xn,e as Er}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-FTHXBK3Z.js";import{b as Hn,c as Et,d as jn,e as Wn,f as zn,h as Vn,i as _n}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-FF5WEGUP.js";import{a as $n,b as Yn,c as Gn,d as qn,f as Ze,g as ve,i as Qe}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-TSMT6TR6.js";import{a as Be,b as Jn}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-N2KHJOXT.js";import{r as Qn,u as kr}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-UVVPQUEO.js";import{b as Zn,d as vr}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-5WD2AJ36.js";import{$ as sn,$a as Tn,Ca as Xe,Da as hn,Fa as Sn,Fb as Ct,G as $e,I as en,Ib as Tt,Ja as xn,Kb as ge,L as tn,M as nn,Nb as H,Oa as hr,P as mt,Pa as bn,Q as Fe,R as Ye,Ra as Sr,V as on,W as Ce,Wa as Te,X as gt,Xa as Cn,Xb as In,Yb as Fn,Zb as Ln,_ as rn,_b as Rn,a as cr,ab as Je,b as ur,ba as ln,bc as Mn,c as dr,cb as En,cc as Bn,da as Ge,dc as Dn,ec as An,f as _e,fa as yt,ga as ht,ha as an,hb as Me,i as fr,ia as cn,ib as vn,j as _,ja as un,jb as Ee,k as Jt,la as St,m as Ie,ma as dn,na as fn,oa as mr,pa as qe,pc as ae,qa as pn,qb as kn,ra as xt,rc as On,sc as de,ta as mn,tb as wn,ub as bt,va as yr,vb as Pn,w as Qt,wa as Le,x as be,ya as gn}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-WVP3CYWZ.js";import{k as gr}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-UHXDCVRZ.js";import{f as Zt,x as pr}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-2FAEKG6V.js";import{a as Re,g as yn}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-JOVHXRDR.js";import{n as Kt,o as or}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-CWQ7UVOU.js";import{a as pt,b as lr}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-SWJBEXY2.js";import{a as qt,b as ar}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-X75HIC2Q.js";import{a as Un,b as Cr}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-WOTZLG5D.js";import{a as br}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-FHI2NYF5.js";import{a as Nn,b as xr}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-Q25SHUGF.js";import{a as F,d as xe}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-RFFKETAO.js";import{C as Ht,D as jt,E as Wt,p as ft}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-3Z7TN3F3.js";import{r as Se,v as ze}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-XLELSLJ5.js";import{i as Ve,j as Gt,k as Xt}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-F7HHU2GW.js";import{c as $t,d as sr,h as Yt,j as ir}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-BQ6MT626.js";import{c as Vt,e as _t}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-ZFCQ6P44.js";import{C as me,D as h,E as V,F as te,d as je,e as zt,u as We}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-EW5ORGES.js";import{a as le}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-75DVMCH6.js";import{a as rr}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-7UUZVYIG.js";import{a as B,d as U}from"https://st-p.rmcdn1.net/fb5a3d71/dist/c/c-ZYG7ZY5I.js";var vt,eo=B(()=>{"use strict";be();Ye();gt();de();vr();vt=({editorState:e,method:t})=>{let o=H(e,"LETTER_SPACING"),n=o&&o.length?parseFloat(o[0]):0,r=ae({editorState:e}),i=en()||{project:[],global:[]},l=[...i.project,...i.global].find(u=>u.name===r),m=!!r&&Ce(l?.cssProperties.letterSpacing,!0),p=n||m||0,a=t==="decrease"?-1:1;return ge({key:"LETTER_SPACING",value:Zn(p+.2*a,2),editorState:e})}});var kt,to=B(()=>{"use strict";be();Ie();de();kt=({editorState:e,method:t})=>{let o=H(e,"FONT_SIZE"),n=o&&o.length?parseInt(o[0]):_.fontSize,r=t==="decrease"?-1:1;return ge({key:"FONT_SIZE",value:n+r,editorState:e})}});function De(e){return!e.isFolder}function no(e){return!!e.isFolder}function ms({all:e,allProjects:t,excluded:o,selectedUser:n,me:r}){let s=(o||[]).map(i=>i._id);return n&&typeof n=="object"&&n._id&&s.push(n._id),e.reduce((i,l)=>{if(l.email===r.email||l.isSupport)return i;let m=Pr(l,t)+Ir(l.folderIds||[],t).length,p={...l,projectsCount:m},a=i.map(d=>d._id);return!l.isPending&&!l.isSupport&&![...s,...a].includes(l._id)?[...i,p]:i},[])}function wr(e){return e.reduce((t,o)=>De(o)?[...t,o.num_id]:t,[])}function gs(e){return e.reduce((t,o)=>no(o)?[...t,o._id]:t,[])}function Pr(e,t){let o=wr(t);return e.projects?e.projects.filter(n=>!n.isArchived).length:e.sharesAll?t.length:e.projectNumIds.filter(n=>o.includes(n)).length}function ys({projects:e,allTeammates:t,me:o}){return e.length?t.filter(n=>n.email===o.email?!1:!n.projects&&(n.sharesAll&&e.every(r=>De(r))||e.every(r=>De(r)&&(n.projectNumIds||[]).includes(r.num_id)||De(r)&&!!r.folder&&(n.folderIds||[]).includes(r.folder)||no(r)&&(n.folderIds||[]).includes(r._id)))):[]}function hs(e,t={}){let o=e.projectNumIds?[...e.myTeam,...e.sharedTeam].filter(r=>ft(e.projectNumIds,r.projectNumIds).length>0||ft(e.folderIds,r.folderIds).length>0||t.excludeSupport&&!r.isSupport):[...e.myTeam,...e.sharedTeam],n=jt(o,"email");return n.map(r=>{if(!r.isPending)return r;let s=n.find(i=>i.email===r.email&&i._id!==r._id);return s?{...r,name:s.name,pic:s.pic}:r})}function Ir(e,t){return e?t.filter(o=>De(o)&&o.folder&&e.includes(o.folder)).map(o=>o.num_id):[]}function Ss(e){return e&&e.plan_limits&&e.plan_limits.contributors||0}function xs(e){return e.filter(t=>t.sharesAll||t.projectNumIds&&t.projectNumIds.length||t.folderIds&&t.folderIds.length)}function oo({projectNumId:e,projectFolderId:t,folderId:o,teammate:n}){return typeof e=="number"&&n.projectRoles?.hasOwnProperty(e)?n.projectRoles[e]:typeof o=="string"&&n.folderRoles?.hasOwnProperty(o)?n.folderRoles[o]:typeof t=="string"&&n.folderRoles?.hasOwnProperty(t)?n.folderRoles[t]:null}function bs({items:e=[],roles:t={},newItems:o,newRole:n}){let r={},s=[];for(let i of e)t.hasOwnProperty(i)&&(r[i]=t[i],s.push(i));if(n&&o?.length)for(let i of o)r[i]=n,s.includes(i)||s.push(i);return{roles:r,items:s}}var ro=B(()=>{"use strict";Wt()});var so,fe,wt=B(()=>{"use strict";ro();so="projectRoles",fe={rolesList:[{name:"member",description:"Layout unlocked"},{name:"editor",description:"Layout locked",secondaryDescription:"Enables non-designers to make changes safely"}],isPermissionAllowed(e){return window.RM?.constructorRouter?.mag?.isPermissionAllowed?.(e)??!0},checkSelfRoleChanged({teammate:e,isOwner:t,projectNumId:o,userEmail:n,team:r}){if(t&&e.email===n){let s=e.projectRoles?.[o],i=r?.find(l=>l.email===n)?.projectRoles?.[o];return s!==i}return!1},getRoleForProject({team:e,projectNumId:t,userEmail:o}){let n=e.find(r=>r.email===o);if(n){let r=oo({teammate:n,projectNumId:t});if(r)return r}return null},getCurrentRole(){return window.RM?.constructorRouter?.mag?.roleName??"member"},getAllProjectRoles(){let e={};try{let t=sessionStorage.getItem(so);e=t?JSON.parse(t):{}}catch(t){console.log(t)}return e},saveProjectRole(e,t){try{let o=fe.getAllProjectRoles();o[e]=t,sessionStorage.setItem(so,JSON.stringify(o))}catch(o){console.log(o)}},getCurrentProjectRole(e){return fe.getAllProjectRoles()[e]||"member"},getRoleForAnalytics(e){let t=fe.getCurrentRole();return e?"owner":t==="editor"?"collaborator_locked_layout":"collaborator_unlocked_layout"}}});var tt,D,io,lo,Pt=B(()=>{"use strict";tt=U(_e());de();jn();ht();eo();to();fr();un();be();Ie();Sr();wt();D=({event:e,keyCode:t,ctrlOrCmd:o=!1,shift:n=!1,alt:r=!1})=>{let s=tt.KeyBindingUtil.usesMacOSHeuristics();return t===e.keyCode&&n===e.shiftKey&&r===e.altKey&&(s?o===e.metaKey:o===e.ctrlKey)},io=e=>{let t=fe.isPermissionAllowed("TextCanChangeTypography"),o=fe.isPermissionAllowed("TextCanChangeAlign"),n=fe.isPermissionAllowed("TextCanChangeAdvancedTypography");if(D({event:e,keyCode:32,alt:!0})||D({event:e,keyCode:32,alt:!0,ctrlOrCmd:!0}))return"InsertNbsp";if(D({event:e,keyCode:32,alt:!0,ctrlOrCmd:!0,shift:!0}))return"InsertThinsp";if(D({event:e,keyCode:32,alt:!0,shift:!0}))return"InsertEnsp";if(D({event:e,keyCode:9}))return"IncreaseIndent";if(D({event:e,keyCode:9,shift:!0}))return"DecreaseIndent";if(D({event:e,keyCode:65,ctrlOrCmd:!0,shift:!0}))return"SelectParagraph";if(D({event:e,keyCode:84,alt:!0,ctrlOrCmd:!0}))return"ToggleTypographyPanel";if(D({event:e,keyCode:75,ctrlOrCmd:!0}))return"ToggleLinkPanel";if(t){if(D({event:e,keyCode:38,alt:!0}))return"DecreaseLineHeight";if(D({event:e,keyCode:40,alt:!0}))return"IncreaseLineHeight";if(D({event:e,keyCode:37,alt:!0}))return"DecreaseLetterSpacing";if(D({event:e,keyCode:39,alt:!0}))return"IncreaseLetterSpacing";if(D({event:e,keyCode:190,ctrlOrCmd:!0,shift:!0}))return"IncreaseFontSize";if(D({event:e,keyCode:188,ctrlOrCmd:!0,shift:!0}))return"DecreaseFontSize"}if(o){if(D({event:e,keyCode:76,ctrlOrCmd:!0,shift:!0}))return"AlignLeft";if(D({event:e,keyCode:82,ctrlOrCmd:!0,shift:!0}))return"AlignRight";if(D({event:e,keyCode:67,ctrlOrCmd:!0,shift:!0}))return"AlignCenter"}if(n){if(D({event:e,keyCode:66,ctrlOrCmd:!0}))return"ToggleBold";if(D({event:e,keyCode:73,ctrlOrCmd:!0}))return"ToggleItalic";if(D({event:e,keyCode:85,ctrlOrCmd:!0}))return"ToggleUnderline"}return(0,tt.getDefaultKeyBinding)(e)},lo=({action:e,editorState:t,workspace:o})=>{if(e==="InsertNbsp")return{status:"handled",editorState:Ee({editorState:t,text:bn})};if(e==="InsertEnsp")return{status:"handled",editorState:Ee({editorState:t,text:"\u2002"})};if(e==="InsertThinsp")return{status:"handled",editorState:Ee({editorState:t,text:"\u2009"})};if(e==="IncreaseIndent"){let n=Et({editorState:t,method:"increase"});if(n)return{status:"handled",editorState:n}}if(e==="backspace"||e==="DecreaseIndent"){let n=Et({editorState:t,method:"decrease"});if(n)return{status:"handled",editorState:n}}if(e==="DecreaseLineHeight"){let n=yt({editorState:t,method:"decrease"});if(n)return{status:"handled",editorState:n}}if(e==="IncreaseLineHeight"){let n=yt({editorState:t,method:"increase"});if(n)return{status:"handled",editorState:n}}if(e==="IncreaseLetterSpacing")if(t.getSelection().isCollapsed()){let n=bt(t,"next");if(n)return{status:"handled",editorState:n}}else{let n=vt({editorState:t,method:"increase"});if(n)return{status:"handled",editorState:n}}if(e==="DecreaseLetterSpacing")if(t.getSelection().isCollapsed()){let n=bt(t,"prev");if(n)return{status:"handled",editorState:n}}else{let n=vt({editorState:t,method:"decrease"});if(n)return{status:"handled",editorState:n}}if(e==="ToggleTypographyPanel"){let n=o.controls.findControl("text_typography");if(n)return n.onClick.apply(n),{status:"handled",editorState:t}}if(e==="ToggleLinkPanel"){let n=o.controls.findControl("text_link");if(n)return n.onClick.apply(n),{status:"handled",editorState:t}}if(e==="IncreaseFontSize")return{status:"handled",editorState:kt({editorState:t,method:"increase"})};if(e==="DecreaseFontSize")return{status:"handled",editorState:kt({editorState:t,method:"decrease"})};if(e==="AlignLeft"||e==="AlignRight"||e==="AlignCenter"){let n=e==="AlignLeft"?"align-left":e==="AlignRight"?"align-right":"align-center";return{status:"handled",editorState:cn({editorState:t,align:n})}}if(e==="SelectParagraph")return{status:"handled",editorState:wn(t)};if(e==="ToggleBold"){let n=H(t,"FONT_WEIGHT");return{status:"handled",editorState:ge({editorState:t,key:"FONT_WEIGHT",value:n&&n[0]==="700"?_.fontWeight:"700"})}}if(e==="ToggleItalic"){let n=H(t,"FONT_STYLE");return{status:"handled",editorState:ge({editorState:t,key:"FONT_STYLE",value:n&&n[0]==="italic"?_.fontStyle:"italic"})}}if(e==="ToggleUnderline"){let n=H(t,"DECORATION");return{status:"handled",editorState:ge({editorState:t,key:"DECORATION",value:n&&n[0]==="underline"?"none":"underline"})}}}});var ao,co=B(()=>{"use strict";Tr();Ie();be();_n();xt();de();ao=Kn({htmlToEntity:(e,t,o)=>{if(e==="a")return o(qe,"MUTABLE",Wn(t))},htmlToStyle:(e,t,o)=>e==="b"?o.add(Tt("FONT_WEIGHT","700")):e==="i"?o.add(Tt("FONT_STYLE","italic")):o,htmlToBlock:(e,t)=>{if(e==="p"||e.match(/h\d/))return{type:"unstyled",data:zn(t,{ignore:{lineHeight:!0,textStyles:!0}})}}})});var re,fo,po,It,uo,Lr,Rr,Mr,mo,go,Br,yo,ho,So=B(()=>{"use strict";re=U(_e()),fo=U(ur()),po=U(dr());de();_n();xt();Pt();Sn();co();It="data-draftjs-conductor-fragment",uo='[data-contents="true"] [contenteditable="false"]',Lr=e=>{let{anchorNode:t,focusNode:o}=e;if(!t||!o)return!1;let n=t instanceof Element?t:t.parentElement,r=o instanceof Element?o:o.parentElement,s=n&&n.closest(uo),i=r&&r.closest(uo);return s&&i&&(s.contains(i)||i.contains(s))},Rr=(e,t)=>{let{selectionState:o}=(0,po.default)(e,t),n=(0,fo.default)(e.getCurrentContent(),o);return n.every(s=>!!(s&&s.getText().length===0))?null:n},Mr=(e,t,o)=>{let n=(o||window).getSelection();if(!t.clipboardData||!n||!e||n.rangeCount===0||Lr(n)||!e.current?._latestEditorState)return;let r=Rr(e.current?._latestEditorState,e.current?.editor);if(r){let s=re.ContentState.createFromBlockArray(r.toArray()),i=JSON.stringify((0,re.convertToRaw)(s)),l=document.createElement("div");l.appendChild(n.getRangeAt(0).cloneContents()),l.setAttribute(It,i),l.setAttribute("style","white-space: pre-wrap;"),t.clipboardData.setData("text/plain",n.toString()),t.clipboardData.setData("text/html",l.outerHTML),t.preventDefault()}},mo=(e,t)=>{let o=e.current?.editor,n=r=>{Mr(e,r,t)};return o&&o.addEventListener("copy",n),o&&o.addEventListener("cut",n),{unregister(){o&&o.removeEventListener("copy",n),o&&o.removeEventListener("cut",n)}}},go=(e,t)=>{let o=e.current,n=o?.editor;if(!o||!n)return;let r=!1,s=l=>{r=D({event:l,keyCode:86,ctrlOrCmd:!0,shift:!0})},i=l=>{l.stopPropagation(),l.preventDefault(),l.cancelBubble=!0,l.returnValue=!1;let m=l.clipboardData?.getData("text/plain"),p=l.clipboardData?.getData("text/html");m&&o.props?.handlePaste&&o.props.handlePaste(m,p,o?._latestEditorState,t.forceCleanText?!0:r)};return t.forceCleanText||n.addEventListener("keydown",s,!0),n.addEventListener("paste",i,!0),{unregister(){t.forceCleanText||n.removeEventListener("keydown",s,!0),n.removeEventListener("paste",i,!0)}}},Br=e=>{let o=new DOMParser().parseFromString(e,"text/html").querySelector(`[${It}]`);if(o){let n=o.getAttribute(It);try{if(n){let r=JSON.parse(n);if(r)return(0,re.convertFromRaw)(r)}}catch{return null}}return null},yo=(e="",t,o)=>{let n=t.getSelection(),r=!n.isCollapsed(),s=t.getCurrentContent(),i=Me(t),m=s.getBlockForKey(i[0]).getEntityAt(n.getStartOffset()),p="Text";return r&&!m&&Xe(e,o)&&(p="Link"),p},ho=({text:e,html:t,editorState:o,pastedWithShift:n})=>{let r=Je(o),s=o.getCurrentContent(),i=Me(o),m=(()=>{let p=!n,a=i.some(d=>{let u=s.getBlockForKey(d);return!!ae({editorState:o,block:u})});if(p&&!a){let d=t?Br(t):void 0,u=t?ao(Vn(t)):void 0;if(d||u){let E=d?.getBlockMap()||u?.getBlockMap();if(E){let C=re.Modifier.replaceWithFragment(s,r,An(o,Dn({originStyles:o.getCurrentInlineStyle(),blockMap:E})));return re.EditorState.push(o,C,"insert-fragment")}}}return e?Ee({editorState:o,text:e}):o})();if(i.length===1){let p=s.getBlockForKey(i[0]),a=p.getEntityAt(r.getStartOffset());if(a&&s.getEntity(a)?.getType()===qe){let d=0,u=0;p.findEntityRanges(x=>x.getEntity()===a,(x,w)=>{d=x,u=w});let E=e?.length||0,C=r.getStartOffset(),c=r.getEndOffset(),f=Math.abs(c-C),y=r.merge({anchorOffset:d,focusOffset:u+E-f});m=Bn(m,y,a),m=re.EditorState.push(o,m.getCurrentContent(),"apply-entity");let S=C+E,g=r.merge({anchorOffset:S,focusOffset:S});m=Te(m,g)}}return m}});var ce,Ft,Dr,Oe,Ar,xo,nt=B(()=>{"use strict";ce=U(le()),Ft=U(Xt());_t();zt();sr();xe();ze();te();Dr=F.withComponent(Se("iframe")``),Oe=(0,ce.createContext)({}),Ar=(0,ce.forwardRef)(({children:e,contentDidMount:t,...o},n)=>{let[r,s]=(0,ce.useState)(),[i,l]=(0,ce.useState)(null),m=()=>{if(i){let u=i.contentDocument,E=i.contentWindow;if(u&&E){let C=u.querySelector("html");s({document:u,window:E,root:C}),t&&t()}}},{body:p,head:a}=(0,ce.useMemo)(()=>r&&r.root?{body:r.root.querySelector("body"),head:r.root.querySelector("head")}:{},[r&&r.root]),d=(0,ce.useMemo)(()=>je({key:"frame-theme",container:r?.document.head}),[r&&r.document]);return h(Dr,{ref:$t(n,l),onLoad:m,frameBorder:"0",referrerPolicy:"origin",height:"100%",width:"100%",overflow:"hidden",border:"none",display:"block",srcDoc:"<!DOCTYPE html><html><head></head><body></body></html>",...o,children:r&&r.root?V(me,{children:[o.head&&a&&(0,Ft.createPortal)(o.head,a),p&&(0,Ft.createPortal)(h(Oe.Provider,{value:r,children:h(We,{value:d,children:h(F,{width:"100%",height:"100%",children:e})})}),p)]}):null})}),xo=Ar});function ai({permission:e,children:t}){let o=Ne(e);return h(bo,{disabled:!o,children:t})}function Ne(e){return fe.isPermissionAllowed(e)}var bo,Lt=B(()=>{"use strict";ze();xe();wt();te();bo=Se(F)`
  &[disabled] {
    opacity: 0.4 !important;
    pointer-events: all !important;
    cursor: default !important;

    * {
      user-select: none !important;
      pointer-events: none !important;
      cursor: default !important;
    }

    input::selection {
      background: transparent !important;
    }
  }
`;bo.displayName="PermissionContainer"});var Co=B(()=>{"use strict";Lt()});var To,Eo,Or,Nr,Ur,vo=B(()=>{"use strict";To=U(_e()),Eo=(e,t)=>{let o=e.current,n=o?.editor;if(!o||!n)return;let r=()=>{let i=n;if(i){let l=new MouseEvent("mouseup",{view:t,bubbles:!0,cancelable:!0});i.dispatchEvent(l)}},s=i=>{i.stopPropagation(),i.preventDefault(),i.cancelBubble=!0,i.returnValue=!1,o._dragCount=0,o.exitCurrentMode();let l=Ur(i);if(l){if(o.props?.handleDrop){let m=o._internalDrag?"internal":"external";o.props?.handleDrop(l,{},m)}o._internalDrag=!1,r()}};return n.addEventListener("drop",s,!0),{unregister(){n.removeEventListener("drop",s,!0)}}},Or=e=>!e||!e.ownerDocument?document:e.ownerDocument,Nr=e=>{let t="data-offset-key",o=e.nodeType===Node.TEXT_NODE&&e.parentElement||e;if(!o)return null;let n=o.closest(`[${t}]`);if(!n)return null;let s=n.getAttribute(t)?.split("-");return s&&s.length?s[0]:null},Ur=e=>{let t=null,o=null,n=Or(e.currentTarget);if(typeof n.caretRangeFromPoint=="function"){let i=n.caretRangeFromPoint(e.x,e.y);t=i?.startContainer,o=i?.startOffset}else if(e.rangeParent)t=e.rangeParent,o=e.rangeOffset;else return null;let r=Nr(t);return r?new To.SelectionState({anchorKey:r,anchorOffset:o,focusKey:r,focusOffset:o,isBackward:!1,hasFocus:!1}):null}});function Kr(e,t,o){return e<t?t:e>o?o:e}function ko(e,t){return t>=0&&e>=0&&e<t}function ot(e,t,o,n){return Number(Kr(e,t,o).toFixed(n))}function Mt(e,t,o){return e==="+"?t+o:t-o}function wo(e,t,o,n,r=!1){let s=[e>o,Rt(e)>n];return r&&s.push(e<t),s.every(i=>!i)}function Bt(e){return e=Number(e),Number.isFinite(e)&&!Number.isNaN(e)}function Po(e){return e===""||e.length===1&&e[0]==="-"?!0:!!e.endsWith(".")}function Io(e){return e.replace(",",".")}function Fo(e){let t=e.trim();function o(n,r){return n===r}for(let n=0;n<t.length;n++){let r=t[n];if(r==="."||r===","||r===""||r==="-"){let s=t[n+1];(o(r,s)||r==="-"&&n>0)&&(t=t.slice(0,n)+t.slice(n+1),n--)}}return t}function Lo(e){return e===""||(e=e.trim(),e[0]==="."&&(e="0"+e)),e}var Rt,Ro=B(()=>{"use strict";Rt=e=>e%1?e.toString().split(".")[1].length:0});function Mo({ref:e,value:t,disabled:o=!1}){let[n,r]=(0,rt.useState)("");return(0,rt.useEffect)(()=>{e.current&&!o&&r(Hr(e.current,t))},[t,o]),[o?"":n]}var rt,Hr,Bo=B(()=>{"use strict";rt=U(le());Gt();Hr=(e,t)=>{if(typeof document<"u"&&e){let o=typeof t=="number"?t.toString():t,n=document.createElement("span");document.body.appendChild(n);let r=getComputedStyle(e).getPropertyValue("font-size");r&&(n.style.fontSize=r.toString()),n.style.font=Ve.fonts.main,n.style.position="absolute",n.style.left="-9999px",n.style.margin="0",n.style.width="auto",n.style.whiteSpace="pre",n.innerHTML=o;let s=Math.ceil(n.clientWidth);return s=Math.ceil(s/2)*2+2,n.remove(),s+"px"}return""}});function jr(e,t){return{...e,...t}}function Do(e,t,o){let n=t.map(r=>{let s=jr(o,r.options);return e.addEventListener(r.eventName,r.fn,s),function(){e.removeEventListener(r.eventName,r.fn,s)}});return function(){n.forEach(r=>{r()})}}var Ao=B(()=>{"use strict"});var ke,Wr,st,Oo=B(()=>{"use strict";ke=U(le()),Wr=e=>{let t=(0,ke.useRef)(e);return(0,ke.useLayoutEffect)(()=>{t.current=e}),(0,ke.useCallback)((...o)=>{let n=t.current;return n?.(...o)},[])},st=Wr});function zr(e,t){return Math.abs(t.x-e.x)>=No||Math.abs(t.y-e.y)>=No}function Vr({getPhase:e,setPhase:t,getActions:o,completed:n,disableClickThreshold:r}){return[{eventName:"mousemove",fn:s=>{let{clientX:i,clientY:l}=s,m={x:i,y:l},p=e(),a=o();if(p.type==="MOVING"){s.preventDefault(),a?.move(m,s);return}let d=p.point;!r&&!zr(d,m)||(s.preventDefault(),t({type:"MOVING",point:m}),a?.start(s))}},{eventName:"mouseup",fn:s=>{let i=e(),l=o();if(i.type!=="MOVING"){n();return}s.preventDefault(),n(),l?.end(s)}}]}function Uo({disabled:e=!1,onMove:t,onMoveStart:o,onMoveEnd:n,disableClickThreshold:r=!1}={}){let[s,i]=(0,j.useState)({type:"IDLE",point:{x:0,y:0}}),l=j.default.useRef(s),m=j.default.useRef(),p=(0,j.useRef)(),a=st(t),d=st(o),u=st(n);(0,j.useEffect)(()=>{l.current=s},[s]);let E=(0,j.useMemo)(()=>({move:(f,y)=>{a({event:y,offset:{x:f.x-l.current.point.x,y:f.y-l.current.point.y}})},start:f=>d(f),end:f=>u(f)}),[]);(0,j.useEffect)(()=>{m.current=E},[E]);let C=(0,j.useCallback)(()=>{l.current.type!=="IDLE"&&(i({type:"IDLE",point:{x:0,y:0}}),p.current?.())},[]),c=(0,j.useCallback)(f=>{if(e){typeof p.current=="function"&&p.current();return}if(f.ctrlKey||f.metaKey||f.shiftKey||f.altKey)return;let y={x:f.clientX,y:f.clientY};i({type:"PENDING",point:y});let S=Vr({completed:C,getPhase:()=>l.current,setPhase:i,getActions:()=>m.current,disableClickThreshold:r});p.current=Do(window,S,{capture:!0,passive:!1})},[C,e]);return(0,j.useLayoutEffect)(()=>function(){p.current?.()},[]),(0,j.useMemo)(()=>({moving:s.type==="MOVING",start:c}),[c,s])}var j,No,Ko=B(()=>{"use strict";j=U(le());Ao();Oo();No=5});function Ue(e,t){return o=>{t&&t(o),e&&e(o)}}function Wo({direction:e,labelRef:t,...o}={}){let n=Uo(o);return(0,$.useEffect)(()=>{if(!o.disabled)return t?.current&&e&&(t.current.style.setProperty("cursor",jo[e]),t.current.style.setProperty("user-select","none"),t.current.addEventListener("mousedown",n.start)),()=>{t?.current&&(t.current.style.removeProperty("cursor"),t.current.style.removeProperty("user-select"),t.current.removeEventListener("mousedown",n.start))}},[n.start,o.disabled,e]),{...n,style:{cursor:o.disabled||!e?"initial":jo[e]}}}var $,Ho,_r,$r,Dt,jo,zo=B(()=>{"use strict";$=U(le());ze();Gt();ir();xr();Cr();ar();Ro();Bo();Ko();te();Ho="Mixed";_r=Se(Nn,{excludeProps:["contextDetails"]})`
  margin: 0;
  padding: 0;
  appearance: textfield;
  border-bottom: none !important;
  font-family: ${Ve.fonts.main};

  &::-webkit-outer-spin-button,
  &::-webkit-inner-spin-button {
    appearance: none;
  }
`,$r="NumericInput",Dt=(0,$.forwardRef)((e,t)=>{let{value:o,isMixedValue:n=!1,step:r=1,shiftStep:s=10,direction:i="y",moveSpeed:l=3,autoWidth:m=!1,textStyle:p="subheading",min:a=Number.NEGATIVE_INFINITY,max:d=Number.POSITIVE_INFINITY,disableArrowInput:u=!1,text:E,disabled:C,disableScrubbing:c=!1,labelRef:f,floating:y,onChange:S,onScrubbing:g,onScrubbingStart:x,onScrubbingEnd:w,...R}=e,[v,b]=(0,$.useState)(String(o)),[I,P]=(0,$.useState)(!1),O=(0,$.useRef)(0),N=(0,$.useRef)(null),W=Yt(t,N),[X]=Mo({ref:N,value:n?Ho:v,disabled:!m}),{moving:ne,start:Q,style:pe}=Wo({disabled:c||n||C,direction:i,labelRef:f,onMove:z,onMoveStart:M,onMoveEnd:G});(0,$.useEffect)(()=>{b(String(o))},[o]);let oe=(0,$.useMemo)(()=>typeof y=="boolean"?y?1:0:typeof y=="number"?y:r!==void 0?Rt(r):0,[r,y]);function se(L,A=!1){let q=Number(L),ee=ko(q,a)&&!A;return wo(q,a,d,oe,A||!ee)||(q=ot(q,a,d,oe)),{isValid:Bt(q)&&!ee,result:q}}function J(L,A,q){let{isValid:ee,result:ue}=se(L,q?.fullValidate);b(ue.toString()),S&&ee&&ue!==o&&S({value:ue,oldValue:o},A)}function he(L){if(C)return;let A=Io(L.target.value),q=Fo(A),ee=Lo(q),ue=Po(q),Ut=Bt(ee);!ue&&Ut?J(ee,L):(ue||Ut)&&b(ee)}function Pe(){P(!0)}function Ke(L){if(P(!1),!n){let A=ot(o,a,d,oe);J(A,L,{fullValidate:!0})}}function He(L){if(L.code==="ArrowUp"||L.code==="ArrowDown"||L.code==="Enter"){L.preventDefault();let A=L.shiftKey?s*r:r;L.code==="ArrowUp"?J(Mt("+",o,A),L,{fullValidate:!0}):L.code==="ArrowDown"&&J(Mt("-",o,A),L,{fullValidate:!0}),L.code==="Enter"&&N.current&&N.current.blur()}}function ut(L){let A=L.target;A.selectionStart===A.selectionEnd&&A.select()}function dt(L){L.target.setSelectionRange(0,0);let A=f?.current?.contains(N.current);!n&&!A&&Q(L.nativeEvent)}function M(){x&&x(o),O.current=0}function G(){if(f&&!n){let L=ot(o,a,d,oe);L!==o&&J(L,void 0,{fullValidate:!0})}w&&w(o),O.current=0}function z({offset:L}){let A=L[i];if(i==="y"&&(A=-A),A){let q=Math.round(A/l),ee=(q-O.current)*r;if(!n){let ue=ee+o;ue!==o&&J(ue,void 0,{fullValidate:!0})}g&&ee!==0&&g(ee,{mixed:!!n}),O.current=q}}let ie={value:v,disabled:C,height:"fit-content",color:"inherit",...R,type:"text",onChange:he,onBlur:Ue(Ke,e.onBlur),onFocus:Ue(Pe,e.onFocus),onMouseUp:Ue(ut,e.onMouseUp),onMouseDown:Ue(dt,e.onMouseDown)};return u||(ie.onKeyDown=Ue(He,e.onKeyDown)),E!==void 0&&!I&&(ie.value=E),n||(ie.style={...pe,...R?.style}),n&&(ie.value=Ho,I&&(ie.value="")),X&&(ie.width=X),V($.Fragment,{children:[h(_r,{caretColor:ne?"transparent":"auto",textStyle:p,...ie,ref:W}),ne?h(Un,{children:h(qt,{role:"presentation",backgroundColor:"transparent",zIndex:99999,style:pe,userSelect:"none"})}):null]})});Dt.displayName=$r;jo={x:"ew-resize",y:"ns-resize"}});var Vo,_o=B(()=>{"use strict";zo();Vo=Dt});function qr({editable:e,children:t,left:o,top:n,right:r,bottom:s,onChange:i,changedPaddings:l={}}){let{isPaddingsEnabled:m,setIsPaddingsEnabled:p}=(0,T.useContext)(lt),a=(0,T.useRef)(null).current,d=(0,T.useCallback)(x=>{a=x,p(!0)},[]),u=(0,T.useCallback)(x=>{(!a||a===x)&&p(!1)},[a]),E=(0,T.useRef)(null),{height:C}=Be(E),c=(0,T.useMemo)(()=>C<we,[C]),f=(0,T.useCallback)(x=>i({top:x}),[i]),y=(0,T.useCallback)(x=>i({left:x}),[i]),S=(0,T.useCallback)(x=>i({right:x}),[i]),g=(0,T.useCallback)(x=>i({bottom:x}),[i]);return V(F,{position:"relative",style:{paddingTop:n,paddingLeft:o,paddingRight:r,paddingBottom:s},children:[e&&h(me,{children:V(F,{contentEditable:!1,display:"inline",opacity:e?1:0,visibility:e?"visible":"hidden",userSelect:"none",children:[h(it,{isSmall:c,isChanged:l?.top,from:"top",value:n,marginLeft:o,marginRight:r,onChange:f,onStart:d,onStop:u}),h(it,{isSmall:c,isChanged:l?.left,from:"left",value:o,marginTop:n,marginBottom:s,onChange:y,onStart:d,onStop:u}),h(it,{isSmall:c,isChanged:l?.right,from:"right",value:r,marginTop:n,marginBottom:s,onChange:S,onStart:d,onStop:u}),h(it,{isSmall:c,isChanged:l?.bottom,from:"bottom",value:s,marginLeft:o,marginRight:r,onChange:g,onStart:d,onStop:u})]})}),h(F,{ref:E,className:"editor-block-wrapper",userSelect:m?"none":void 0,children:t})]})}var T,$o,Yr,lt,we,At,Gr,it,Yo,Ot=B(()=>{"use strict";T=U(le()),$o=U(Xt());_t();zt();Go();xe();nt();Jn();_o();te();Yr=je({key:"padding-frame-theme",container:typeof document<"u"?document.head:void 0}),lt=(0,T.createContext)({}),we=43,At=2,Gr=(0,T.memo)(({isActive:e,isSmall:t,from:o,value:n,position:r,onChange:s,disabled:i})=>{let l=window.RM.constructorRouter.zoom.getZoom(),m=o==="top"||o==="bottom",p=t&&!m,a=(0,T.useRef)(null),{width:d,height:u}=Be(a),E=(0,T.useMemo)(()=>(m?d:u)*l,[m,d,u,l]),C=a&&a.current?a.current.getBoundingClientRect():{x:0,y:0},c=(0,T.useMemo)(()=>p?10:o==="top"?"22px 22px 0 0":o==="right"?"0 22px 22px 0":o==="left"?"22px 0 0 22px":"0 0 22px 22px",[p,o]),f=(0,T.useMemo)(()=>{let v=E-we,b=r*l-we/2;return Math.max(0,b<=v?b:v)},[r,E,l]),{height:y,width:S}=(0,T.useMemo)(()=>({height:p?20:we,width:p?38:m?we:47}),[p,we,m]),{ref:g}=(0,T.useContext)(Nt),x=g&&g.current?g.current.getBoundingClientRect():{x:0,y:0},w=(0,T.useMemo)(()=>document.getElementById("paddings-input-portal"),[]),R=h(F,{display:"flex",position:"relative",justifyContent:p?"flex-start":"flex-end",flexDirection:m?"row":"column",style:{position:"absolute",...m?{left:f+x.x+C.x*l,top:x.y+C.y*l-(o==="top"?y:0)}:{top:f+x.y+C.y*l,left:x.x+C.x*l-(o==="left"?S:0)}},children:h(F,{display:"flex",backgroundColor:"blue",width:S,height:y,borderRadius:c,alignItems:"center",justifyContent:"center",zoom:"var(--workspace-inverse-zoom)",transform:"scale(var(--workspace-zoom))",transformOrigin:"left top",children:h(Vo,{min:0,value:n,color:"white",fontSize:14,fontWeight:600,placeholder:"0",textAlign:"center",disabled:i,onChange:({value:v})=>s(v)})})});return h(We,{value:Yr,children:V(me,{children:[h(F,{ref:a,width:"100%",height:"100%"}),e&&w?$o.default.createPortal(R,w):null]})})}),it=(0,T.memo)(({from:e,isChanged:t,onChange:o,value:n=0,isSmall:r,marginBottom:s=0,marginLeft:i=0,marginRight:l=0,marginTop:m=0,onStart:p,onStop:a})=>{let d=(0,T.useContext)(Oe),u=d&&d.window,E=(M,G)=>{let z=G;u&&u.addEventListener(M,z),window.addEventListener(M,z)},C=(M,G)=>{let z=G;u&&u.removeEventListener&&u.removeEventListener(M,z),window.removeEventListener(M,z)},c=e==="top"||e==="bottom",f=e==="bottom",[y,S]=(0,T.useState)(!1),[g,x]=(0,T.useState)(!1),[w,R]=(0,T.useState)(!1),[v,b]=(0,T.useState)(0),I=(0,T.useRef)(null),[P,O]=(0,T.useState)(0),[N,W]=(0,T.useState)(0),X=(0,T.useRef)(!1).current,ne=M=>{X=!0;let G=c?M.screenY:M.screenX,z=e==="right"?v-G:G-v;o(Math.max(0,n+z)),W(Math.max(0,(c?M.clientX:M.clientY)-P))},Q=()=>{x(!1),X&&(R(!1),a&&a(e)),X=!1};(0,T.useEffect)(()=>(g?(E("mousemove",ne),E("mouseup",Q)):(C("mousemove",ne),C("mouseup",Q)),()=>{C("mousemove",ne),C("mouseup",Q)}),[g]);let pe=M=>{let G=document.getElementById("paddings-input-portal"),z=M.target;G&&!G.contains(z)&&I.current&&!I.current.contains(z)&&(R(!1),x(!1),Q(),a&&a(e))},oe=M=>{M.key==="Escape"&&(R(!1),x(!1),Q(),a&&a(e))};(0,T.useEffect)(()=>(g||(w?(E("click",pe),E("keyup",oe)):(C("click",pe),C("keyup",oe),a&&a(e))),()=>{C("click",pe),C("keyup",oe)}),[g,w]);let se=(0,T.useMemo)(()=>f?y||g?1:0:y||g?2:1,[g,y]),J=(0,T.useMemo)(()=>c?`calc(100% - ${i+l}px)`:`${se}px`,[se,i,l]),he=(0,T.useMemo)(()=>c?`${se}px`:`calc(100% - ${s+m}px)`,[se,s,m]),Pe=(0,T.useMemo)(()=>c?0+i:void 0,[i]),Ke=(0,T.useMemo)(()=>c?void 0:0+m,[m]),He=t?"tomato":"blue",ut=(0,T.useMemo)(()=>({width:c?"100%":n,height:c?n:`calc(100% - ${m+s}px)`,marginTop:c?0:m}),[c,n,m,s]),dt=(0,T.useMemo)(()=>({width:f?"100%":c?J:`${At}px`,height:f||c?At:he,left:f?0:Pe,top:Ke}),[f,c,J,he,Pe,Ke]);return V(F,{ref:I,position:"absolute",width:c?"100%":void 0,height:c?void 0:"100%",left:c?0:void 0,top:c?void 0:0,[e]:0,children:[h(F,{backgroundColor:"rgba(28, 222, 180, 0.18)",style:ut}),V(F,{position:"absolute",onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),onMouseDown:M=>{let G=document.getElementById("paddings-input-portal");if(!(G&&G.contains(M.target))){if(!w){let z=M.target.getBoundingClientRect(),ie=c?z.x:z.y;O(ie),W(Math.max(0,(c?M.clientX:M.clientY)-ie)),R(!0)}b(c?M.screenY:M.screenX),x(!0),p&&p(e)}},[e]:f?0:"100%",cursor:c?"row-resize":"col-resize",style:dt,children:[h(F,{position:"absolute",width:c?"100%":void 0,height:c?void 0:"100%",bottom:e==="top"?"100%":void 0,top:e==="bottom"?"100%":void 0,left:e==="right"?"100%":void 0,right:e==="left"?"100%":void 0,children:h(Gr,{isSmall:r,position:N,isActive:w,onChange:o,value:n,from:e,disabled:g})}),h(F,{display:"flex",width:"100%",height:"100%",alignItems:e==="top"?"flex-start":"flex-end",justifyContent:e==="right"?"flex-end":void 0,children:h(F,{style:{width:c?"100%":`${se}px`,height:c?`${se}px`:"100%",backgroundColor:y||g||f||n&&n>0?He:"transparent"}})})]}),f&&h(F,{position:"absolute",backgroundColor:n&&n>1?He:"transparent",top:0,height:"1px",style:{left:Pe,width:J}})]})});Yo=qr});function Xr({children:e,...t}){let{model:{isEditMode:o,useTextWidgetStore:n}}=(0,Z.useContext)(Le),{model:r}=(0,Z.useContext)(Re),s=r.flags?.calculatedLineHeight,i=Ne("TextCanChangePaddings"),[l,m]=n({partial:!1}),[p]=$e(),{blockKey:a,block:d}=(0,Z.useMemo)(()=>{if(!t["data-offset-key"])return{};let b=t["data-offset-key"].split("-")[0],I=l.getCurrentContent().getBlockForKey(b);return{blockKey:b,block:I}},[t,l]),u=(0,Z.useMemo)(()=>ae({block:d}),[d]),E=(0,Z.useMemo)(()=>!!(a&&vn(l,a)),[l,a]),C=E?"var(--editor-border-color)":"transparent",c=(0,Z.useMemo)(()=>[...p.global,...p.project].find(b=>b.name===u),[u,p,l]),{paddings:f,changedPaddings:y}=(0,Z.useMemo)(()=>{let b=St({block:d}),I=c?On(c):{};return{paddings:{left:0,right:0,top:0,bottom:0,...I,...b},changedPaddings:fn({blockPaddings:b,stylePaddings:I})}},[l,d,c,p]),S=b=>{let I=Me(l),P=l.getCurrentContent(),O=I.reduce((N,W)=>{let X=P.getBlockForKey(W);if(X){let ne=St({block:X});return dn({editorState:N,block:X,paddings:{...ne,...b}})}return N},l);m(O)},g=(0,Z.useMemo)(()=>Ge({block:d}),[l,d,p]),x=(0,Z.useMemo)(()=>Hn({block:d}),[l,d]),w=(0,Z.useMemo)(()=>s?Ln({block:d,width:r.w}):{},[l,d,p]),R=(0,Z.useMemo)(()=>{if(d&&!ve({block:d})){let{r:I,g:P,b:O,a:N}=Zt(Rn(d));return`rgba(${I}, ${P}, ${O}, ${N})`}},[l,d]),v=i===!1?i:o&&E;return h(F,{...t,position:"relative",style:{lineHeight:typeof g=="number"?`${g}px`:void 0,textIndent:typeof x=="number"?`${x}px`:void 0,...w},css:Vt`
        // Заглушаем паддинги текстового стиля, чтобы отдать управление ими в TextPaddings
        padding: 0 !important;

        // Хак рамки, чтобы у нескольких элементов подряд не вышло 2px рамки
        &:after {
          content: '';
          pointer-events: none;
          box-shadow: 1px 0 0 0 ${C}, 0 1px 0 0 ${C}, 1px 1px 0 0 ${C},
            1px 0 0 0 ${C} inset, 0 1px 0 0 ${C} inset;
          position: absolute;
          top: 0;
          left: -1px;
          width: calc(100% + 1px);
          height: calc(100% - 1px);
        }

        // Дефолтный цвет для списков
        .editor-block-wrapper:before,
        div[data-offset-key]:before,
        & > li:before {
          ${R?`color: ${R};`:""}
        }
      `,children:h(Yo,{editable:v,top:f.top,left:f.left,bottom:f.bottom,right:f.right,changedPaddings:y,onChange:S,children:e},a)})}var Z,qo,Xo=B(()=>{"use strict";Z=U(le());Ye();de();xe();Ot();gn();mr();ht();jn();yn();pr();Qe();Lt();ze();te();qo=Xr});var Y,at,Jo,Jr,Zr,Zo,Qo=B(()=>{"use strict";Y=U(le()),at=U(_e());xe();Jo=U(cr());be();Gn();de();So();nt();Co();vo();Sn();hr();xt();Ye();gt();Xo();Ie();Qe();ln();te();Jr=()=>{let e=window.RM.constructorRouter&&!window.RM.constructorRouter.preview,t={...on(),...Jt,...sn};return Jo.default.Map(Object.keys(t).reduce((o,n)=>{let r=t[n].element,s=e?qo:r,i=Ze(n)?h(qn,{type:n}):void 0;return Object.assign(o,{[n]:{...t[n],element:s,wrapper:i}}),o},{}))},Zr=(0,Y.forwardRef)(({isEditMode:e,textDirection:t,autosize:o,columns:n,verticalAlign:r,bgColor:s,selectionColor:i,shouldShowSelectionBorder:l,useBaseline:m,disableSelectionHighlight:p,...a},d)=>{let u=(0,Y.useRef)(null),E=(0,Y.useContext)(Oe),C=Ne("TextCanChangeTypography");(0,Y.useEffect)(()=>{if(u&&u.current!==null){let g=E&&E.window||window,x=u,w=mo(x,g),R=Eo(x,g),v=go(x,{forceCleanText:!C});return()=>{w.unregister(),R?.unregister(),v?.unregister()}}},[u]),(0,Y.useEffect)(()=>{let g=d;g!==null&&g.current&&u.current&&!g.current.focusEditor&&(g.current.focusEditor=u.current.focus)},[u,d]);let c=(0,Y.useCallback)((g,x,w,R)=>{let{mag:v,workspace:b}=window.RM.constructorRouter,I=yo(g,w,v),P;switch(I){case"Link":{let O=Xe(g,v);if(O){let N=tn(),W=hn(v,N.project,N.global)||pn.name;P=xn({editorState:w,url:g,type:O,linkStyle:W}),b.controls?.select(b.controls?.findControl("text_link"))}break}case"Text":{P=ho({text:g,html:x,editorState:w,pastedWithShift:R});break}}return P?(a.onChange(P),"handled"):"not-handled"},[a.onChange]),f=(0,Y.useCallback)((g,x)=>{if(g.shiftKey){let R=In(x);return a.onChange(R),"handled"}let w=Pn(x);if(w){let{status:R,editorState:v}=w;return a.onChange(v),R}return"not-handled"},[a.onChange]),y=(0,Y.useCallback)(g=>g?(a.onChange(Fn({editorState:a.editorState,dropSelection:g})),"handled"):"not-handled",[a.onChange,a.editorState]),S=(0,Y.useMemo)(()=>at.DefaultDraftBlockRenderMap.merge(Jr()),[]);return h(Yn,{ref:d,textDirection:t,autosize:o,columns:n,verticalAlign:r,bgColor:s,selectionColor:i,shouldShowSelectionBorder:l,useBaseline:m,isEditMode:e,disableSelectionHighlight:p,children:h(F,{children:h(at.Editor,{ref:u,spellCheck:!1,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",stripPastedStyles:!1,blockRenderMap:S,customStyleFn:Qt,handlePaste:c,handleReturn:f,handleDrop:y,...a})})})}),Zo=Zr});var K,er,jl,tr=B(()=>{"use strict";K=U(le());be();Ye();de();Ie();Qe();gt();ht();yr();Wt();er=(e,t={})=>{let[o,n]=mt(),[r]=$e(),s=Array.isArray(e)?e:[e],i=(0,K.useMemo)(()=>s.map(c=>Cn(c)),[s]),l=(0,K.useMemo)(()=>[...r.global,...r.project],[r.global,r.project]),m=(0,K.useMemo)(()=>s.map(c=>ae({editorState:c})),[s]),p=(0,K.useMemo)(()=>m.map(c=>l.find(f=>f.name===c)).filter(Boolean),[m,l]),a=(0,K.useMemo)(()=>s.map((c,f)=>{let y=H(c,"FONT_FAMILY"),S=p[f];return y.length?y[0]:S?S.cssProperties.fontFamily||"":_.fontFamily}),[p,s]),d=(0,K.useMemo)(()=>s.map((c,f)=>{let y=H(c,"FONT_STYLE"),S=p[f];return y.length?y[0]:S?S.cssProperties.fontStyle||"":_.fontStyle}),[p,s]),u=(0,K.useMemo)(()=>s.map((c,f)=>{let y=H(c,"FONT_WEIGHT"),S=p[f];return y.length?y[0]:S?S.cssProperties.fontWeight||"":_.fontWeight}),[p,s]);(0,K.useEffect)(()=>{if(t.listenFontFeaturesUpdates&&a.length&&u.length&&d.length){let c=s.map((f,y)=>{let S=Ht(a)[y],g=u[y],x=d[y];if(S){let w=Fe({fontFamily:S,fontWeight:g,fontStyle:x});if(!o[w])return Ct({fontFamily:S,fontWeight:g,fontStyle:x}).then(v=>({res:v,key:w}))}});Promise.all(c).then(f=>{let y={};f.forEach(S=>{S?.res&&(y[S.key]=S.res)}),Object.keys(y).length!==0&&n({...o,...y})})}},[s]);let E=(0,K.useMemo)(()=>s.map((c,f)=>{let y=a[f],S=u[f],g=d[f];if(y&&S&&g){let x=Fe({fontFamily:y,fontWeight:S,fontStyle:g});return o[x]}}),[s,o]);return(0,K.useMemo)(()=>{let c={textStyle:[],textStyleName:[],fontFamily:[],fontStyle:[],fontWeight:[],fontInfo:[],fontSize:[],lineHeight:[],ratio:[],letterSpacing:[],fontSizeLinkStatus:[],letterSpacingLinkStatus:[]};for(let f=0;f<s.length;f++){let y=s[f],S=p[f],g=i[f],x=E[f],w=m[f],R=a[f],v=d[f],b=u[f],I=S&&S.name!=="unstyled",P=I&&Ce(S?.cssProperties.fontSize),O=I&&Ce(S?.cssProperties.lineHeight),N=I&&Ce(S?.cssProperties.letterSpacing,!0),W=H(y,"FONT_SIZE"),X=H(y,"LETTER_SPACING"),ne=Ge({block:g}),Q=H(y,"IS_LINKED_LETTER_SPACING"),pe=mn({block:g}),oe=W?.length?parseInt(W[0]):P||_.fontSize,se=X?.length?parseFloat(X[0]):N||0,J=typeof ne=="number"?ne:O||_.lineHeight,he=Q&&Q[0]&&typeof Q[0]<"u"?Q[0]==="true":!1;c.textStyle.push(S),c.textStyleName.push(w),c.fontFamily.push(R),c.fontStyle.push(v),c.fontWeight.push(b),c.fontInfo.push(x),c.fontSize.push(oe),c.lineHeight.push(J),c.ratio.push(oe/J),c.letterSpacing.push(se),c.fontSizeLinkStatus.push(pe),c.letterSpacingLinkStatus.push(he)}return c},[s,i,p,a,E,d,u,m])},jl=(e,t={})=>{let[o,n]=mt(),[r]=nn(),s=(0,K.useMemo)(()=>[...r.global,...r.project],[r.global,r.project]),i=(0,K.useMemo)(()=>ve({editorState:e}),[e]),l=(0,K.useMemo)(()=>s.find(u=>u.name===i),[s,i]),m=(0,K.useMemo)(()=>{let u=H(e,"FONT_FAMILY");return l?l.cssProperties.fontFamily||"":u.length?u[0]:_.fontFamily},[l,e,i]),p=(0,K.useMemo)(()=>{let u=H(e,"FONT_STYLE");return l?l.cssProperties.fontStyle||_.fontStyle:u.length?u[0]:_.fontStyle},[l,e,i]),a=(0,K.useMemo)(()=>{let u=H(e,"FONT_WEIGHT");return l?l.cssProperties.fontWeight||"":u.length?u[0]:_.fontWeight},[l,e,i]);(0,K.useEffect)(()=>{if(t.listenFontFeaturesUpdates&&m&&a&&p){let u=Fe({fontFamily:m,fontWeight:a,fontStyle:p});o[u]||Ct({fontFamily:m,fontWeight:a,fontStyle:p}).then(C=>{if(C){let{features:c,variations:f,characters:y}=C;n({...o,[u]:{features:c,variations:f,characters:y}})}})}},[e,t.listenFontFeaturesUpdates]);let d=(0,K.useMemo)(()=>{if(m&&a&&p){let u=Fe({fontFamily:m,fontWeight:a,fontStyle:p});return o[u]}},[e,o]);return{listStyle:l,listStyleName:i,fontFamily:m,fontStyle:p,fontWeight:a,fontInfo:d}}});function Qr({readOnly:e}){let{model:t,modelSet:o,modelSave:n}=(0,k.useContext)(Re),{model:{useTextWidgetStore:r,isEditMode:s,workspace:i,selected:l,isJustCreated:m,disableSelectionHighlight:p,isResizing:a}}=(0,k.useContext)(Le),[d,u]=r({partial:!1});er(d,{listenFontFeaturesUpdates:!0});let{isPaddingsEnabled:E}=(0,k.useContext)(lt),{callback:C}=pt(n,400),{callback:c}=pt(b=>{if(s&&b.getLastChangeType()){let P=Tn(b.getCurrentContent()),O=Object.keys(P),N=(0,ct.pick)(t,...O),W=(0,ct.isEqual)(P,N);o(P),W||C()}},20);(0,k.useEffect)(()=>{s&&m&&setTimeout(()=>{S.current?.focusEditor()},0)},[]),(0,k.useEffect)(()=>{c(d)},[d]);let f=(0,k.useMemo)(()=>d.getSelection().getHasFocus(),[d]),y=(0,k.useMemo)(()=>s,[s,f]),S=(0,k.useRef)(null),{height:g}=Be(S),x=(0,k.useMemo)(()=>t.columns&&t.columns.count>1,[t.columns]);(0,k.useEffect)(()=>{!a&&g>0&&g!==t.h&&s&&!x&&t.autosize&&(o({h:g}),C())},[g,t.autosize,t.h,x,a]),(0,k.useEffect)(()=>{!Modernizr.firefox&&!s&&!d.getSelection().isCollapsed()&&u(En(d))},[s]);let w=(0,k.useCallback)(b=>{let I=b.getType(),P=ae({block:b}),O=an({block:b}),N=Ze(I)?ve({block:b})||(t.flags?.newListPosition?rn:void 0):void 0;return["edit-mode",I,P,O,N].filter(W=>W).join(" ")},[]),R=(0,k.useCallback)(b=>{let I=b.getSelection(),P=b;P=Mn(P,d),P=Te(P,kn(I)),P=P.getSelection().isCollapsed()?P:Te(P,Je(P)),Modernizr.safari&&!I.isCollapsed()&&(P=Te(P,P.getSelection(),!1)),u(P)},[d]),v=(0,k.useCallback)(b=>{let I=lo({action:b,editorState:d,workspace:i});if(I){let{editorState:P,status:O}=I;return u(P),O}else return"not-handled"},[d,i]);return h(Zo,{ref:S,isEditMode:s,bgColor:t.bgColor,selectionColor:t.selectionColor,textDirection:t.textDirection||"LTR",autosize:t.autosize,columns:t.columns,verticalAlign:t.verticalAlign,useBaseline:t.flags?.baseline,shouldShowSelectionBorder:y,editorState:d,disableSelectionHighlight:p,blockStyleFn:w,onChange:R,readOnly:!s||!l||e||E,keyBindingFn:io,handleKeyCommand:v})}function es({size:e,height:t,width:o,onClick:n}){return V(me,{children:[h(F,{position:"absolute",top:0,left:0,onClick:n,userSelect:"none",style:{width:o+e*2,height:e}}),h(F,{position:"absolute",bottom:0,left:0,onClick:n,userSelect:"none",style:{width:o+e*2,height:e}}),h(F,{position:"absolute",top:0,left:0,width:e,onClick:n,userSelect:"none",style:{width:e,height:t+e*2}}),h(F,{position:"absolute",top:0,right:0,onClick:n,userSelect:"none",style:{width:e,height:t+e*2}})]})}function ns(){let{model:{useTextWidgetStore:e,fontStyles:t,isResizing:o,leaveEditMode:n,isEditMode:r,canControlsBeClosed:s,onIframeLoaded:i}}=(0,k.useContext)(Le),[l]=e({partial:!1}),{model:{w:m,h:p}}=(0,k.useContext)(Re),[a,d]=(0,k.useState)(!1);(0,k.useEffect)(()=>{a&&Kt()},[a,o]);let u=(0,k.useRef)(null),E=(0,k.useMemo)(()=>{let v={position:"absolute",top:ye*-1,left:ye*-1,width:`calc(100% + ${ye*2}px)`,height:`calc(100% + ${ye*2}px)`,fontFamily:"-apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Ubuntu, 'Fira Sans', Roboto, 'Avenir Next', 'Helvetica Neue', Helvetica, Arial, sans-serif",lineHeight:1};return{display:r?void 0:"none",pointerEvents:!r||a||o?"none":void 0,userSelect:"none",...v}},[ye,r,a,o]),C=(0,k.useCallback)(()=>{s()&&n()},[s,n]),[c,f]=(0,k.useState)(!1),[y,S]=(0,k.useState)(!1);(0,k.useEffect)(()=>{r&&!c&&f(!0)},[r]);let[g,x]=(0,k.useState)(!1),w=(0,k.useRef)(null),R=()=>{let v=u.current?.contentDocument?.hasFocus()||!1;if(v){let b=u.current?.contentDocument?.getSelection();b&&b.anchorNode&&b.focusNode&&(w.current={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset})}x(v)};return(0,k.useEffect)(()=>(u.current?.contentDocument?.addEventListener("selectionchange",R),()=>{u.current?.contentDocument?.removeEventListener("selectionchange",R)}),[u.current?.contentDocument]),(0,k.useEffect)(()=>{if(Modernizr.safari){let v=l.getSelection(),b=v.getHasFocus();if(!g&&b&&!v.isCollapsed()){let I=u.current?.contentWindow?.getSelection();I&&w.current&&I.setBaseAndExtent(w.current.anchorNode,w.current.anchorOffset,w.current.focusNode,w.current.focusOffset)}}},[l,g]),h(Nt.Provider,{value:{ref:u},children:h(lt.Provider,{value:{isPaddingsEnabled:a,setIsPaddingsEnabled:d},children:V(F,{position:"relative",width:"calc(var(--workspace-inverse-zoom) * 100%)",height:"calc(var(--workspace-inverse-zoom) * 100%)",zoom:"var(--workspace-inverse-zoom)",transform:"scale(var(--workspace-zoom))",transformOrigin:"left top",children:[c&&V(xo,{ref:u,style:E,head:V(me,{children:[h("style",{children:`
                      body {
                        margin: 0;
                        height: 100vh;
                        width: 100vw;
                        overflow: hidden;
                        box-sizing: border-box;
                        padding: ${ye}px ${ye-$n}px;
                      }

                      ol, ul {
                        padding: 0;
                        margin: 0;
                      }
                  `}),t.map((v,b)=>{if(v.tag==="style")return h("style",{children:`${v.style}`},b);if(v.tag==="link")return h("link",{rel:"stylesheet",type:v.type,href:v.href},b)})]}),contentDidMount:()=>{i(),S(!0)},children:[h(Qn,{mode:"constructor"}),r&&h(ts,{size:ye,height:p,width:m,onClick:C}),h(Qr,{})]}),r&&y?null:h(F,{height:"100%",width:"100%",position:"absolute",top:0,left:0,pointerEvents:"none",userSelect:"none",children:h(Xn,{editorState:l,isConstructorPreview:!0})})]})})})}var k,ct,nr,Nt,ts,ye,ma,Go=B(()=>{k=U(le()),ct=U(rr());lr();yn();nr=U(br());Qo();de();gr();un();Ot();gn();Pt();kr();Qe();ln();Er();xe();nt();Gn();tr();Jn();or();te();Nt=(0,k.createContext)({});ts=(0,k.memo)(es,nr.default),ye=500;ma=ns});export{De as a,no as b,ms as c,wr as d,gs as e,Pr as f,ys as g,hs as h,Ss as i,xs as j,oo as k,bs as l,ro as m,fe as n,wt as o,ao as p,co as q,bo as r,ai as s,Ne as t,Co as u,Mo as v,Bo as w,st as x,Oo as y,Uo as z,Ko as A,Vo as B,_o as C,er as D,jl as E,tr as F,Nt as G,ye as H,ma as I,Go as J};
